<!doctype html>
<head>
  <title>Attention and Augmented Recurrent Neural Networks — Distill</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=1024">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

  <meta name="keywords" content="neural networks,machine learning">

  <meta property="og:type" content="article"/>
  <meta property="og:title" content="Attention and Augmented Recurrent Neural Networks"/>
  <meta property="og:description" content="Recurrent neural networks are one of the staples of deep learning, allowing neural networks to work with sequences of data like text, audio and video">
  <meta property="og:url" content="http://distill.pub/2016/augmented-rnns/"/>
  <meta property="og:image" content="http://distill.pub/2016/augmented-rnns/thumbnail.png"/>

  <meta name="twitter:card" value="summary_large_image">
  <meta name="twitter:title" content="Attention and Augmented Recurrent Neural Networks">
  <meta name="twitter:description" content="Recurrent neural networks are one of the staples of deep learning, allowing neural networks to work with sequences of data like text, audio and video">
  <meta name="twitter:url" content="http://distill.pub/2016/augmented-rnns/">
  <meta name="twitter:image" content="http://distill.pub/2016/augmented-rnns/thumbnail.png">
  <meta name="twitter:image:width" content="560">
  <meta name="twitter:image:height" content="295">

  <meta name="author" content="Olah &amp; Carter">

  <meta name="citation_title" content="Attention and Augmented Recurrent Neural Networks">
  <meta name="citation_author" content="Olah, Chris">
  <meta name="citation_author" content="Carter, Shan">
  <meta name="citation_publication_date" content="2016/09/08">
  <meta name="citation_journal_title" content="Distill">

  <link href="https://fonts.googleapis.com/css?family=Material+Icons|PT+Serif:500|Open+Sans:300,400,400i,600,700" rel="stylesheet">
</head>

<body>
  <style>
  </style>
  <div class="page post">
<p><link rel="stylesheet" type="text/css" href="assets/common.css"></p>
<p><script src="assets/d3.min.js"></script></p>
<p><h1>Attention and Augmented Recurrent Neural Networks</h1>
<div class="byline">
  <div class="authors">
    <div class="author">
      <a class="name" href="http:&#x2F;&#x2F;colah.github.io">Chris Olah</a>
      <a class="affiliation" href="http:&#x2F;&#x2F;g.co&#x2F;brain">Google Brain</a>
    </div>
    <div class="author">
      <a class="name" href="http:&#x2F;&#x2F;shancarter.com">Shan Carter</a>
      <a class="affiliation" href="http:&#x2F;&#x2F;g.co&#x2F;brain">Google Brain</a>
    </div>
  </div>
  <div class="date">
    <div class="month">Sept. 8</div>
    <div class="year">2016</div>
  </div>
  <a class="citation" href="#citation">
    <div>Citation:</div>
    <div>Olah &amp; Carter, 2016</div>
  </a>
</div>
</p>
<p>Recurrent neural networks are one of the staples of deep learning, allowing neural networks to work with sequences of data like text, audio and video. They can be used to boil a sequence down into a high-level understanding, to annotate sequences, and even to generate new sequences from scratch!</p>
<!-- Comment on inputs/outputs in figure? -->
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="156" viewBox="0 0 984 156">
  <defs>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="167.89" y="36.93" width="468.22" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="167.89" y="36.93" width="468.22" height="72" rx="10" ry="10" fill="none" stroke="#667780"/>
    </g>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="181" y="50.93" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="181" y="50.93" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M210,81.93L208.08,77h-6.23l-1.91,4.94h-1.83l6.14-15.61h1.52l6.11,15.61H210Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(179.25 48.18)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="313" y="50.93" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="313" y="50.93" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M342,81.93L340.08,77h-6.23l-1.91,4.94h-1.83l6.14-15.61h1.52l6.11,15.61H342Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(311.25 48.18)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="445" y="50.93" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="445" y="50.93" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M474,81.93L472.08,77h-6.23l-1.91,4.94h-1.83l6.14-15.61h1.52l6.11,15.61H474Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(443.25 48.18)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_4" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="577" y="50.93" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="577" y="50.93" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M606,81.93L604.08,77h-6.23l-1.91,4.94h-1.83l6.14-15.61h1.52l6.11,15.61H606Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.25 48.18)" xlink:href="#rnn-a"/>
  </g>
  <text transform="translate(184.88 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">x0</text>
  <text transform="translate(209.01 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">y0</text>
  <text transform="translate(316.88 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">x1</text>
  <text transform="translate(341.01 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">y1</text>
  <text transform="translate(448.88 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">x2</text>
  <text transform="translate(473.01 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">y2</text>
  <text transform="translate(580.88 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">x3</text>
  <text transform="translate(605.01 136.93)" opacity="0.6" font-size="13" font-family="Open Sans">y3</text>
  <g opacity="0.6">
    <text transform="translate(174.39 24.93)" font-size="13" font-family="Open Sans">One cell...</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(279.21 24.93)" font-size="13" font-family="Open Sans">can be used over...</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(436.05 24.93)" font-size="13" font-family="Open Sans">and over...</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(581.85 24.93)" font-size="13" font-family="Open Sans">again.</text>
  </g>
  <g>
    <g>
      <line x1="228" y1="73.43" x2="300.57" y2="73.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M306,73.43a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,306,73.43Z" fill="#666"/>
    </g>
    <g>
      <line x1="192" y1="120.93" x2="192" y2="107.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M192,102a27.2,27.2,0,0,0,4.28,7.69L192,108.14l-4.28,1.55A27.18,27.18,0,0,0,192,102Z" fill="#666"/>
    </g>
    <g>
      <line x1="217" y1="96.43" x2="217" y2="115.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M217,120.93a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,217,120.93Z" fill="#666"/>
    </g>
    <g>
      <line x1="324" y1="120.93" x2="324" y2="107.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M324,102a27.2,27.2,0,0,0,4.28,7.69L324,108.14l-4.28,1.55A27.18,27.18,0,0,0,324,102Z" fill="#666"/>
    </g>
    <g>
      <line x1="349" y1="96.43" x2="349" y2="115.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M349,120.93a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,349,120.93Z" fill="#666"/>
    </g>
    <g>
      <line x1="457" y1="120.93" x2="457" y2="107.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M457,102a27.2,27.2,0,0,0,4.28,7.69L457,108.14l-4.28,1.55A27.18,27.18,0,0,0,457,102Z" fill="#666"/>
    </g>
    <g>
      <line x1="480" y1="96.43" x2="480" y2="115.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M480,120.93a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,480,120.93Z" fill="#666"/>
    </g>
    <g>
      <line x1="588" y1="120.93" x2="588" y2="107.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M588,102a27.2,27.2,0,0,0,4.28,7.69L588,108.14l-4.28,1.55A27.18,27.18,0,0,0,588,102Z" fill="#666"/>
    </g>
    <g>
      <line x1="612" y1="96.43" x2="612" y2="115.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M612,120.93a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,612,120.93Z" fill="#666"/>
    </g>
    <g>
      <line x1="360" y1="73.43" x2="432.57" y2="73.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M438,73.43a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,438,73.43Z" fill="#666"/>
    </g>
    <g>
      <line x1="492" y1="73.43" x2="564.57" y2="73.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M570,73.43a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,570,73.43Z" fill="#666"/>
    </g>
  </g>
</svg>
</figure>

<p>The basic RNN design struggles with longer sequences, but a special variant – <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">“long short-term memory” networks</a> – can even work with these. Such models have been found to be very powerful, achieving remarkable results in many tasks including translation, voice recognition, and image captioning. As a result, recurrent neural networks have become very widespread in the last few years.</p>
<p>As this has happened, we’ve seen a growing number of attempts to augment RNNs with new properties. Four directions stand out as particularly exciting:</p>
<ul>
<li><a href="#neural-turing-machines"><em>Neural Turing Machines</em></a> have external memory that they can read and write to.</li>
<li><a href="#attentional-interfaces"><em>Attentional Interfaces</em></a> allow RNNs to focus on parts of their input.</li>
<li><a href="#adaptive-computation-time"><em>Adaptive Computation Time</em></a> allows for varying amounts of computation per step.</li>
<li><a href="#neural-programmer"><em>Neural Programmers</em></a> can call functions, building programs as they run.</li>
</ul>
<p>Individually, these techniques are all potent extensions of RNNs, but the really striking thing is that they can be combined together, and seem to just be points in a broader space. Further, they all rely on the same underlying trick – something called attention – to work.</p>
<p>Our guess is that these “augmented RNNs” will have an important role to play in extending deep learning’s capabilities over the coming years.</p>
<hr>
<h2 id="neural-turing-machines">Neural Turing Machines</h2>
<p>Neural Turing Machines (<a href="https://arxiv.org/pdf/1410.5401.pdf">Graves, <em>et al.</em>, 2014</a>) combine a RNN with an external memory bank. Since vectors are the natural language of neural networks, the memory is an array of vectors:</p>
<figure class="w-page">
  <!--
  <figcaption>Memory is an array of vectors.</figcaption>
  <figcaption style="top: 100px;">At every time step, the RNN controller can read from and write to this external memory.</figcaption>
  -->
  <div id="rnn-memory">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="330" viewBox="0 0 984 330">
  <defs>
    <symbol id="array-small" data-name="array-small" viewBox="0 0 182.08 31.66">
      <rect x="0.75" y="0.75" width="180.58" height="30.16" rx="6" ry="6" fill="#e5daf2" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <line x1="30.7" y1="30.91" x2="30.7" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="60.86" y1="30.91" x2="60.86" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="91.03" y1="30.91" x2="91.03" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="121.19" y1="30.91" x2="121.19" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="151.33" y1="30.91" x2="151.33" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
    <symbol id="op-read" data-name="op-read" viewBox="0 0 49.54 25.5">
      <g id="_Group_4" data-name="&lt;Group&gt;">
        <g>
          <path d="M48.83,12.75a12,12,0,0,1-12,12H12.71a12,12,0,1,1,0-24H36.83a12,12,0,0,1,12,12h0Z" fill="#e5daf2"/>
          <path d="M49.54,13.5a12,12,0,0,1-12,12H12a12,12,0,0,1-12-12V12A12,12,0,0,1,12,0H37.54a12,12,0,0,1,12,12v1.5ZM1.43,12.75c0,6.19,5.4,11.25,12,11.25H36.12c6.6,0,12-5.06,12-11.25S42.72,1.5,36.12,1.5H13.43C6.83,1.5,1.43,6.56,1.43,12.75Z" fill="#666"/>
        </g>
      </g>
      <g>
        <path d="M16.25,9.67a3.31,3.31,0,0,1,.69.06L16.8,11a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4v3.39H13V9.79H14l0.18,1.14h0.07A2.57,2.57,0,0,1,15.13,10,2,2,0,0,1,16.25,9.67Z" fill="#666"/>
        <path d="M21,16.38a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74H19.16a2.13,2.13,0,0,0,.51,1.45,1.78,1.78,0,0,0,1.35.51,5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,21,16.38Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,20.71,10.71Z" fill="#666"/>
        <path d="M29.1,16.27l-0.28-.9h0a2.65,2.65,0,0,1-.94.81,3,3,0,0,1-1.22.21,2.06,2.06,0,0,1-1.49-.52,1.93,1.93,0,0,1-.54-1.46,1.71,1.71,0,0,1,.74-1.51,4.29,4.29,0,0,1,2.27-.56l1.12,0V12A1.31,1.31,0,0,0,28.43,11a1.18,1.18,0,0,0-.9-0.31,3.11,3.11,0,0,0-1,.15,7.21,7.21,0,0,0-.88.35l-0.45-1a4.79,4.79,0,0,1,1.15-.42,5.31,5.31,0,0,1,1.18-.14,2.8,2.8,0,0,1,1.87.54,2.11,2.11,0,0,1,.63,1.69v4.37h-1Zm-2.05-.94a1.71,1.71,0,0,0,1.2-.42,1.52,1.52,0,0,0,.45-1.17V13.17l-0.83,0a2.85,2.85,0,0,0-1.42.33,1,1,0,0,0-.44.89,0.87,0.87,0,0,0,.26.67A1.11,1.11,0,0,0,27.05,15.33Z" fill="#666"/>
        <path d="M34.19,16.38a2.26,2.26,0,0,1-1.89-.88A4,4,0,0,1,31.62,13a4,4,0,0,1,.69-2.48,2.28,2.28,0,0,1,1.91-.89,2.23,2.23,0,0,1,1.95.94h0.07a8.25,8.25,0,0,1-.1-1.1V7.15h1.38v9.12H36.44l-0.24-.85H36.13A2.2,2.2,0,0,1,34.19,16.38Zm0.37-1.11a1.5,1.5,0,0,0,1.24-.48,2.51,2.51,0,0,0,.4-1.55V13a2.9,2.9,0,0,0-.4-1.74,1.48,1.48,0,0,0-1.25-.52,1.27,1.27,0,0,0-1.12.59A3,3,0,0,0,33,13.06a2.94,2.94,0,0,0,.38,1.64A1.29,1.29,0,0,0,34.56,15.27Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-write" data-name="op-write" viewBox="0 0 49.54 25.5">
      <g id="_Group_6" data-name="&lt;Group&gt;">
        <g>
          <path d="M48.83,12.75a12,12,0,0,1-12,12H12.71a12,12,0,1,1,0-24H36.83a12,12,0,0,1,12,12h0Z" fill="#e5daf2"/>
          <path d="M49.54,13.5a12,12,0,0,1-12,12H12a12,12,0,0,1-12-12V12A12,12,0,0,1,12,0H37.54a12,12,0,0,1,12,12v1.5ZM1.43,12.75c0,6.19,5.4,11.25,12,11.25H36.12c6.6,0,12-5.06,12-11.25S42.72,1.5,36.12,1.5H13.43C6.83,1.5,1.43,6.56,1.43,12.75Z" fill="#666"/>
        </g>
      </g>
      <g>
        <path d="M16.74,16.25l-0.84-3q-0.15-.48-0.55-2.23H15.3q-0.34,1.58-.54,2.24l-0.86,3H12.37L10.56,9.77H12L12.79,13q0.28,1.18.4,2h0q0.06-.43.18-1t0.21-.83l1-3.41h1.51l1,3.41q0.09,0.29.22,0.88a6.76,6.76,0,0,1,.16.92h0a18,18,0,0,1,.41-2l0.84-3.19h1.38l-1.83,6.48H16.74Z" fill="#666"/>
        <path d="M24.51,9.65a3.31,3.31,0,0,1,.69.06L25.06,11a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4v3.39H21.23V9.77H22.3l0.18,1.14h0.07A2.57,2.57,0,0,1,23.4,10,2,2,0,0,1,24.51,9.65Z" fill="#666"/>
        <path d="M26.32,8.05a0.76,0.76,0,0,1,.2-0.57,0.79,0.79,0,0,1,.58-0.2,0.77,0.77,0,0,1,.57.2,0.76,0.76,0,0,1,.2.57,0.75,0.75,0,0,1-.2.55,0.76,0.76,0,0,1-.57.2,0.78,0.78,0,0,1-.58-0.2A0.75,0.75,0,0,1,26.32,8.05Zm1.46,8.2H26.4V9.77h1.38v6.48Z" fill="#666"/>
        <path d="M32.16,15.25a3.35,3.35,0,0,0,1-.16v1a2.78,2.78,0,0,1-.59.17,4.06,4.06,0,0,1-.75.07,1.78,1.78,0,0,1-2-2.06V10.81H29V10.2l0.95-.5,0.47-1.37h0.85V9.77H33.1v1H31.26v3.47a1,1,0,0,0,.25.74A0.91,0.91,0,0,0,32.16,15.25Z" fill="#666"/>
        <path d="M37.29,16.37a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5A2.73,2.73,0,0,1,37,9.65a2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74H35.49A2.13,2.13,0,0,0,36,14.77a1.78,1.78,0,0,0,1.35.51,5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,37.29,16.37ZM37,10.7a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,37,10.7Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"/>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"/>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"/>
        </g>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="168" y="204" width="648" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="168" y="204" width="648" height="72" rx="10" ry="10" fill="none" stroke="#667780"/>
    </g>
  </g>
  <use id="array-small-3" data-name="array-small" width="182.08" height="31.66" transform="translate(112.67 48.44)" xlink:href="#array-small"/>
  <use width="182.08" height="31.66" transform="translate(305.75 48.44)" xlink:href="#array-small"/>
  <use width="182.08" height="31.66" transform="translate(497.75 48.44)" xlink:href="#array-small"/>
  <use id="array-small-10" data-name="array-small" width="182.08" height="31.66" transform="translate(689.75 48.44)" xlink:href="#array-small"/>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="757.64" y="218" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="757.64" y="218" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M786.66,249l-1.93-4.94h-6.23L776.58,249h-1.83l6.14-15.61h1.52L788.53,249h-1.87Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(755.89 215.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <path d="M222,84l29.83,29c3.94,3.84,11.67,7,17.17,7h40.89c5.5,0,13.1-3.27,16.88-7.26l23.5-24.8" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M354,84a27.2,27.2,0,0,0-2.18,8.53l-2-4.07-4.17-1.82A27.18,27.18,0,0,0,354,84Z" fill="#666"/>
  </g>
  <g>
    <path d="M372,84l-34.93,34.93C333.18,122.82,330,130.5,330,136v46c0,5.5,3.18,13.18,7.07,17.07l25.09,25.09" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M366,228a27.2,27.2,0,0,0-8.47-2.41l4.12-1.93,1.93-4.12A27.18,27.18,0,0,0,366,228Z" fill="#666"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M361.83,157.5a12,12,0,0,1-12,12H325.71a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M362.55,158.25a12,12,0,0,1-12,12H325a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12h25.54a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H326.43C319.83,146.25,314.43,151.31,314.43,157.5Z"/>
      <path d="M329.25,154.42a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V161H326v-6.48H327l0.18,1.14h0.07a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,329.25,154.42Z"/>
      <path d="M334,161.13a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74h-4.32a2.13,2.13,0,0,0,.51,1.45A1.78,1.78,0,0,0,334,160a5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,334,161.13Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,333.71,155.46Z"/>
      <path d="M342.1,161l-0.28-.9h0a2.65,2.65,0,0,1-.94.81,3,3,0,0,1-1.22.21,2.06,2.06,0,0,1-1.49-.52,1.93,1.93,0,0,1-.54-1.46,1.71,1.71,0,0,1,.74-1.51,4.29,4.29,0,0,1,2.27-.56l1.12,0v-0.35a1.31,1.31,0,0,0-.29-0.93,1.18,1.18,0,0,0-.9-0.31,3.11,3.11,0,0,0-1,.15,7.21,7.21,0,0,0-.88.35l-0.45-1a4.79,4.79,0,0,1,1.15-.42,5.31,5.31,0,0,1,1.18-.14,2.8,2.8,0,0,1,1.87.54,2.11,2.11,0,0,1,.63,1.69V161h-1Zm-2.05-.94a1.71,1.71,0,0,0,1.2-.42,1.52,1.52,0,0,0,.45-1.17v-0.56l-0.83,0a2.85,2.85,0,0,0-1.42.33,1,1,0,0,0-.44.89,0.87,0.87,0,0,0,.26.67A1.11,1.11,0,0,0,340.05,160.08Z"/>
      <path d="M347.19,161.13a2.26,2.26,0,0,1-1.89-.88,4.82,4.82,0,0,1,0-4.95,2.28,2.28,0,0,1,1.91-.89,2.23,2.23,0,0,1,1.95.94h0.07a8.25,8.25,0,0,1-.1-1.1V151.9h1.38V161h-1.08l-0.24-.85h-0.06A2.2,2.2,0,0,1,347.19,161.13Zm0.37-1.11a1.5,1.5,0,0,0,1.24-.48,2.51,2.51,0,0,0,.4-1.55V157.8a2.9,2.9,0,0,0-.4-1.74,1.48,1.48,0,0,0-1.25-.52,1.27,1.27,0,0,0-1.12.59,3,3,0,0,0-.39,1.68,2.94,2.94,0,0,0,.38,1.64A1.29,1.29,0,0,0,347.56,160Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(312 142.75)" xlink:href="#op-read"/>
  </g>
  <g id="_Group_5" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M318.29,122.5a12,12,0,0,1-12,12H282.17a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M319,123.25a12,12,0,0,1-12,12H281.46a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12H307a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H282.88C276.28,111.25,270.88,116.31,270.88,122.5Z"/>
      <path d="M286.2,126l-0.84-3q-0.15-.48-0.55-2.23h-0.05q-0.34,1.58-.54,2.24l-0.86,3h-1.52L280,119.52h1.41l0.83,3.19q0.28,1.18.4,2h0q0.06-.43.18-1t0.21-.83l1-3.41h1.51l1,3.41q0.09,0.29.22,0.88a6.76,6.76,0,0,1,.16.92h0a18,18,0,0,1,.41-2l0.84-3.19h1.38L287.74,126H286.2Z"/>
      <path d="M294,119.4a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V126h-1.38v-6.48h1.08l0.18,1.14H292a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,294,119.4Z"/>
      <path d="M295.78,117.8a0.76,0.76,0,0,1,.2-0.57,0.79,0.79,0,0,1,.58-0.2,0.77,0.77,0,0,1,.57.2,0.76,0.76,0,0,1,.2.57,0.75,0.75,0,0,1-.2.55,0.76,0.76,0,0,1-.57.2,0.78,0.78,0,0,1-.58-0.2A0.75,0.75,0,0,1,295.78,117.8Zm1.46,8.2h-1.38v-6.48h1.38V126Z"/>
      <path d="M301.62,125a3.35,3.35,0,0,0,1-.16v1a2.78,2.78,0,0,1-.59.17,4.06,4.06,0,0,1-.75.07,1.78,1.78,0,0,1-2-2.06v-3.49h-0.88V120l0.95-.5,0.47-1.37h0.85v1.44h1.85v1h-1.85V124a1,1,0,0,0,.25.74A0.91,0.91,0,0,0,301.62,125Z"/>
      <path d="M306.75,126.12a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74H305a2.13,2.13,0,0,0,.51,1.45,1.78,1.78,0,0,0,1.35.51,5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,306.75,126.12Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,306.5,120.45Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(268.46 107.75)" xlink:href="#op-write"/>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M222,216l64.93-64.93c3.45-3.45,6.35-7.94,7-10.64" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M294,135a27.2,27.2,0,0,0,3.93,7.88l-4.21-1.74-4.34,1.36A27.17,27.17,0,0,0,294,135Z" fill="#666"/>
    </g>
  </g>
  <g>
    <path d="M414,84l29.83,29c3.94,3.84,11.67,7,17.17,7h40.89c5.5,0,13.1-3.27,16.88-7.26l23.5-24.8" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M546,84a27.2,27.2,0,0,0-2.18,8.53l-2-4.07-4.17-1.82A27.18,27.18,0,0,0,546,84Z" fill="#666"/>
  </g>
  <g>
    <path d="M564,84l-34,34.84c-3.84,3.94-7,11.66-7,17.16v46c0,5.5,3.14,13.23,7,17.17l24.24,24.94" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M558,228a27.2,27.2,0,0,0-8.43-2.53l4.15-1.87,2-4.09A27.17,27.17,0,0,0,558,228Z" fill="#666"/>
  </g>
  <g id="_Group_7" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M553.83,157.5a12,12,0,0,1-12,12H517.71a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M554.55,158.25a12,12,0,0,1-12,12H517a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12h25.54a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H518.43C511.83,146.25,506.43,151.31,506.43,157.5Z"/>
      <path d="M521.25,154.42a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V161H518v-6.48H519l0.18,1.14h0.07a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,521.25,154.42Z"/>
      <path d="M526,161.13a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74h-4.32a2.13,2.13,0,0,0,.51,1.45A1.78,1.78,0,0,0,526,160a5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,526,161.13Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,525.71,155.46Z"/>
      <path d="M534.1,161l-0.28-.9h0a2.65,2.65,0,0,1-.94.81,3,3,0,0,1-1.22.21,2.06,2.06,0,0,1-1.49-.52,1.93,1.93,0,0,1-.54-1.46,1.71,1.71,0,0,1,.74-1.51,4.29,4.29,0,0,1,2.27-.56l1.12,0v-0.35a1.31,1.31,0,0,0-.29-0.93,1.18,1.18,0,0,0-.9-0.31,3.11,3.11,0,0,0-1,.15,7.21,7.21,0,0,0-.88.35l-0.45-1a4.79,4.79,0,0,1,1.15-.42,5.31,5.31,0,0,1,1.18-.14,2.8,2.8,0,0,1,1.87.54,2.11,2.11,0,0,1,.63,1.69V161h-1Zm-2.05-.94a1.71,1.71,0,0,0,1.2-.42,1.52,1.52,0,0,0,.45-1.17v-0.56l-0.83,0a2.85,2.85,0,0,0-1.42.33,1,1,0,0,0-.44.89,0.87,0.87,0,0,0,.26.67A1.11,1.11,0,0,0,532.05,160.08Z"/>
      <path d="M539.19,161.13a2.26,2.26,0,0,1-1.89-.88,4.82,4.82,0,0,1,0-4.95,2.28,2.28,0,0,1,1.91-.89,2.23,2.23,0,0,1,1.95.94h0.07a8.25,8.25,0,0,1-.1-1.1V151.9h1.38V161h-1.08l-0.24-.85h-0.06A2.2,2.2,0,0,1,539.19,161.13Zm0.37-1.11a1.5,1.5,0,0,0,1.24-.48,2.51,2.51,0,0,0,.4-1.55V157.8a2.9,2.9,0,0,0-.4-1.74,1.48,1.48,0,0,0-1.25-.52,1.27,1.27,0,0,0-1.12.59,3,3,0,0,0-.39,1.68,2.94,2.94,0,0,0,.38,1.64A1.29,1.29,0,0,0,539.56,160Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(504 142.75)" xlink:href="#op-read"/>
  </g>
  <g id="_Group_9" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M510.29,122.5a12,12,0,0,1-12,12H474.17a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M511,123.25a12,12,0,0,1-12,12H473.46a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12H499a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H474.88C468.28,111.25,462.88,116.31,462.88,122.5Z"/>
      <path d="M478.2,126l-0.84-3q-0.15-.48-0.55-2.23h-0.05q-0.34,1.58-.54,2.24l-0.86,3h-1.52L472,119.52h1.41l0.83,3.19q0.28,1.18.4,2h0q0.06-.43.18-1t0.21-.83l1-3.41h1.51l1,3.41q0.09,0.29.22,0.88a6.76,6.76,0,0,1,.16.92h0a18,18,0,0,1,.41-2l0.84-3.19h1.38L479.74,126H478.2Z"/>
      <path d="M486,119.4a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V126h-1.38v-6.48h1.08l0.18,1.14H484a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,486,119.4Z"/>
      <path d="M487.78,117.8a0.76,0.76,0,0,1,.2-0.57,0.79,0.79,0,0,1,.58-0.2,0.77,0.77,0,0,1,.57.2,0.76,0.76,0,0,1,.2.57,0.75,0.75,0,0,1-.2.55,0.76,0.76,0,0,1-.57.2,0.78,0.78,0,0,1-.58-0.2A0.75,0.75,0,0,1,487.78,117.8Zm1.46,8.2h-1.38v-6.48h1.38V126Z"/>
      <path d="M493.62,125a3.35,3.35,0,0,0,1-.16v1a2.78,2.78,0,0,1-.59.17,4.06,4.06,0,0,1-.75.07,1.78,1.78,0,0,1-2-2.06v-3.49h-0.88V120l0.95-.5,0.47-1.37h0.85v1.44h1.85v1h-1.85V124a1,1,0,0,0,.25.74A0.91,0.91,0,0,0,493.62,125Z"/>
      <path d="M498.75,126.12a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74H497a2.13,2.13,0,0,0,.51,1.45,1.78,1.78,0,0,0,1.35.51,5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,498.75,126.12Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,498.5,120.45Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(460.46 107.75)" xlink:href="#op-write"/>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M414,216l64.93-64.93c3.7-3.7,6.75-8.78,7-11.64" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M486,134a27.2,27.2,0,0,0,4.13,7.77l-4.25-1.63-4.31,1.46A27.18,27.18,0,0,0,486,134Z" fill="#666"/>
    </g>
  </g>
  <g>
    <path d="M606,84l29.83,29c3.94,3.84,11.67,7,17.17,7h40.89c5.5,0,13.1-3.27,16.88-7.26l23.5-24.8" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M738,84a27.2,27.2,0,0,0-2.18,8.53l-2-4.07-4.17-1.82A27.18,27.18,0,0,0,738,84Z" fill="#666"/>
  </g>
  <g>
    <path d="M756,84l-34.93,34.93C717.18,122.82,714,130.5,714,136v46c0,5.5,3.18,13.18,7.07,17.07l25.09,25.09" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M750,228a27.2,27.2,0,0,0-8.47-2.41l4.12-1.93,1.93-4.12A27.18,27.18,0,0,0,750,228Z" fill="#666"/>
  </g>
  <g id="_Group_11" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M745.83,157.5a12,12,0,0,1-12,12H709.71a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M746.55,158.25a12,12,0,0,1-12,12H709a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12h25.54a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H710.43C703.83,146.25,698.43,151.31,698.43,157.5Z"/>
      <path d="M713.25,154.42a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V161H710v-6.48H711l0.18,1.14h0.07a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,713.25,154.42Z"/>
      <path d="M718,161.13a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74h-4.32a2.13,2.13,0,0,0,.51,1.45A1.78,1.78,0,0,0,718,160a5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,718,161.13Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,717.71,155.46Z"/>
      <path d="M726.1,161l-0.28-.9h0a2.65,2.65,0,0,1-.94.81,3,3,0,0,1-1.22.21,2.06,2.06,0,0,1-1.49-.52,1.93,1.93,0,0,1-.54-1.46,1.71,1.71,0,0,1,.74-1.51,4.29,4.29,0,0,1,2.27-.56l1.12,0v-0.35a1.31,1.31,0,0,0-.29-0.93,1.18,1.18,0,0,0-.9-0.31,3.11,3.11,0,0,0-1,.15,7.21,7.21,0,0,0-.88.35l-0.45-1a4.79,4.79,0,0,1,1.15-.42,5.31,5.31,0,0,1,1.18-.14,2.8,2.8,0,0,1,1.87.54,2.11,2.11,0,0,1,.63,1.69V161h-1Zm-2.05-.94a1.71,1.71,0,0,0,1.2-.42,1.52,1.52,0,0,0,.45-1.17v-0.56l-0.83,0a2.85,2.85,0,0,0-1.42.33,1,1,0,0,0-.44.89,0.87,0.87,0,0,0,.26.67A1.11,1.11,0,0,0,724.05,160.08Z"/>
      <path d="M731.19,161.13a2.26,2.26,0,0,1-1.89-.88,4.82,4.82,0,0,1,0-4.95,2.28,2.28,0,0,1,1.91-.89,2.23,2.23,0,0,1,1.95.94h0.07a8.25,8.25,0,0,1-.1-1.1V151.9h1.38V161h-1.08l-0.24-.85h-0.06A2.2,2.2,0,0,1,731.19,161.13Zm0.37-1.11a1.5,1.5,0,0,0,1.24-.48,2.51,2.51,0,0,0,.4-1.55V157.8a2.9,2.9,0,0,0-.4-1.74,1.48,1.48,0,0,0-1.25-.52,1.27,1.27,0,0,0-1.12.59,3,3,0,0,0-.39,1.68,2.94,2.94,0,0,0,.38,1.64A1.29,1.29,0,0,0,731.56,160Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(696 142.75)" xlink:href="#op-read"/>
  </g>
  <g id="_Group_13" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <path d="M702.29,122.5a12,12,0,0,1-12,12H666.17a12,12,0,0,1,0-24h24.12a12,12,0,0,1,12,12h0Z"/>
      <path d="M703,123.25a12,12,0,0,1-12,12H665.46a12,12,0,0,1-12-12v-1.5a12,12,0,0,1,12-12H691a12,12,0,0,1,12,12v1.5Zm-48.12-.75c0,6.19,5.4,11.25,12,11.25h22.69c6.6,0,12-5.06,12-11.25s-5.4-11.25-12-11.25H666.88C660.28,111.25,654.88,116.31,654.88,122.5Z"/>
      <path d="M670.2,126l-0.84-3q-0.15-.48-0.55-2.23h-0.05q-0.34,1.58-.54,2.24l-0.86,3h-1.52L664,119.52h1.41l0.83,3.19q0.28,1.18.4,2h0q0.06-.43.18-1t0.21-.83l1-3.41h1.51l1,3.41q0.09,0.29.22,0.88a6.76,6.76,0,0,1,.16.92h0a18,18,0,0,1,.41-2l0.84-3.19h1.38L671.74,126H670.2Z"/>
      <path d="M678,119.4a3.31,3.31,0,0,1,.69.06l-0.13,1.28a2.6,2.6,0,0,0-.61-0.07,1.76,1.76,0,0,0-1.34.54,2,2,0,0,0-.51,1.4V126h-1.38v-6.48h1.08l0.18,1.14H676a2.57,2.57,0,0,1,.84-0.92A2,2,0,0,1,678,119.4Z"/>
      <path d="M679.78,117.8a0.76,0.76,0,0,1,.2-0.57,0.79,0.79,0,0,1,.58-0.2,0.77,0.77,0,0,1,.57.2,0.76,0.76,0,0,1,.2.57,0.75,0.75,0,0,1-.2.55,0.76,0.76,0,0,1-.57.2,0.78,0.78,0,0,1-.58-0.2A0.75,0.75,0,0,1,679.78,117.8Zm1.46,8.2h-1.38v-6.48h1.38V126Z"/>
      <path d="M685.62,125a3.35,3.35,0,0,0,1-.16v1a2.78,2.78,0,0,1-.59.17,4.06,4.06,0,0,1-.75.07,1.78,1.78,0,0,1-2-2.06v-3.49h-0.88V120l0.95-.5,0.47-1.37h0.85v1.44h1.85v1h-1.85V124a1,1,0,0,0,.25.74A0.91,0.91,0,0,0,685.62,125Z"/>
      <path d="M690.75,126.12a3.13,3.13,0,0,1-2.36-.88,3.35,3.35,0,0,1-.85-2.43,3.67,3.67,0,0,1,.79-2.5,2.73,2.73,0,0,1,2.17-.91,2.67,2.67,0,0,1,2,.78,3,3,0,0,1,.74,2.14v0.74H689a2.13,2.13,0,0,0,.51,1.45,1.78,1.78,0,0,0,1.35.51,5,5,0,0,0,1.07-.11,5.61,5.61,0,0,0,1.06-.36v1.12a4.23,4.23,0,0,1-1,.34A6.25,6.25,0,0,1,690.75,126.12Zm-0.25-5.67a1.38,1.38,0,0,0-1.05.42,2,2,0,0,0-.47,1.21h2.94a1.79,1.79,0,0,0-.39-1.22A1.32,1.32,0,0,0,690.5,120.45Z"/>
    </g>
    <use width="49.54" height="25.5" transform="translate(652.46 107.75)" xlink:href="#op-write"/>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M606,216l64.93-64.93c3.7-3.7,6.75-8.78,7-11.64" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M678,134a27.2,27.2,0,0,0,4.13,7.77l-4.25-1.63-4.31,1.46A27.18,27.18,0,0,0,678,134Z" fill="#666"/>
    </g>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M222,234l70.93-70.93c3.7-3.7,8.78-6.75,11.64-7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M310,156a27.2,27.2,0,0,0-7.61,4.43l1.46-4.31-1.63-4.25A27.18,27.18,0,0,0,310,156Z" fill="#666"/>
    </g>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M414,234l70.93-70.93c3.7-3.7,8.78-6.75,11.64-7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M502,156a27.2,27.2,0,0,0-7.61,4.43l1.46-4.31-1.63-4.25A27.18,27.18,0,0,0,502,156Z" fill="#666"/>
    </g>
  </g>
  <g opacity="0.4">
    <g>
      <path d="M606,234l70.93-70.93c3.7-3.7,8.78-6.75,11.64-7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M694,156a27.2,27.2,0,0,0-7.61,4.43l1.46-4.31-1.63-4.25A27.18,27.18,0,0,0,694,156Z" fill="#666"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="372.14" y="218" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="372.14" y="218" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M401.16,249l-1.93-4.94H393L391.08,249h-1.83l6.14-15.61h1.52L403,249h-1.87Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(370.39 215.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="565.64" y="218" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="565.64" y="218" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M594.66,249l-1.93-4.94h-6.23L584.58,249h-1.83l6.14-15.61h1.52L596.53,249h-1.87Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(563.89 215.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="181.64" y="218" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="181.64" y="218" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M210.66,249l-1.93-4.94h-6.23L200.58,249h-1.83l6.14-15.61h1.52L212.53,249h-1.87Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(179.89 215.25)" xlink:href="#rnn-a"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(115 33)" font-size="13" font-family="Open Sans">Memory is an array of vectors</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(114 117.14)" font-size="13" font-family="Open Sans">Network A <tspan x="0" y="20">writes and reads </tspan><tspan x="0" y="40">from this memory </tspan><tspan x="0" y="60">each step</tspan></text>
  </g>
  <g>
    <line x1="228.89" y1="240" x2="362.21" y2="240" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M367.64,240a27.2,27.2,0,0,0-7.69,4.28L361.5,240l-1.55-4.28A27.18,27.18,0,0,0,367.64,240Z" fill="#666"/>
  </g>
  <g>
    <line x1="420.89" y1="240" x2="554.21" y2="240" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M559.64,240a27.2,27.2,0,0,0-7.69,4.28L553.5,240l-1.55-4.28A27.18,27.18,0,0,0,559.64,240Z" fill="#666"/>
  </g>
  <g>
    <line x1="612.89" y1="240" x2="746.21" y2="240" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M751.64,240a27.2,27.2,0,0,0-7.69,4.28L745.5,240l-1.55-4.28A27.18,27.18,0,0,0,751.64,240Z" fill="#666"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(187.27 306)" font-size="13" font-family="Open Sans">x0</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(211.4 306)" font-size="13" font-family="Open Sans">y0</text>
  </g>
  <g>
    <line x1="193.39" y1="291.08" x2="193.39" y2="274.01" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M193.39,268.58a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,193.39,268.58Z" fill="#666"/>
  </g>
  <g>
    <line x1="217.39" y1="264.58" x2="217.39" y2="285.65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M217.39,291.08a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,217.39,291.08Z" fill="#666"/>
  </g>
  <g>
    <line x1="382.39" y1="292.41" x2="382.39" y2="274.01" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M382.39,268.58a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,382.39,268.58Z" fill="#666"/>
  </g>
  <g>
    <line x1="407.39" y1="264.58" x2="407.39" y2="286.98" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M407.39,292.41a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,407.39,292.41Z" fill="#666"/>
  </g>
  <g>
    <line x1="575.22" y1="292.41" x2="575.22" y2="274.01" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M575.22,268.58a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,575.22,268.58Z" fill="#666"/>
  </g>
  <g>
    <line x1="600.22" y1="264.58" x2="600.22" y2="286.98" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M600.22,292.41a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,600.22,292.41Z" fill="#666"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(374.94 306)" font-size="13" font-family="Open Sans">x1</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(399.07 306)" font-size="13" font-family="Open Sans">y1</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(567.77 306)" font-size="13" font-family="Open Sans">x2</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(591.9 306)" font-size="13" font-family="Open Sans">y2</text>
  </g>
  <g>
    <line x1="767.22" y1="292.41" x2="767.22" y2="274.01" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M767.22,268.58a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,767.22,268.58Z" fill="#666"/>
  </g>
  <g>
    <line x1="792.22" y1="264.58" x2="792.22" y2="286.98" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M792.22,292.41a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,792.22,292.41Z" fill="#666"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(759.77 306)" font-size="13" font-family="Open Sans">x2</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(783.9 306)" font-size="13" font-family="Open Sans">y2</text>
  </g>
  <use width="36" height="36" transform="translate(114 47.96) scale(0.83)" xlink:href="#array-vector"/>
  <use id="array-vector-5" data-name="array-vector" width="36" height="36" transform="translate(144.04 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(174.08 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use id="array-vector-10" data-name="array-vector" width="36" height="36" transform="translate(204.13 48.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 321.02, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(336.04 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(366.08 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(396.13 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 513.02, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 543.06, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(558.08 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(588.13 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 705.02, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 735.06, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="matrix(0.59, 0.59, -0.59, 0.59, 765.1, 43)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(780.13 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(234 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(426 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(456 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use id="array-vector-43" data-name="array-vector" width="36" height="36" transform="translate(264 49.99) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(618 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(648 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(810 49.22) scale(0.83)" xlink:href="#array-vector"/>
  <use width="36" height="36" transform="translate(841 48.99) scale(0.83)" xlink:href="#array-vector"/>
</svg>
  </div>
</figure>

<p>But how does reading and writing work? The challenge is that we want to make them differentiable. In particular, we want to make them differentiable with respect to the location we read from or write to, so that we can learn where to read and write. This is tricky because memory addresses seem to be fundamentally discrete. NTMs take a very clever solution to this: every step, they read and write everywhere, just to different extents.</p>
<p>As an example, let’s focus on reading. Instead of specifying a single location, the RNN gives “attention distribution” which describe how we spread out the amount we care about different memory positions. As such, the result of the read operation is a weighted sum.</p>
<figure class="w-page" id="rnn-read">
<svg id="edges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="250" viewBox="0 0 984 250">
  <defs>
    <symbol id="array-7" data-name="array-7" viewBox="0 0 253.5 37.5">
      <rect x="0.75" y="0.75" width="252" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
      <line x1="36.25" y1="36.75" x2="36.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="72.25" y1="36.75" x2="72.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="108.25" y1="36.75" x2="108.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="144.25" y1="36.75" x2="144.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="180.25" y1="36.75" x2="180.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="216.25" y1="36.75" x2="216.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
    </symbol>
    <symbol id="array-1" data-name="array-1" viewBox="0 0 37.5 37.5">
      <rect x="0.75" y="0.75" width="36" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"/>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"/>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"/>
        </g>
      </g>
    </symbol>
    <symbol id="array-positive-value" data-name="array-positive-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"/>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#3a5edd" opacity="0.8"/>
    </symbol>
    <symbol id="pointer" data-name="pointer" viewBox="0 0 26.87 26.87">
      <circle cx="13.43" cy="13.43" r="12.93" fill="none" stroke="#ffdc8c" stroke-miterlimit="10"/>
      <circle cx="13.43" cy="13.43" r="10.38" fill="#ffb200"/>
      <polygon points="11.32 19.26 11.32 17.43 10.72 17.43 10.71 16.14 10.1 16.21 10.1 15 9.54 14.99 9.46 13.78 8.88 13.78 8.89 13.16 8.28 13.16 8.28 11.34 10.11 11.34 10.11 11.94 10.71 11.94 10.71 6.46 11.33 6.45 11.33 5.86 12.54 5.86 12.54 6.45 13.16 6.47 13.16 8.89 14.37 8.89 14.39 9.49 16.21 9.51 16.21 10.12 17.43 10.12 17.43 10.79 18.04 10.73 18.05 11.39 18.65 11.33 18.65 15.61 18.04 15.52 17.98 17.43 17.43 17.43 17.43 19.26 11.32 19.26" fill="#fff" opacity="0.2"/>
      <g>
        <path d="M10.11,11.94c0-.09,0-0.19,0-0.28s0-.21,0-0.32H8.28v1.82H8.89V11.95h1.23v0.63h0.6v0.6h0.61V13.09q0-2.4,0-4.8,0-.92,0-1.85h1.21V5.85H11.33v0.6H10.71v5.47h-0.6Zm4.28-2.44a0.45,0.45,0,0,1,0-.07c0-.15,0-0.3,0-0.45s0,0,0-.08H13.16V6.47H12.55v5.47h0.61V9.51h1.24s0,0.06,0,.09q0,1.12,0,2.25s0,0.07,0,.1H15V10.12h1.23v2.43h0.6V10.71l0.57,0s0,0,0,.05,0,0.29,0,.44,0,0.07,0,.11H18a0,0,0,0,1,.06.06c0,0.24,0,.48,0,0.72q0,1.71,0,3.41s0,0,0,.08h-0.6s0,0,0,0q0,0.86,0,1.72s0,0,0,.06H16.81v1.21H11.94V17.42H11.33V16.21h-0.6a11.4,11.4,0,0,0,0,1.22h0.6v1.83c2,0,4.07,0,6.11,0,0-.1,0-0.19,0-0.28,0-.46,0-0.93,0-1.39a1.53,1.53,0,0,0,0-.16H18c0.05,0,.07,0,0.07-0.07,0-.45,0-0.89,0-1.34,0-.13,0-0.26,0-0.4l0.3,0h0.3V11.33H18v-0.6H17.43V10.11H16.21V9.51H14.39ZM10.1,15v1.21h0.52a0.07,0.07,0,0,0,.08-0.08c0-.32,0-0.65,0-1,0-.06,0-0.11,0-0.17H10.11V13.77H9.49V13.16H8.91a2.7,2.7,0,0,0,0,.62H9.47s0,0,0,.07,0,0.27,0,.41,0,0.45,0,.68a0,0,0,0,0,.05.06H10.1Z" fill="#fff"/>
        <path d="M17.43,17.43s0,0,0-.06q0-.86,0-1.72s0,0,0,0H18s0-.06,0-0.08q0-1.71,0-3.41c0-.24,0-0.48,0-0.72A0,0,0,0,0,18,11.33H17.44s0-.07,0-0.11,0-.29,0-0.44,0-.05,0-0.05l-0.57,0v1.84h-0.6V10.12H15v1.82H14.38s0-.07,0-0.1q0-1.12,0-2.25s0-.06,0-0.09h1.81v0.6h1.22v0.62H18v0.6h0.61v4.28h-0.3l-0.3,0c0,0.14,0,.27,0,0.4,0,0.45,0,.89,0,1.34,0,0.05,0,.07-0.07.07H17.43Z" fill="#fff"/>
        <path d="M17.43,17.43a1.53,1.53,0,0,1,0,.16c0,0.46,0,.93,0,1.39,0,0.09,0,.17,0,0.28-2,0-4.06,0-6.11,0V17.43h-0.6a11.4,11.4,0,0,1,0-1.22h0.6v1.21h0.61v1.22h4.88V17.43h0.62Z" fill="#fff"/>
        <path d="M11.33,6.45q0,0.92,0,1.85,0,2.4,0,4.8v0.07H10.72v-0.6h-0.6V11.93h0.6V6.46h0.61Z" fill="#fff"/>
        <path d="M14.39,9.49H13.16v2.43H12.55V6.47h0.61V8.89h1.21s0,0.06,0,.08,0,0.3,0,.45a0.44,0.44,0,0,0,0,.07h0Z" fill="#fff"/>
        <path d="M10.1,15H9.54a0,0,0,0,1-.05-0.06c0-.23,0-0.45,0-0.68s0-.27,0-0.41,0,0,0-.07H8.88a2.7,2.7,0,0,1,0-.62H9.49v0.61h0.62V15h0.61c0,0.06,0,.12,0,0.17,0,0.32,0,.65,0,1a0.07,0.07,0,0,1-.08.08H10.1V15Z" fill="#fff"/>
        <path d="M10.11,11.93H8.89v1.21H8.28V11.34h1.83c0,0.11,0,.21,0,0.32s0,0.19,0,.28h0Z" fill="#fff"/>
        <path d="M11.33,6.45V5.85h1.21v0.6H11.33Z" fill="#fff"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="paths">
    <path id="edge0" d="M186,44v66.12c0.56,24,102,24.22,102,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge1" d="M222,44v66.12c0.56,24,68,24.22,68,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge2" d="M258.07,44v66.12c0.56,24,33.93,24.22,33.93,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge3" d="M294,44V188" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge4" d="M330,44v66.12c-0.56,24-34,24.22-34,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge5" d="M366,44v66.12c-0.56,24-68,24.22-68,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="edge6" d="M402,44v66.12c-0.56,24-102,24.22-102,76.88" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <use id="array-7-3" data-name="array-7" width="253.5" height="37.5" transform="translate(167.75 7.75)" xlink:href="#array-7"/>
  <use id="array-7-6" data-name="array-7" width="253.5" height="37.5" transform="translate(167.75 66.75)" xlink:href="#array-7"/>
  <use id="array-1-3" data-name="array-1" width="37.5" height="37.5" transform="translate(275.75 186.75)" xlink:href="#array-1"/>
  <g opacity="0.6">
    <text transform="translate(436 31)" font-size="13" font-family="Open Sans">attention</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(436 89)" font-size="13" font-family="Open Sans">memory</text>
  </g>
  <use id="read-result" width="36" height="36" transform="translate(277 188)" xlink:href="#array-vector"/>
  <g id="attention">
    <use id="array-positive-value-3" data-name="array-positive-value" width="36" height="36" transform="translate(168 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(204 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(240 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(276 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(312 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(348 8)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(384 8)" xlink:href="#array-positive-value"/>
  </g>
  <g id="memory">
    <use width="36" height="36" transform="translate(168 68)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(204 68)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(240 68)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(276 68)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(312 68)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(348 68)" xlink:href="#array-vector"/>
    <use id="array-vector-17" data-name="array-vector" width="36" height="36" transform="translate(384 68)" xlink:href="#array-vector"/>
  </g>
  <use id="pointer-3" data-name="pointer" width="26.87" height="26.87" transform="translate(129.84 12.06)" xlink:href="#pointer"/>
  <g opacity="0.6">
    <text transform="translate(560 30.88)" font-size="13" font-family="Open Sans">The RNN gives an attention distribution <tspan x="0" y="20">which describe how we spread out the </tspan><tspan x="0" y="40">amount we care about different memory </tspan><tspan x="0" y="60">positions</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(560 169.81)" font-size="13" font-family="Open Sans">The read result is a weighted sum.</text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="322" y1="204" x2="323" y2="204" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="325.01" y1="204" x2="533" y2="204" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.01 2.01"/>
      <line x1="534" y1="204" x2="535" y2="204" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g>
    <path d="M563,202.59a1.5,1.5,0,0,0,0-.17l0.11-.48a4.07,4.07,0,0,1,.22-0.67q0.13-.3.33-0.71a2.31,2.31,0,0,1,.43-0.65,4.86,4.86,0,0,1,.56-0.48,1,1,0,0,1,.72-0.2,2.27,2.27,0,0,1,1.11.26,2.61,2.61,0,0,1,.67.48,0.93,0.93,0,0,1,.24.43,0.23,0.23,0,0,0,.07.13,0.76,0.76,0,0,0,.17-0.15,3.19,3.19,0,0,1,2.41-1.13h0.06a1.69,1.69,0,0,1,1.56.89,2.06,2.06,0,0,1,.17.8,1.74,1.74,0,0,1-.28,1,1.35,1.35,0,0,1-.56.5,1.22,1.22,0,0,1-.54.09,1,1,0,0,1-.69-0.24,0.81,0.81,0,0,1-.26-0.63,1.41,1.41,0,0,1,1.21-1.39A1.66,1.66,0,0,0,570,200a2.8,2.8,0,0,0-2.23,1.6,2.88,2.88,0,0,0-.33.72q-0.11.37-.74,2.88-0.74,3-.85,3.23a1,1,0,0,1-.93.59,0.74,0.74,0,0,1-.46-0.13,0.78,0.78,0,0,1-.24-0.26,0.32,0.32,0,0,1,0-.22q0-.28.87-3.73a37.67,37.67,0,0,0,.87-3.84q0-.85-0.56-0.85a0.93,0.93,0,0,0-.78.61A6.3,6.3,0,0,0,564,202a6.18,6.18,0,0,1-.24.78,0.72,0.72,0,0,1-.35,0h-0.3A0.36,0.36,0,0,1,563,202.59Z" fill="#666"/>
    <path d="M598.79,203.15v0.24a0.54,0.54,0,0,1-.33.43H581.91l0.37,0.3a5.92,5.92,0,0,1,.63.59q0.3,0.33.71,0.8a4.41,4.41,0,0,1,.72,1.21q0.3,0.74.56,1.54a2.44,2.44,0,0,1,.11.54q0,0.24-.43.24h-0.22a0.17,0.17,0,0,1-.13-0.09,0.85,0.85,0,0,1-.11-0.19,2.1,2.1,0,0,1-.09-0.41,6.62,6.62,0,0,0-1.47-2.82,6.68,6.68,0,0,0-2.64-1.84,0.85,0.85,0,0,1-.39-0.24,0.25,0.25,0,0,1,.09-0.22,1.44,1.44,0,0,1,.3-0.15,6.66,6.66,0,0,0,1.84-1.08,6.43,6.43,0,0,0,1.24-1.32,7.45,7.45,0,0,0,.69-1.28,10.62,10.62,0,0,0,.37-1l0.06-.37,0.07-.17a0.23,0.23,0,0,1,.11-0.09,0.67,0.67,0,0,1,.28,0q0.43,0,.43.24a2.44,2.44,0,0,1-.11.54,9.12,9.12,0,0,1-.54,1.5,6.26,6.26,0,0,1-.69,1.17q-0.37.48-.67,0.8a6.46,6.46,0,0,1-.65.61l-0.43.37h16.55a0.54,0.54,0,0,1,.33.43v-0.24Z" fill="#666"/>
    <path d="M607.32,188.27s4.41,0,13.11,0h13l1.26,2.93q1.28,3,1.37,3.16h-0.87l-0.15-.3a7.32,7.32,0,0,0-1.21-1.69,9.09,9.09,0,0,0-2.41-1.67,11.86,11.86,0,0,0-3.06-.93,25.21,25.21,0,0,0-3.27-.37q-1.54-.06-4-0.09h-9.71l0.17,0.24q10,13.72,10.08,13.85a0.19,0.19,0,0,1,0,.13L616,210l-5.72,6.5s1.52,0,4.57,0h3.06q1.93,0,2.77,0,2.95,0,4.77-.11a27.83,27.83,0,0,0,3.62-.46,10,10,0,0,0,3.06-1.06,8.13,8.13,0,0,0,2.23-1.89,6.87,6.87,0,0,0,.89-1.56h0.87s-0.05.17-.15,0.46-0.28.76-.54,1.41-0.48,1.26-.67,1.82l-1.26,3.36-13,0q-13,0-13.11,0a0.18,0.18,0,0,1-.13-0.2,0.33,0.33,0,0,1,0-.13L618.81,205s-0.24-.34-0.71-1-1.24-1.68-2.28-3.12-2-2.73-2.82-3.86l-5.76-7.91,0-.33A0.7,0.7,0,0,1,607.32,188.27Z" fill="#666"/>
    <path d="M619.35,227.92a1.68,1.68,0,0,1,.14-0.47,7.35,7.35,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61T621.38,231a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,619.35,227.92Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,621.84,223.13Z" fill="#666"/>
    <path d="M648.53,201.7a2,2,0,0,0-.11-0.48,2.06,2.06,0,0,0-.5-0.76,1.39,1.39,0,0,0-1-.43,2.08,2.08,0,0,0-1.45.67,4.53,4.53,0,0,0-1.08,1.76,17.3,17.3,0,0,0-.89,3.55v0.24a1.16,1.16,0,0,1,0,.26,1.82,1.82,0,0,0,.39,1.34,1.4,1.4,0,0,0,.93.39,2.45,2.45,0,0,0,1.63-.72,3.64,3.64,0,0,0,1-1.11q0-.09.59-2.32T648.53,201.7Zm-6.89,3.71a6.4,6.4,0,0,1,1.65-4.16,4.85,4.85,0,0,1,3.71-2,2.46,2.46,0,0,1,2,1.06,1.08,1.08,0,0,1,1-.65,0.78,0.78,0,0,1,.5.17,0.53,0.53,0,0,1,.22.43q0,0.28-.8,3.47t-0.82,3.6a1.16,1.16,0,0,0,.15.71,0.64,0.64,0,0,0,.45.2,0.94,0.94,0,0,0,.43-0.2A4.91,4.91,0,0,0,651,206a0.81,0.81,0,0,1,.22-0.45,0.63,0.63,0,0,1,.22,0h0.09q0.41,0,.41.19a3.44,3.44,0,0,1-.11.59,6.8,6.8,0,0,1-.43,1.17,3.69,3.69,0,0,1-.69,1.08,2.14,2.14,0,0,1-.69.45,2.31,2.31,0,0,1-.52,0,2.21,2.21,0,0,1-1.24-.32,1.66,1.66,0,0,1-.65-0.67l-0.13-.33s0,0-.09,0l-0.09.09a3.8,3.8,0,0,1-2.6,1.21,3,3,0,0,1-2.1-.87A3.65,3.65,0,0,1,641.64,205.41Z" fill="#666"/>
    <path d="M652.71,207.66a1.68,1.68,0,0,1,.14-0.47,7.35,7.35,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61t-0.64,1.73a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,652.71,207.66Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,655.21,202.87Z" fill="#666"/>
    <path d="M666.11,195.18a2.36,2.36,0,0,0-1.24-.17,6.23,6.23,0,0,1-.67,0,0.18,0.18,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.65,0.65,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.06s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.3,0.3,0,0,0,.17,0l0.26,0h0.65l1,0h2a0.43,0.43,0,0,1,.35.11q0,0.09.8,6.11l0.78,6,0.5-.8q0.52-.78,1.39-2.17l1.91-3q3.79-6,3.84-6.09l0.07-.07,0.09-.06,0.13,0h2.95a5.27,5.27,0,0,0,.63,0q0.74,0,.74.24a1.78,1.78,0,0,1-.07.37q-0.07.26-.07,0.28a1.28,1.28,0,0,1-.8.13,9.64,9.64,0,0,0-1.11.07,0.62,0.62,0,0,0-.39.24q-0.06.11-1.56,6.13t-1.52,6.09a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.7,0.7,0,0,0,.37,0,3.47,3.47,0,0,1,.71,0H679a0.78,0.78,0,0,1,.13.24,1.43,1.43,0,0,1-.15.65,0.48,0.48,0,0,1-.35.11l-0.89,0-2,0h-2a6.4,6.4,0,0,0-.76,0q-0.37,0-.37-0.22s0-.13,0-0.3a0.68,0.68,0,0,1,.17-0.39,1.8,1.8,0,0,1,.5-0.07q0.59,0,1.3-.07a0.58,0.58,0,0,0,.41-0.26q0-.09.82-3.16t1.54-6.13l0.76-3.06-4.2,6.7q-4.25,6.76-4.35,6.87l-0.09,0a0.7,0.7,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.89-6.72l-0.85-6.65-1.47,5.85q-1.45,5.76-1.45,6,0.13,0.72,1.56.72H666a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.68,0.68,0,0,1-.17.39l-0.24,0h-0.26l-0.74,0-1.39,0-1.34,0-0.8,0a1.17,1.17,0,0,1-.41,0,0.2,0.2,0,0,1-.09-0.2,2.3,2.3,0,0,1,.07-0.3,1.32,1.32,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.92,1.92,0,0,0,1.93-.87q0.09-.13,1.49-5.81T666.11,195.18Z" fill="#666"/>
    <path d="M681.18,207.66a1.68,1.68,0,0,1,.14-0.47,7.37,7.37,0,0,1,.37-0.78,2.53,2.53,0,0,1,.67-0.78,1.39,1.39,0,0,1,.92-0.34,1.45,1.45,0,0,1,1,.35,1.25,1.25,0,0,1,.41.95,3,3,0,0,1-.21.86q-0.21.6-.61,1.61t-0.64,1.73a2.51,2.51,0,0,0-.08.49q0,0.38.26,0.38a1,1,0,0,0,.29,0,1,1,0,0,0,.35-0.21,2.08,2.08,0,0,0,.41-0.54,4.45,4.45,0,0,0,.38-0.9,0.63,0.63,0,0,1,.08-0.21,0.56,0.56,0,0,1,.26,0q0.31,0,.31.15a1.68,1.68,0,0,1-.14.47,6,6,0,0,1-.38.78,2.56,2.56,0,0,1-.69.77,1.54,1.54,0,0,1-.95.34,1.44,1.44,0,0,1-.9-0.32,1.2,1.2,0,0,1-.43-1,1.54,1.54,0,0,1,.08-0.49q0.08-.23.66-1.75t0.67-1.85a2.54,2.54,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.07,1.07,0,0,0-.84.51,3.57,3.57,0,0,0-.58,1.29l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,681.18,207.66Zm2.5-4.8a0.86,0.86,0,0,1,.29-0.64,1,1,0,0,1,.67-0.29,0.62,0.62,0,0,1,.46.18,0.68,0.68,0,0,1,.2.46,0.87,0.87,0,0,1-.31.64,1,1,0,0,1-.67.31,0.69,0.69,0,0,1-.43-0.15A0.64,0.64,0,0,1,683.68,202.87Z" fill="#666"/>
  </g>
</svg>
</figure>

<p>Similarly, we write everywhere at once to different extents. Again, an attention distribution describes how much we write at every location. We do this by having the new value of a position in memory be a convex combination of the old memory content and the write value, with the position between the two decided by the attention weight.</p>
<p><figure class="w-page" id="rnn-write">
<svg id="edges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="300" viewBox="0 0 984 300">
  <defs>
    <symbol id="array-1" data-name="array-1" viewBox="0 0 37.5 37.5">
      <rect x="0.75" y="0.75" width="36" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
    </symbol>
    <symbol id="array-7" data-name="array-7" viewBox="0 0 253.5 37.5">
      <rect x="0.75" y="0.75" width="252" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
      <line x1="36.25" y1="36.75" x2="36.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="72.25" y1="36.75" x2="72.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="108.25" y1="36.75" x2="108.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="144.25" y1="36.75" x2="144.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="180.25" y1="36.75" x2="180.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="216.25" y1="36.75" x2="216.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
    </symbol>
    <symbol id="array-positive-value" data-name="array-positive-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"/>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#3a5edd" opacity="0.8"/>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"/>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"/>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"/>
        </g>
      </g>
    </symbol>
    <symbol id="pointer" data-name="pointer" viewBox="0 0 26.87 26.87">
      <circle cx="13.43" cy="13.43" r="12.93" fill="none" stroke="#ffdc8c" stroke-miterlimit="10"/>
      <circle cx="13.43" cy="13.43" r="10.38" fill="#ffb200"/>
      <polygon points="11.32 19.26 11.32 17.43 10.72 17.43 10.71 16.14 10.1 16.21 10.1 15 9.54 14.99 9.46 13.78 8.88 13.78 8.89 13.16 8.28 13.16 8.28 11.34 10.11 11.34 10.11 11.94 10.71 11.94 10.71 6.46 11.33 6.45 11.33 5.86 12.54 5.86 12.54 6.45 13.16 6.47 13.16 8.89 14.37 8.89 14.39 9.49 16.21 9.51 16.21 10.12 17.43 10.12 17.43 10.79 18.04 10.73 18.05 11.39 18.65 11.33 18.65 15.61 18.04 15.52 17.98 17.43 17.43 17.43 17.43 19.26 11.32 19.26" fill="#fff" opacity="0.2"/>
      <g>
        <path d="M10.11,11.94c0-.09,0-0.19,0-0.28s0-.21,0-0.32H8.28v1.82H8.89V11.95h1.23v0.63h0.6v0.6h0.61V13.09q0-2.4,0-4.8,0-.92,0-1.85h1.21V5.85H11.33v0.6H10.71v5.47h-0.6Zm4.28-2.44a0.45,0.45,0,0,1,0-.07c0-.15,0-0.3,0-0.45s0,0,0-.08H13.16V6.47H12.55v5.47h0.61V9.51h1.24s0,0.06,0,.09q0,1.12,0,2.25s0,0.07,0,.1H15V10.12h1.23v2.43h0.6V10.71l0.57,0s0,0,0,.05,0,0.29,0,.44,0,0.07,0,.11H18a0,0,0,0,1,.06.06c0,0.24,0,.48,0,0.72q0,1.71,0,3.41s0,0,0,.08h-0.6s0,0,0,0q0,0.86,0,1.72s0,0,0,.06H16.81v1.21H11.94V17.42H11.33V16.21h-0.6a11.4,11.4,0,0,0,0,1.22h0.6v1.83c2,0,4.07,0,6.11,0,0-.1,0-0.19,0-0.28,0-.46,0-0.93,0-1.39a1.53,1.53,0,0,0,0-.16H18c0.05,0,.07,0,0.07-0.07,0-.45,0-0.89,0-1.34,0-.13,0-0.26,0-0.4l0.3,0h0.3V11.33H18v-0.6H17.43V10.11H16.21V9.51H14.39ZM10.1,15v1.21h0.52a0.07,0.07,0,0,0,.08-0.08c0-.32,0-0.65,0-1,0-.06,0-0.11,0-0.17H10.11V13.77H9.49V13.16H8.91a2.7,2.7,0,0,0,0,.62H9.47s0,0,0,.07,0,0.27,0,.41,0,0.45,0,.68a0,0,0,0,0,.05.06H10.1Z" fill="#fff"/>
        <path d="M17.43,17.43s0,0,0-.06q0-.86,0-1.72s0,0,0,0H18s0-.06,0-0.08q0-1.71,0-3.41c0-.24,0-0.48,0-0.72A0,0,0,0,0,18,11.33H17.44s0-.07,0-0.11,0-.29,0-0.44,0-.05,0-0.05l-0.57,0v1.84h-0.6V10.12H15v1.82H14.38s0-.07,0-0.1q0-1.12,0-2.25s0-.06,0-0.09h1.81v0.6h1.22v0.62H18v0.6h0.61v4.28h-0.3l-0.3,0c0,0.14,0,.27,0,0.4,0,0.45,0,.89,0,1.34,0,0.05,0,.07-0.07.07H17.43Z" fill="#fff"/>
        <path d="M17.43,17.43a1.53,1.53,0,0,1,0,.16c0,0.46,0,.93,0,1.39,0,0.09,0,.17,0,0.28-2,0-4.06,0-6.11,0V17.43h-0.6a11.4,11.4,0,0,1,0-1.22h0.6v1.21h0.61v1.22h4.88V17.43h0.62Z" fill="#fff"/>
        <path d="M11.33,6.45q0,0.92,0,1.85,0,2.4,0,4.8v0.07H10.72v-0.6h-0.6V11.93h0.6V6.46h0.61Z" fill="#fff"/>
        <path d="M14.39,9.49H13.16v2.43H12.55V6.47h0.61V8.89h1.21s0,0.06,0,.08,0,0.3,0,.45a0.44,0.44,0,0,0,0,.07h0Z" fill="#fff"/>
        <path d="M10.1,15H9.54a0,0,0,0,1-.05-0.06c0-.23,0-0.45,0-0.68s0-.27,0-0.41,0,0,0-.07H8.88a2.7,2.7,0,0,1,0-.62H9.49v0.61h0.62V15h0.61c0,0.06,0,.12,0,0.17,0,0.32,0,.65,0,1a0.07,0.07,0,0,1-.08.08H10.1V15Z" fill="#fff"/>
        <path d="M10.11,11.93H8.89v1.21H8.28V11.34h1.83c0,0.11,0,.21,0,0.32s0,0.19,0,.28h0Z" fill="#fff"/>
        <path d="M11.33,6.45V5.85h1.21v0.6H11.33Z" fill="#fff"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="paths">
    <path id="path24182" d="M288,48.7c0,52.66-101.44,52.89-102,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24184" d="M290,48.7c0,52.66-67.44,52.89-68,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24186" d="M292,48.7c0,52.66-33.44,52.89-34,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24249" d="M294,48V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24264" d="M296,48.7c0,52.66,33.37,52.89,33.93,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24262" d="M298,48.7c0,52.66,67.44,52.89,68,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
    <path id="path24260" d="M300,48.7c0,52.66,101.44,52.89,102,76.88V251" fill="none" stroke="#2a71d8" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <use id="array-1-3" data-name="array-1" width="37.5" height="37.5" transform="translate(274.75 11.75)" xlink:href="#array-1"/>
  <use id="array-7-3" data-name="array-7" width="253.5" height="37.5" transform="translate(167.75 131.75)" xlink:href="#array-7"/>
  <use width="253.5" height="37.5" transform="translate(167.75 190.75)" xlink:href="#array-7"/>
  <use id="array-7-8" data-name="array-7" width="253.5" height="37.5" transform="translate(167.75 250.75)" xlink:href="#array-7"/>
  <g id="attention">
    <use width="36" height="36" transform="translate(168 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(204 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(240 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(276 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(312 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(348 132)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(384 132)" xlink:href="#array-positive-value"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(436 151)" font-size="13" font-family="Open Sans">attention</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(436 216)" font-size="13" font-family="Open Sans">old memory</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(436 276)" font-size="13" font-family="Open Sans">new memory</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(324 36)" font-size="13" font-family="Open Sans">write value</text>
  </g>
  <use id="write-result" width="36" height="36" transform="translate(276 12)" xlink:href="#array-vector"/>
  <g id="memory">
    <use width="36" height="36" transform="translate(168 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(204 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(240 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(276 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(312 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(348 192)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(384 192)" xlink:href="#array-vector"/>
  </g>
  <g id="new-memory">
    <use width="36" height="36" transform="translate(168 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(204 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(240 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(276 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(312 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(348 252)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(384 252)" xlink:href="#array-vector"/>
  </g>
  <use width="26.87" height="26.87" transform="translate(129.37 136.54)" xlink:href="#pointer"/>
  <g opacity="0.6">
    <text transform="translate(560 150.88)" font-size="13" font-family="Open Sans">The RNN gives an attention distribution, <tspan x="0" y="20">describing how much we should change </tspan><tspan x="0" y="40">each memory position towards the write </tspan><tspan x="0" y="60">value.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(560 65.88)" font-size="13" font-family="Open Sans">Instead of writing to one location, we write <tspan x="0" y="20">everywhere, just do different extents.</tspan></text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="322" y1="73" x2="323" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="325.01" y1="73" x2="533" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.01 2.01"/>
      <line x1="534" y1="73" x2="535" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g>
    <path d="M570.73,262a2.39,2.39,0,0,0-1.25-.18,6.31,6.31,0,0,1-.68,0,0.19,0.19,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.66,0.66,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.07s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.31,0.31,0,0,0,.18,0l0.26,0h0.66l1,0h2a0.44,0.44,0,0,1,.35.11q0,0.09.81,6.18l0.79,6.11,0.5-.81q0.53-.79,1.4-2.19l1.93-3.07q3.83-6.11,3.88-6.16l0.07-.07,0.09-.07,0.13,0h3a5.33,5.33,0,0,0,.64,0q0.74,0,.74.24a1.8,1.8,0,0,1-.07.37q-0.07.26-.07,0.28a1.3,1.3,0,0,1-.81.13,9.75,9.75,0,0,0-1.12.07,0.63,0.63,0,0,0-.39.24q-0.07.11-1.58,6.2t-1.53,6.16a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.7,0.7,0,0,0,.37,0,3.5,3.5,0,0,1,.72,0h0.68a0.79,0.79,0,0,1,.13.24,1.45,1.45,0,0,1-.15.66,0.48,0.48,0,0,1-.35.11l-0.9,0-2,0h-2a6.47,6.47,0,0,0-.77,0q-0.37,0-.37-0.22s0-.13,0-0.31a0.69,0.69,0,0,1,.18-0.39,1.82,1.82,0,0,1,.5-0.07q0.59,0,1.31-.07a0.58,0.58,0,0,0,.42-0.26q0-.09.83-3.2t1.56-6.2l0.77-3.09-4.25,6.77q-4.29,6.83-4.4,6.94l-0.09,0a0.71,0.71,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.9-6.79l-0.85-6.73L570.25,268q-1.47,5.83-1.47,6,0.13,0.72,1.58.72h0.22a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.69,0.69,0,0,1-.18.39l-0.24,0H570l-0.74,0-1.4,0-1.36,0-0.81,0a1.18,1.18,0,0,1-.42,0,0.2,0.2,0,0,1-.09-0.2,2.33,2.33,0,0,1,.07-0.31,1.34,1.34,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.94,1.94,0,0,0,1.95-.88q0.09-.13,1.51-5.87T570.73,262Z" fill="#666"/>
    <path d="M586,274.57a1.7,1.7,0,0,1,.14-0.48,7.43,7.43,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63T588,277.73a2.54,2.54,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.69,1.69,0,0,1-.14.48,6.1,6.1,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,586,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,588.5,269.73Z" fill="#666"/>
    <path d="M619.93,270v0.24a0.54,0.54,0,0,1-.33.44H602.86l0.37,0.31a6,6,0,0,1,.64.59q0.31,0.33.72,0.81a4.46,4.46,0,0,1,.72,1.23q0.31,0.74.57,1.56a2.46,2.46,0,0,1,.11.55q0,0.24-.44.24h-0.22a0.18,0.18,0,0,1-.13-0.09,0.86,0.86,0,0,1-.11-0.2,2.12,2.12,0,0,1-.09-0.42,6.69,6.69,0,0,0-1.49-2.85,6.76,6.76,0,0,0-2.67-1.86,0.86,0.86,0,0,1-.39-0.24,0.26,0.26,0,0,1,.09-0.22,1.45,1.45,0,0,1,.31-0.15,6.73,6.73,0,0,0,1.86-1.1,6.5,6.5,0,0,0,1.25-1.34,7.54,7.54,0,0,0,.7-1.29,10.74,10.74,0,0,0,.37-1l0.07-.37,0.07-.18a0.24,0.24,0,0,1,.11-0.09,0.68,0.68,0,0,1,.28,0q0.44,0,.44.24a2.46,2.46,0,0,1-.11.55,9.23,9.23,0,0,1-.55,1.51,6.32,6.32,0,0,1-.7,1.18q-0.37.48-.68,0.81a6.53,6.53,0,0,1-.66.61l-0.44.37H619.6a0.54,0.54,0,0,1,.33.44V270Z" fill="#666"/>
    <path d="M634.93,268.55a2,2,0,0,0-.11-0.48,2.08,2.08,0,0,0-.5-0.77,1.4,1.4,0,0,0-1-.44,2.1,2.1,0,0,0-1.47.68,4.58,4.58,0,0,0-1.1,1.77,17.49,17.49,0,0,0-.9,3.59v0.24a1.17,1.17,0,0,1,0,.26,1.84,1.84,0,0,0,.39,1.36,1.41,1.41,0,0,0,.94.39,2.47,2.47,0,0,0,1.64-.72,3.68,3.68,0,0,0,1-1.12q0-.09.59-2.34T634.93,268.55Zm-7,3.75a6.47,6.47,0,0,1,1.66-4.21,4.9,4.9,0,0,1,3.75-2,2.48,2.48,0,0,1,2,1.07,1.1,1.1,0,0,1,1-.66,0.78,0.78,0,0,1,.5.18,0.54,0.54,0,0,1,.22.44q0,0.28-.81,3.5t-0.83,3.64a1.17,1.17,0,0,0,.15.72,0.64,0.64,0,0,0,.46.2,1,1,0,0,0,.44-0.2,5,5,0,0,0,.9-2.1,0.82,0.82,0,0,1,.22-0.46,0.64,0.64,0,0,1,.22,0h0.09q0.42,0,.42.2a3.48,3.48,0,0,1-.11.59,6.87,6.87,0,0,1-.44,1.18,3.73,3.73,0,0,1-.7,1.1,2.17,2.17,0,0,1-.7.46,2.34,2.34,0,0,1-.53,0,2.24,2.24,0,0,1-1.25-.33,1.68,1.68,0,0,1-.66-0.68l-0.13-.33s0,0-.09,0l-0.09.09A3.84,3.84,0,0,1,631,276a3,3,0,0,1-2.12-.88A3.69,3.69,0,0,1,628,272.29Z" fill="#666"/>
    <path d="M639.16,274.57a1.7,1.7,0,0,1,.14-0.48,7.43,7.43,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.54,2.54,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.09,6.09,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,639.16,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,641.68,269.73Z" fill="#666"/>
    <path d="M659.07,267.3a1.17,1.17,0,0,1,.42-0.85,1.4,1.4,0,0,1,.92-0.42,0.94,0.94,0,0,1,.72.39,2,2,0,0,1,.35,1.25,14.75,14.75,0,0,1-.42,2.52q-0.33,1.23-.59,2a13,13,0,0,1-.77,1.77,4.06,4.06,0,0,1-1.2,1.49,2.64,2.64,0,0,1-1.58.5,4,4,0,0,1-1.71-.35,2.29,2.29,0,0,1-1.07-.94l-0.07.09a2.66,2.66,0,0,1-2.19,1.2,4.5,4.5,0,0,1-1.1-.13,4.12,4.12,0,0,1-1-.42,2.09,2.09,0,0,1-.81-0.85,2.88,2.88,0,0,1-.31-1.38,9.89,9.89,0,0,1,.74-3.2,12,12,0,0,0,.77-2.56v-0.31a0.24,0.24,0,0,0-.09-0.15,0.33,0.33,0,0,0-.24-0.09h-0.09a1.28,1.28,0,0,0-.92.42,3.46,3.46,0,0,0-.66.9,5.79,5.79,0,0,0-.37.92,2.14,2.14,0,0,1-.18.48,0.73,0.73,0,0,1-.35,0H647a0.37,0.37,0,0,1-.13-0.2,2.57,2.57,0,0,1,.18-0.61,9.73,9.73,0,0,1,.5-1.12,3.53,3.53,0,0,1,1-1.14,2.23,2.23,0,0,1,1.42-.5,1.87,1.87,0,0,1,1.45.55,1.82,1.82,0,0,1,.5,1.27,11.71,11.71,0,0,1-.72,2.37,9.67,9.67,0,0,0-.72,3,1.85,1.85,0,0,0,.46,1.42,1.75,1.75,0,0,0,1.16.44,2,2,0,0,0,1.66-1.34l0.11-.2v-0.7a0.45,0.45,0,0,1,0-.18,0.38,0.38,0,0,0,0-.15,0.82,0.82,0,0,1,0-.2l0.07-.28q0-.2.07-0.37a3.35,3.35,0,0,1,.13-0.53,6.15,6.15,0,0,0,.18-0.7q0.07-.35.24-0.94,0.64-2.5.72-2.69a1,1,0,0,1,.94-0.59,0.65,0.65,0,0,1,.57.22,0.91,0.91,0,0,1,.18.42,27.52,27.52,0,0,1-.64,2.8q-0.64,2.52-.7,2.89a4.76,4.76,0,0,0,0,.77v0.15a3,3,0,0,0,.07.64,1.29,1.29,0,0,0,.42.64,1.46,1.46,0,0,0,1,.35q1.56,0,2.48-2.67a13.52,13.52,0,0,0,.44-1.42,7.71,7.71,0,0,0,.26-1.31,2,2,0,0,0-.28-1.14,4.92,4.92,0,0,0-.57-0.7A0.86,0.86,0,0,1,659.07,267.3Z" fill="#666"/>
    <path d="M671.8,270.54v-0.28a0.48,0.48,0,0,1,.31-0.44h6.55v-3.29l0-3.29a0.58,0.58,0,0,1,.42-0.28,0.48,0.48,0,0,1,.44.33v6.53h6.53a0.46,0.46,0,0,1,0,.88h-6.53v6.53a0.49,0.49,0,0,1-.39.31h-0.09a0.42,0.42,0,0,1-.39-0.31V270.7h-6.55a0.48,0.48,0,0,1-.31-0.44v0.28Z" fill="#666"/>
    <path d="M698.2,270.26a18,18,0,0,1,.22-2.87,20.09,20.09,0,0,1,.5-2.34,9.18,9.18,0,0,1,.81-1.93q0.53-.94.83-1.47a5.82,5.82,0,0,1,.92-1.14q0.61-.61.72-0.74a3.94,3.94,0,0,1,.55-0.46h0.37q0.31,0,.31.2a1.77,1.77,0,0,1-.37.46,10,10,0,0,0-.9,1.16,15.15,15.15,0,0,0-1.07,1.88,12.47,12.47,0,0,0-.92,3,22.11,22.11,0,0,0-.37,4.23,21.77,21.77,0,0,0,.37,4.21,14.24,14.24,0,0,0,.9,3,9.92,9.92,0,0,0,1.07,1.88q0.55,0.72.92,1.16a4.94,4.94,0,0,1,.37.46q0,0.2-.33.2h-0.35l-0.61-.53a10.81,10.81,0,0,1-3-4.64A17.91,17.91,0,0,1,698.2,270.26Z" fill="#666"/>
    <path d="M709.33,263.07l-0.28.11a6.28,6.28,0,0,1-.88.22,10.1,10.1,0,0,1-1.27.15h-0.42v-1h0.42a7.12,7.12,0,0,0,1.91-.33,5.18,5.18,0,0,0,1.23-.53,5.62,5.62,0,0,0,.61-0.48,0.33,0.33,0,0,1,.26-0.07,0.61,0.61,0,0,1,.37.13v6.55l0,6.57a0.87,0.87,0,0,0,.26.2,2.6,2.6,0,0,0,.53.09q0.42,0,1.36,0H714v1h-0.24q-0.46-.07-3.48-0.07t-3.44.07h-0.26v-1H708l0.55,0a2.14,2.14,0,0,0,.35-0.07l0.18,0a0.44,0.44,0,0,0,.13-0.11,0.17,0.17,0,0,1,.13-0.09V263.07Z" fill="#666"/>
    <path d="M718.66,270.54v-0.28a0.48,0.48,0,0,1,.31-0.44h12.73a0.46,0.46,0,0,1,0,.88H719a0.48,0.48,0,0,1-.31-0.44v0.28Z" fill="#666"/>
    <path d="M742.78,268.55a2,2,0,0,0-.11-0.48,2.08,2.08,0,0,0-.5-0.77,1.4,1.4,0,0,0-1-.44,2.1,2.1,0,0,0-1.47.68,4.59,4.59,0,0,0-1.1,1.77,17.49,17.49,0,0,0-.9,3.59v0.24a1.17,1.17,0,0,1,0,.26,1.84,1.84,0,0,0,.39,1.36,1.41,1.41,0,0,0,.94.39,2.47,2.47,0,0,0,1.64-.72,3.68,3.68,0,0,0,1-1.12q0-.09.59-2.34T742.78,268.55Zm-7,3.75a6.47,6.47,0,0,1,1.66-4.21,4.9,4.9,0,0,1,3.75-2,2.48,2.48,0,0,1,2,1.07,1.1,1.1,0,0,1,1-.66,0.78,0.78,0,0,1,.5.18,0.54,0.54,0,0,1,.22.44q0,0.28-.81,3.5t-0.83,3.64a1.17,1.17,0,0,0,.15.72,0.64,0.64,0,0,0,.46.2,1,1,0,0,0,.44-0.2,5,5,0,0,0,.9-2.1,0.82,0.82,0,0,1,.22-0.46,0.64,0.64,0,0,1,.22,0h0.09q0.42,0,.42.2a3.48,3.48,0,0,1-.11.59,6.87,6.87,0,0,1-.44,1.18,3.73,3.73,0,0,1-.7,1.1,2.17,2.17,0,0,1-.7.46,2.34,2.34,0,0,1-.53,0,2.24,2.24,0,0,1-1.25-.33,1.68,1.68,0,0,1-.66-0.68l-0.13-.33s0,0-.09,0l-0.09.09a3.84,3.84,0,0,1-2.63,1.23,3,3,0,0,1-2.12-.88A3.69,3.69,0,0,1,735.81,272.29Z" fill="#666"/>
    <path d="M747,274.57a1.69,1.69,0,0,1,.14-0.48,7.45,7.45,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.53,2.53,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.11,6.11,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,747,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,749.53,269.73Z" fill="#666"/>
    <path d="M755.53,259.33l0.09,0h0.48l0.61,0.53a10.81,10.81,0,0,1,3,4.64,17.91,17.91,0,0,1,.94,5.78,18.29,18.29,0,0,1-.22,2.87,18.84,18.84,0,0,1-.5,2.34,9.87,9.87,0,0,1-.81,1.93q-0.53,1-.83,1.47a6.67,6.67,0,0,1-.9,1.12l-0.7.72q-0.11.11-.5,0.42l-0.09.09h-0.5a0.13,0.13,0,0,1-.11-0.07,0.52,0.52,0,0,1-.07-0.2l0.24-.28q3.4-3.53,3.4-10.41t-3.4-10.41l-0.24-.28A0.26,0.26,0,0,1,755.53,259.33Z" fill="#666"/>
    <path d="M769.06,262a2.39,2.39,0,0,0-1.25-.18,6.3,6.3,0,0,1-.68,0,0.19,0.19,0,0,1-.15-0.22s0-.09,0-0.24l0-.15a0.66,0.66,0,0,0,0-.11,0.38,0.38,0,0,1,0-.11q0-.09,0-0.07s0,0,.09,0a0.11,0.11,0,0,1,.11,0,0.31,0.31,0,0,0,.18,0l0.26,0h0.66l1,0h2a0.44,0.44,0,0,1,.35.11q0,0.09.81,6.18l0.79,6.11,0.5-.81q0.53-.79,1.4-2.19l1.93-3.07q3.83-6.11,3.88-6.16l0.07-.07,0.09-.07,0.13,0h3a5.33,5.33,0,0,0,.64,0q0.74,0,.74.24a1.8,1.8,0,0,1-.07.37q-0.07.26-.07,0.28a1.3,1.3,0,0,1-.81.13,9.74,9.74,0,0,0-1.12.07,0.63,0.63,0,0,0-.39.24q-0.07.11-1.58,6.2t-1.53,6.16a0.17,0.17,0,0,0,0,.11l0.15,0.09a0.71,0.71,0,0,0,.37,0,3.5,3.5,0,0,1,.72,0h0.68a0.79,0.79,0,0,1,.13.24,1.45,1.45,0,0,1-.15.66,0.48,0.48,0,0,1-.35.11l-0.9,0-2,0h-2a6.47,6.47,0,0,0-.77,0q-0.37,0-.37-0.22s0-.13,0-0.31a0.69,0.69,0,0,1,.18-0.39,1.82,1.82,0,0,1,.5-0.07q0.59,0,1.31-.07a0.58,0.58,0,0,0,.42-0.26q0-.09.83-3.2t1.56-6.2l0.77-3.09-4.25,6.77q-4.29,6.83-4.4,6.94l-0.09,0a0.71,0.71,0,0,1-.35.07,0.39,0.39,0,0,1-.39-0.15q0-.09-0.9-6.79l-0.85-6.73L768.58,268q-1.47,5.83-1.47,6,0.13,0.72,1.58.72h0.22a0.42,0.42,0,0,1,.15.2,1,1,0,0,1-.07.39,0.69,0.69,0,0,1-.18.39l-0.24,0h-0.26l-0.74,0-1.4,0-1.36,0-0.81,0a1.18,1.18,0,0,1-.42,0,0.2,0.2,0,0,1-.09-0.2,2.33,2.33,0,0,1,.07-0.31,1.34,1.34,0,0,1,.11-0.33,0.51,0.51,0,0,1,.48-0.13,1.94,1.94,0,0,0,1.95-.88q0.09-.13,1.51-5.87T769.06,262Z" fill="#666"/>
    <path d="M784.31,274.57a1.7,1.7,0,0,1,.14-0.48,7.44,7.44,0,0,1,.37-0.79,2.56,2.56,0,0,1,.68-0.79,1.4,1.4,0,0,1,.93-0.34,1.46,1.46,0,0,1,1,.36,1.26,1.26,0,0,1,.42,1,3,3,0,0,1-.22.87q-0.22.6-.62,1.63t-0.65,1.75a2.53,2.53,0,0,0-.08.5q0,0.39.26,0.39a1,1,0,0,0,.29,0,1.06,1.06,0,0,0,.36-0.22,2.1,2.1,0,0,0,.42-0.54,4.5,4.5,0,0,0,.39-0.91,0.64,0.64,0,0,1,.08-0.22,0.57,0.57,0,0,1,.26,0q0.31,0,.31.15a1.7,1.7,0,0,1-.14.48,6.11,6.11,0,0,1-.39.79,2.59,2.59,0,0,1-.7.77,1.56,1.56,0,0,1-1,.34,1.46,1.46,0,0,1-.91-0.33,1.22,1.22,0,0,1-.43-1,1.56,1.56,0,0,1,.08-0.5q0.08-.23.67-1.77t0.68-1.87a2.57,2.57,0,0,0,.11-0.6q0-.37-0.26-0.37h0a1.08,1.08,0,0,0-.85.51,3.61,3.61,0,0,0-.59,1.3l0,0a0.12,0.12,0,0,0,0,0,0,0,0,0,1,0,0l0,0h-0.4A0.26,0.26,0,0,1,784.31,274.57Zm2.52-4.85a0.87,0.87,0,0,1,.29-0.65,1,1,0,0,1,.68-0.29,0.63,0.63,0,0,1,.46.19,0.69,0.69,0,0,1,.2.46,0.88,0.88,0,0,1-.31.65,1,1,0,0,1-.68.31,0.7,0.7,0,0,1-.43-0.15A0.64,0.64,0,0,1,786.83,269.73Z" fill="#666"/>
  </g>
</svg>
</figure>
<script>
"use strict";
(function() {

  function appendArrowhead(selection) {
    selection.append("marker")
        .attr("id", "arrowhead")
        .attr("viewBox", "0 -5 10 10")
        .attr("refX", 5)
        .attr("refY", 0)
        .attr("markerWidth", 10)
        .attr("markerHeight", 10)
        .attr("orient", "auto")
      .append("path")
        .attr("d", "M0,-5L5,0L0,5")
        .style("fill", "none")
        .style("stroke", "grey");
  }

  var vectorScale = d3.scaleLinear()
      .domain([0, 1])
      .range([-14, 14]);

  var memoryData = [
    {x: 0.9, y: 0.9},
    {x: 0.8, y: 0.8},
    {x: 0.1, y: 0.9},
    {x: 0.4, y: 0.2},
    {x: 0.2, y: 0.2},
    {x: 0.4, y: 0.3},
    {x: 0.1, y: 0.5}
  ];

  var writeData = {x: 0.9, y: 0};

  //
  // Read
  //

  var readHtml = d3.selectAll("#rnn-read");
  var svg = readHtml.select("svg");
  var svgBBox = svg.node().getBoundingClientRect();
  var result = svg.select("#read-result").style("opacity", 0);
  var resultBBox = result.node().getBoundingClientRect();
  var memory = svg.selectAll("#memory use");
  var attention = svg.selectAll("#attention use");
  var path = svg.selectAll("#paths path");

  appendArrowhead(svg);
  var resultArrow = svg.append("line")
      .attr("class", "result-line")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  memory.data(memoryData)
    .each(function(d) {
      this.style.opacity = 0;
      var bBox = this.getBoundingClientRect();
      d.top = bBox.top - svgBBox.top;
      d.left = bBox.left - svgBBox.left;
      d.width = bBox.width;
    });

  var memoryVectors = svg.selectAll(".vector")
      .data(memoryData)
    .enter().append("line")
      .attr("class", "vector")
      .attr("transform", function(d) {
        return `translate(${d.left + d.width / 2 - vectorScale(d.x) / 2}, ${d.top + d.width / 2 - vectorScale(d.y) / 2})`
      })
      .attr("x2", function(d) { return  vectorScale(d.x); })
      .attr("y2", function(d) { return  vectorScale(d.y); })
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  function updateReadAttention(data) {
    attention.data(data)
        .style("opacity", function(d) { return  d + 0.05; });

    path.data(data)
        .style("stroke-opacity", function(d) { return  d + 0.1; });

    var resultX = d3.sum(memoryData, function(d, i) { return d.x * data[i]; }) / d3.sum(data);
    var resultY = d3.sum(memoryData, function(d, i) { return d.y * data[i]; }) / d3.sum(data);

    resultArrow
        .attr("transform",`translate(${resultBBox.left + resultBBox.width / 2 - svgBBox.left - vectorScale(resultX) / 2}, ${resultBBox.top + resultBBox.width / 2 - svgBBox.top - vectorScale(resultY) / 2})`)
        .attr("x2", function(d) { return  vectorScale(resultX); })
        .attr("y2", function(d) { return  vectorScale(resultY); });
  }

  var length = memory.size();
  var attentionData = d3.range(length).map(function() { return Math.random(); });
  updateReadAttention(attentionData);

  readHtml.on("mousemove", function() {
    var data = [];
    attention.each(function() {
      var bbox = this.getBoundingClientRect()
      var distance = Math.abs(bbox.left - d3.event.clientX + bbox.width / 2);
      data.push(Math.exp(-distance / 25));
    });
    data = data.map(function(d) { return  d / d3.sum(data); });
    updateReadAttention(data);
  });

  var initReadData = d3.range(attention.size()).map(function(d) { return  Math.exp(-d); });
  initReadData = initReadData.map(function(d) { return  d / d3.sum(initReadData); });
  updateReadAttention(initReadData);

  //
  // Write
  //

  var writeHtml = d3.selectAll("#rnn-write");
  var writeSvg = writeHtml.select("svg");
  var writeMemory = writeSvg.selectAll("#memory use");
  var writeNewMemory = writeSvg.selectAll("#new-memory use");
  var writeAttention = writeSvg.selectAll("#attention use");
  var writePath = writeSvg.selectAll("#paths path");
  var writeSvgBBox = writeSvg.node().getBoundingClientRect();
  var writeResult = writeSvg.select("#write-result").style("opacity", 0);
  var writeResultBBox = writeResult.node().getBoundingClientRect();
  var newMemoryData = memoryData.map(function(){ return {}; });

  appendArrowhead(writeSvg);
  var writeArrow = writeSvg.append("line")
      .attr("class", "write-line")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey")
      .attr("transform", "translate(" + (writeResultBBox.left + writeResultBBox.width / 2 - writeSvgBBox.left - vectorScale(writeData.x) / 2) + ", " + (writeResultBBox.top + writeResultBBox.width / 2 - writeSvgBBox.top - vectorScale(writeData.y) / 2) + ")")
      .attr("x2", vectorScale(writeData.x))
      .attr("y2", vectorScale(writeData.y));

  writeMemory.data(memoryData)
    .each(function(d) {
      this.style.opacity = 0;
      var bBox = this.getBoundingClientRect();
      d.top = bBox.top - writeSvgBBox.top;
      d.left = bBox.left - writeSvgBBox.left;
      d.width = bBox.width;
    });

  var writeMemoryVectors = writeSvg.selectAll(".vector")
      .data(memoryData)
    .enter().append("line")
      .attr("class", "vector")
      .attr("transform", function(d) {
        return "translate(" + (d.left + d.width / 2 - vectorScale(d.x) / 2) + ", " + (d.top + d.width / 2 - vectorScale(d.y) / 2) + ")";
      })
      .attr("x2", function(d) { return  vectorScale(d.x); })
      .attr("y2", function(d) { return  vectorScale(d.y); })
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  writeNewMemory.data(newMemoryData)
    .each(function(d) {
      this.style.opacity = 0;
      var bBox = this.getBoundingClientRect();
      d.top = bBox.top - writeSvgBBox.top;
      d.left = bBox.left - writeSvgBBox.left;
      d.width = bBox.width;
    });

  var writeNewMemoryVectors = writeSvg.selectAll(".new-vector")
      .data(newMemoryData)
    .enter().append("line")
      .attr("class", "new-vector")
      .attr("marker-end", "url(#arrowhead)")
      .style("stroke", "grey");

  function updateWriteAttention(data) {
    newMemoryData.forEach(function(d, i) {
      d.x = (memoryData[i].x + writeData.x * data[i]) / (1 + data[i]);
      d.y = (memoryData[i].y + writeData.y * data[i]) / (1 + data[i]);
    });
    writeNewMemoryVectors
        .attr("transform", function(d) {
          return "translate(" + (d.left + d.width / 2 - vectorScale(d.x) / 2) + ", " + (d.top + d.width / 2 - vectorScale(d.y) / 2) + ")";
        })
        .attr("x2", function(d) { return  vectorScale(d.x); })
        .attr("y2", function(d) { return  vectorScale(d.y); });

    writeAttention.data(data)
        .style("opacity", function(d) { return  d + 0.05; });

    writePath.data(data)
        .style("stroke-opacity", function(d) { return  d + 0.1; });
  }

  writeHtml.on("mousemove", function() {
    var data = [];
    writeAttention.each(function() {
      var bbox = this.getBoundingClientRect()
      var distance = Math.abs(bbox.left - d3.event.clientX + bbox.width / 2);
      data.push(Math.exp(-distance / 25));
    });
    data = data.map(function(d) { return  d / d3.sum(data); });
    updateWriteAttention(data);
  });

  var initWriteData = d3.range(writeAttention.size()).map(function(d) { return  Math.exp(-d); });
  initWriteData = initWriteData.map(function(d) { return  d / d3.sum(initWriteData); });
  updateWriteAttention(initWriteData);

})();
</script>
</p>
<p>But how do NTMs decide which positions in memory to focus their attention on? They actually use a combination of two different methods: content-based attention and location-based attention. Content-based attention allows NTMs to search through their memory and focus on places that match what they’re looking for, while location-based attention allows relative movement in memory, enabling the NTM to loop.</p>
<p><figure class="w-page" id="rnn-write-detail">
<svg id="edges" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="744" viewBox="0 0 984 744">
  <defs>
    <symbol id="array-5" data-name="array-5" viewBox="0 0 181.5 37.5">
      <rect x="0.75" y="0.75" width="180" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
      <line x1="36.5" y1="36.75" x2="36.5" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="72.5" y1="36.75" x2="72.5" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="108.5" y1="36.75" x2="108.5" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="144.5" y1="36.75" x2="144.5" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
    </symbol>
    <symbol id="array-1" data-name="array-1" viewBox="0 0 37.5 37.5">
      <rect x="0.75" y="0.75" width="36" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
    </symbol>
    <symbol id="array-3" data-name="array-3" viewBox="0 0 109 37.5">
      <rect x="0.75" y="0.75" width="107.5" height="36" rx="6" ry="6" fill="#fff" stroke="#8c8c8c" stroke-miterlimit="10" stroke-width="1.5"/>
      <line x1="36.25" y1="36.75" x2="36.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
      <line x1="72.25" y1="36.75" x2="72.25" y2="0.75" fill="none" stroke="#8c8c8c" stroke-miterlimit="10"/>
    </symbol>
    <symbol id="array-negative-value" data-name="array-negative-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"/>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#ff2bb6" opacity="0.8"/>
    </symbol>
    <symbol id="array-positive-value" data-name="array-positive-value" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#0080f7" opacity="0"/>
      <rect x="4.42" y="4.42" width="27.17" height="27.17" rx="6" ry="6" fill="#3a5edd" opacity="0.8"/>
    </symbol>
    <symbol id="array-vector" data-name="array-vector" viewBox="0 0 36 36">
      <rect width="36" height="36" fill="#d8c2f2" opacity="0"/>
      <g opacity="0.5">
        <g>
          <line x1="18" y1="24" x2="18" y2="13.08" fill="none" stroke="#000" stroke-miterlimit="10"/>
          <polygon points="22.09 16.4 21.36 17.08 18 13.47 14.64 17.08 13.91 16.4 18 12 22.09 16.4"/>
        </g>
      </g>
    </symbol>
    <symbol id="pointer" data-name="pointer" viewBox="0 0 26.87 26.87">
      <circle cx="13.43" cy="13.43" r="12.93" fill="none" stroke="#ffdc8c" stroke-miterlimit="10"/>
      <circle cx="13.43" cy="13.43" r="10.38" fill="#ffb200"/>
      <polygon points="11.32 19.26 11.32 17.43 10.72 17.43 10.71 16.14 10.1 16.21 10.1 15 9.54 14.99 9.46 13.78 8.88 13.78 8.89 13.16 8.28 13.16 8.28 11.34 10.11 11.34 10.11 11.94 10.71 11.94 10.71 6.46 11.33 6.45 11.33 5.86 12.54 5.86 12.54 6.45 13.16 6.47 13.16 8.89 14.37 8.89 14.39 9.49 16.21 9.51 16.21 10.12 17.43 10.12 17.43 10.79 18.04 10.73 18.05 11.39 18.65 11.33 18.65 15.61 18.04 15.52 17.98 17.43 17.43 17.43 17.43 19.26 11.32 19.26" fill="#fff" opacity="0.2"/>
      <g>
        <path d="M10.11,11.94c0-.09,0-0.19,0-0.28s0-.21,0-0.32H8.28v1.82H8.89V11.95h1.23v0.63h0.6v0.6h0.61V13.09q0-2.4,0-4.8,0-.92,0-1.85h1.21V5.85H11.33v0.6H10.71v5.47h-0.6Zm4.28-2.44a0.45,0.45,0,0,1,0-.07c0-.15,0-0.3,0-0.45s0,0,0-.08H13.16V6.47H12.55v5.47h0.61V9.51h1.24s0,0.06,0,.09q0,1.12,0,2.25s0,0.07,0,.1H15V10.12h1.23v2.43h0.6V10.71l0.57,0s0,0,0,.05,0,0.29,0,.44,0,0.07,0,.11H18a0,0,0,0,1,.06.06c0,0.24,0,.48,0,0.72q0,1.71,0,3.41s0,0,0,.08h-0.6s0,0,0,0q0,0.86,0,1.72s0,0,0,.06H16.81v1.21H11.94V17.42H11.33V16.21h-0.6a11.4,11.4,0,0,0,0,1.22h0.6v1.83c2,0,4.07,0,6.11,0,0-.1,0-0.19,0-0.28,0-.46,0-0.93,0-1.39a1.53,1.53,0,0,0,0-.16H18c0.05,0,.07,0,0.07-0.07,0-.45,0-0.89,0-1.34,0-.13,0-0.26,0-0.4l0.3,0h0.3V11.33H18v-0.6H17.43V10.11H16.21V9.51H14.39ZM10.1,15v1.21h0.52a0.07,0.07,0,0,0,.08-0.08c0-.32,0-0.65,0-1,0-.06,0-0.11,0-0.17H10.11V13.77H9.49V13.16H8.91a2.7,2.7,0,0,0,0,.62H9.47s0,0,0,.07,0,0.27,0,.41,0,0.45,0,.68a0,0,0,0,0,.05.06H10.1Z" fill="#fff"/>
        <path d="M17.43,17.43s0,0,0-.06q0-.86,0-1.72s0,0,0,0H18s0-.06,0-0.08q0-1.71,0-3.41c0-.24,0-0.48,0-0.72A0,0,0,0,0,18,11.33H17.44s0-.07,0-0.11,0-.29,0-0.44,0-.05,0-0.05l-0.57,0v1.84h-0.6V10.12H15v1.82H14.38s0-.07,0-0.1q0-1.12,0-2.25s0-.06,0-0.09h1.81v0.6h1.22v0.62H18v0.6h0.61v4.28h-0.3l-0.3,0c0,0.14,0,.27,0,0.4,0,0.45,0,.89,0,1.34,0,0.05,0,.07-0.07.07H17.43Z" fill="#fff"/>
        <path d="M17.43,17.43a1.53,1.53,0,0,1,0,.16c0,0.46,0,.93,0,1.39,0,0.09,0,.17,0,0.28-2,0-4.06,0-6.11,0V17.43h-0.6a11.4,11.4,0,0,1,0-1.22h0.6v1.21h0.61v1.22h4.88V17.43h0.62Z" fill="#fff"/>
        <path d="M11.33,6.45q0,0.92,0,1.85,0,2.4,0,4.8v0.07H10.72v-0.6h-0.6V11.93h0.6V6.46h0.61Z" fill="#fff"/>
        <path d="M14.39,9.49H13.16v2.43H12.55V6.47h0.61V8.89h1.21s0,0.06,0,.08,0,0.3,0,.45a0.44,0.44,0,0,0,0,.07h0Z" fill="#fff"/>
        <path d="M10.1,15H9.54a0,0,0,0,1-.05-0.06c0-.23,0-0.45,0-0.68s0-.27,0-0.41,0,0,0-.07H8.88a2.7,2.7,0,0,1,0-.62H9.49v0.61h0.62V15h0.61c0,0.06,0,.12,0,0.17,0,0.32,0,.65,0,1a0.07,0.07,0,0,1-.08.08H10.1V15Z" fill="#fff"/>
        <path d="M10.11,11.93H8.89v1.21H8.28V11.34h1.83c0,0.11,0,.21,0,0.32s0,0.19,0,.28h0Z" fill="#fff"/>
        <path d="M11.33,6.45V5.85h1.21v0.6H11.33Z" fill="#fff"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g>
    <line x1="813.09" x2="813.59" y2="741" fill="#fff"/>
    <g>
      <line x1="813.09" x2="813.09" y2="1" fill="none" stroke="#aaa" stroke-miterlimit="10"/>
      <line x1="813.09" y1="3" x2="813.59" y2="739" fill="none" stroke="#aaa" stroke-miterlimit="10" stroke-dasharray="2 2"/>
      <line x1="813.59" y1="740" x2="813.59" y2="741" fill="none" stroke="#aaa" stroke-miterlimit="10"/>
    </g>
  </g>
  <g>
    <g opacity="0">
      <g>
        <line x1="683.34" y1="201" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.17">
      <g>
        <line x1="683.34" y1="206" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.33">
      <g>
        <line x1="683.34" y1="211" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.5">
      <g>
        <line x1="683.34" y1="216" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.67">
      <g>
        <line x1="683.34" y1="221" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.83">
      <g>
        <line x1="683.34" y1="226" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
      </g>
    </g>
    <g>
      <line x1="683.34" y1="231" x2="683.34" y2="243.92" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M683.34,249.35a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,683.34,249.35Z" fill="#666"/>
    </g>
  </g>
  <g>
    <g>
      <line x1="425" y1="48" x2="425" y2="72.75" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,78.18a27.2,27.2,0,0,0-4.28-7.69L425,72l4.28-1.55A27.18,27.18,0,0,0,425,78.18Z" fill="#666"/>
    </g>
    <g>
      <line x1="835.09" y1="96" x2="478.43" y2="96" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M473,96a27.2,27.2,0,0,0,7.69-4.28L479.14,96l1.55,4.28A27.18,27.18,0,0,0,473,96Z" fill="#666"/>
    </g>
    <g>
      <line x1="835.09" y1="366" x2="478.43" y2="366" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M473,366a27.2,27.2,0,0,0,7.69-4.28L479.14,366l1.55,4.28A27.18,27.18,0,0,0,473,366Z" fill="#666"/>
    </g>
    <g>
      <line x1="835.09" y1="492" x2="478.43" y2="492" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M473,492a27.2,27.2,0,0,0,7.69-4.28L479.14,492l1.55,4.28A27.18,27.18,0,0,0,473,492Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="107.82" x2="425" y2="132.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,138a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,138Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="179.82" x2="425" y2="204.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,210a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,210Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="240" x2="425" y2="264.75" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,270.18a27.2,27.2,0,0,0-4.28-7.69L425,264l4.28-1.55A27.18,27.18,0,0,0,425,270.18Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="311.82" x2="425" y2="336.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,342a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,342Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="371.82" x2="425" y2="396.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,402a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,402Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="444" x2="425" y2="468.75" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,474.18a27.2,27.2,0,0,0-4.28-7.69L425,468l4.28-1.55A27.18,27.18,0,0,0,425,474.18Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="503.82" x2="425" y2="528.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,534a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,534Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="576.82" x2="425" y2="601.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,607a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,607Z" fill="#666"/>
    </g>
    <g>
      <line x1="425" y1="635.82" x2="425" y2="660.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M425,666a27.2,27.2,0,0,0-4.28-7.69l4.28,1.55,4.28-1.55A27.18,27.18,0,0,0,425,666Z" fill="#666"/>
    </g>
    <g>
      <path d="M683.34,312v32a10,10,0,0,1-10,10H478.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M473,354a27.2,27.2,0,0,0,7.69-4.28L479.14,354l1.55,4.28A27.18,27.18,0,0,0,473,354Z" fill="#666"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384" y="614" width="84" height="24" rx="12" ry="12"/>
      <rect x="384" y="614" width="84" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g>
      <rect x="383" y="612" width="84" height="24" rx="12" ry="12" fill="#fff"/>
      <rect x="383" y="612" width="84" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384" y="482" width="84" height="24" rx="12" ry="12"/>
      <rect x="384" y="482" width="84" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g>
      <rect x="383" y="480" width="84" height="24" rx="12" ry="12" fill="#fff"/>
      <rect x="383" y="480" width="84" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384" y="350" width="84" height="24" rx="12" ry="12"/>
      <rect x="384" y="350" width="84" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g>
      <rect x="383" y="348" width="84" height="24" rx="12" ry="12" fill="#fff"/>
      <rect x="383" y="348" width="84" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384" y="218" width="84" height="24" rx="12" ry="12"/>
      <rect x="384" y="218" width="84" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g>
      <rect x="383" y="216" width="84" height="24" rx="12" ry="12" fill="#fff"/>
      <rect x="383" y="216" width="84" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384" y="86" width="84" height="24" rx="12" ry="12"/>
      <rect x="384" y="86" width="84" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g>
      <rect x="383" y="84" width="84" height="24" rx="12" ry="12" fill="#fff"/>
      <rect x="383" y="84" width="84" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <use id="array-5-3" data-name="array-5" width="181.5" height="37.5" transform="translate(334 274.75)" xlink:href="#array-5"/>
  <use width="181.5" height="37.5" transform="translate(592.34 275.75)" xlink:href="#array-5"/>
  <use width="181.5" height="37.5" transform="translate(334 406.75)" xlink:href="#array-5"/>
  <use id="array-5-10" data-name="array-5" width="181.5" height="37.5" transform="translate(334 539.75)" xlink:href="#array-5"/>
  <use width="181.5" height="37.5" transform="translate(334 670.75)" xlink:href="#array-5"/>
  <use width="37.5" height="37.5" transform="translate(834.84 341.75)" xlink:href="#array-1"/>
  <use id="array-3-3" data-name="array-3" width="109" height="37.5" transform="translate(834.84 472.75)" xlink:href="#array-3"/>
  <use width="181.5" height="37.5" transform="translate(334 142.75)" xlink:href="#array-5"/>
  <g id="dot">
    <use width="36" height="36" transform="translate(335 143.25)" xlink:href="#array-negative-value"/>
    <use width="36" height="36" transform="translate(371 143)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(407 143)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(443 143)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(479 143)" xlink:href="#array-positive-value"/>
  </g>
  <use id="array-5-17" data-name="array-5" width="181.5" height="37.5" transform="translate(334 11.75)" xlink:href="#array-5"/>
  <g id="softmax">
    <use width="36" height="36" transform="translate(335 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(371 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(407 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(443 276)" xlink:href="#array-positive-value"/>
    <use id="array-positive-value-19" data-name="array-positive-value" width="36" height="36" transform="translate(479 276)" xlink:href="#array-positive-value"/>
  </g>
  <g id="shift">
    <use width="36" height="36" transform="translate(835.59 473)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(871.59 473)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(907.59 473)" xlink:href="#array-positive-value"/>
  </g>
  <use id="interpolate-amount" width="36" height="36" transform="translate(835.59 342)" xlink:href="#array-positive-value"/>
  <g id="previous">
    <use width="36" height="36" transform="translate(593.34 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(629.34 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(665.34 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(701.34 276)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(737.34 276)" xlink:href="#array-positive-value"/>
  </g>
  <g id="interpolate">
    <use width="36" height="36" transform="translate(335 407)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(371 407)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(407 407)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(443 407)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(479 407)" xlink:href="#array-positive-value"/>
  </g>
  <g id="convolve">
    <use width="36" height="36" transform="translate(334.5 541)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(371 541)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(407 541)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(443 541)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(479 541)" xlink:href="#array-positive-value"/>
  </g>
  <g id="new-attention">
    <use width="36" height="36" transform="translate(335 671)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(371 671)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(407 671)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(443 671)" xlink:href="#array-positive-value"/>
    <use width="36" height="36" transform="translate(479 671)" xlink:href="#array-positive-value"/>
  </g>
  <use width="37.5" height="37.5" transform="translate(834.84 76.75)" xlink:href="#array-1"/>
  <g opacity="0.6">
    <text transform="translate(166 68.88)" font-size="13" font-family="Open Sans">First, the controller gives a <tspan x="0" y="20">query vector and each </tspan><tspan x="0" y="40">memory entry is scored for </tspan><tspan x="0" y="60">similarity with the query.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(167.5 206.88)" font-size="13" font-family="Open Sans">The scores are then <tspan x="0" y="20">converted into a </tspan><tspan x="0" y="40">distribution using softmax.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(167.5 345.88)" font-size="13" font-family="Open Sans">Next, we interpolate <tspan x="0" y="20">the attention from the </tspan><tspan x="0" y="40">previous time step. </tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(167.5 458.88)" font-size="13" font-family="Open Sans">We convolve the <tspan x="0" y="20">attention with a shift </tspan><tspan x="0" y="40">filter — this allows the </tspan><tspan x="0" y="60">controller to move its </tspan><tspan x="0" y="80">focus.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(167.5 591.88)" font-size="13" font-family="Open Sans">Finally, we sharpen the <tspan x="0" y="20">attention distribution. </tspan><tspan x="0" y="40">This final attention </tspan><tspan x="0" y="60">distribution is fed to the </tspan><tspan x="0" y="80">read or write operation.</tspan></text>
  </g>
  <g>
    <path d="M396.26,355.49a0.7,0.7,0,0,1,.19-0.52,0.72,0.72,0,0,1,.53-0.18,0.71,0.71,0,0,1,.52.18,0.7,0.7,0,0,1,.19.52,0.68,0.68,0,0,1-.19.51,0.7,0.7,0,0,1-.52.19,0.71,0.71,0,0,1-.53-0.19A0.68,0.68,0,0,1,396.26,355.49ZM397.6,363h-1.26v-5.94h1.26V363Z" fill="#666"/>
    <path d="M404.63,363h-1.27v-3.65a1.6,1.6,0,0,0-.28-1,1.07,1.07,0,0,0-.88-0.34,1.4,1.4,0,0,0-1.17.47,2.61,2.61,0,0,0-.37,1.58v3H399.4v-5.94h1l0.18,0.78h0.06a1.75,1.75,0,0,1,.76-0.66,2.55,2.55,0,0,1,1.1-.23,1.91,1.91,0,0,1,2.14,2.18V363Z" fill="#666"/>
    <path d="M408.6,362.09a3.07,3.07,0,0,0,.92-0.14v1a2.49,2.49,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06,1.63,1.63,0,0,1-1.79-1.89V358h-0.81v-0.56l0.87-.46,0.43-1.26h0.78v1.32h1.69v1h-1.69v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,408.6,362.09Z" fill="#666"/>
    <path d="M413.3,363.11a2.87,2.87,0,0,1-2.17-.81,3.07,3.07,0,0,1-.78-2.23,3.37,3.37,0,0,1,.73-2.29,2.5,2.5,0,0,1,2-.83,2.45,2.45,0,0,1,1.86.71,2.73,2.73,0,0,1,.68,2v0.68h-4a2,2,0,0,0,.47,1.33,1.62,1.62,0,0,0,1.24.46,4.57,4.57,0,0,0,1-.1,5.06,5.06,0,0,0,1-.33v1a3.92,3.92,0,0,1-.93.31A5.76,5.76,0,0,1,413.3,363.11Zm-0.23-5.2a1.27,1.27,0,0,0-1,.38,1.81,1.81,0,0,0-.43,1.11h2.7a1.64,1.64,0,0,0-.35-1.11A1.21,1.21,0,0,0,413.07,357.91Z" fill="#666"/>
    <path d="M420.06,357a3.08,3.08,0,0,1,.63.05l-0.12,1.18a2.39,2.39,0,0,0-.56-0.06,1.61,1.61,0,0,0-1.23.49,1.78,1.78,0,0,0-.47,1.28V363H417v-5.94h1l0.17,1h0.06a2.35,2.35,0,0,1,.77-0.84A1.84,1.84,0,0,1,420.06,357Z" fill="#666"/>
    <path d="M424.8,363.11a2.08,2.08,0,0,1-1.75-.81H423q0.08,0.75.08,0.91v2.43h-1.26v-8.58h1q0,0.17.18,0.79h0.06a2,2,0,0,1,1.77-.9,2.06,2.06,0,0,1,1.73.81,4.42,4.42,0,0,1,0,4.53A2.08,2.08,0,0,1,424.8,363.11ZM424.5,358a1.31,1.31,0,0,0-1.1.44,2.29,2.29,0,0,0-.35,1.41V360a2.78,2.78,0,0,0,.34,1.57,1.28,1.28,0,0,0,1.12.49,1.14,1.14,0,0,0,1-.54,2.77,2.77,0,0,0,.35-1.53,2.68,2.68,0,0,0-.35-1.51A1.17,1.17,0,0,0,424.5,358Z" fill="#666"/>
    <path d="M433.91,360a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.84,2.84,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,433.91,360Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,429.59,360Z" fill="#666"/>
    <path d="M436.62,363h-1.26v-8.36h1.26V363Z" fill="#666"/>
    <path d="M442.14,363l-0.25-.83h0a2.42,2.42,0,0,1-.86.74,2.73,2.73,0,0,1-1.12.2,1.89,1.89,0,0,1-1.37-.47,1.77,1.77,0,0,1-.49-1.34,1.57,1.57,0,0,1,.68-1.39,3.94,3.94,0,0,1,2.08-.51l1,0v-0.32a1.2,1.2,0,0,0-.27-0.85,1.08,1.08,0,0,0-.82-0.28,2.84,2.84,0,0,0-.88.13,6.6,6.6,0,0,0-.81.32l-0.41-.9a4.41,4.41,0,0,1,1.06-.38,4.86,4.86,0,0,1,1.08-.13,2.57,2.57,0,0,1,1.71.49A1.94,1.94,0,0,1,443,359v4h-0.9Zm-1.88-.86a1.56,1.56,0,0,0,1.1-.38,1.39,1.39,0,0,0,.42-1.08v-0.52l-0.76,0a2.62,2.62,0,0,0-1.3.3,0.91,0.91,0,0,0-.41.81,0.79,0.79,0,0,0,.24.61A1,1,0,0,0,440.26,362.14Z" fill="#666"/>
    <path d="M447,362.09a3.07,3.07,0,0,0,.92-0.14v1a2.49,2.49,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06,1.63,1.63,0,0,1-1.79-1.89V358h-0.81v-0.56L445,357l0.43-1.26h0.78v1.32h1.69v1h-1.69v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,447,362.09Z" fill="#666"/>
    <path d="M451.73,363.11a2.87,2.87,0,0,1-2.17-.81,3.07,3.07,0,0,1-.78-2.23,3.37,3.37,0,0,1,.73-2.29,2.5,2.5,0,0,1,2-.83,2.45,2.45,0,0,1,1.86.71,2.73,2.73,0,0,1,.68,2v0.68h-4a2,2,0,0,0,.47,1.33,1.62,1.62,0,0,0,1.24.46,4.57,4.57,0,0,0,1-.1,5.06,5.06,0,0,0,1-.33v1a3.92,3.92,0,0,1-.93.31A5.76,5.76,0,0,1,451.73,363.11Zm-0.23-5.2a1.27,1.27,0,0,0-1,.38,1.81,1.81,0,0,0-.43,1.11h2.7a1.64,1.64,0,0,0-.35-1.11A1.21,1.21,0,0,0,451.5,357.91Z" fill="#666"/>
  </g>
  <g>
    <path d="M404.78,495.11a2.6,2.6,0,0,1-2-.79,4,4,0,0,1,0-4.56,2.72,2.72,0,0,1,2.12-.81,4,4,0,0,1,1.69.35l-0.38,1a3.84,3.84,0,0,0-1.32-.31q-1.54,0-1.54,2a2.45,2.45,0,0,0,.38,1.5,1.33,1.33,0,0,0,1.13.5,3.23,3.23,0,0,0,1.6-.42v1.1a2.49,2.49,0,0,1-.72.28A4.31,4.31,0,0,1,404.78,495.11Z" fill="#666"/>
    <path d="M413.1,492a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.84,2.84,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,413.1,492Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,408.77,492Z" fill="#666"/>
    <path d="M419.77,495H418.5v-3.65a1.6,1.6,0,0,0-.28-1,1.07,1.07,0,0,0-.88-0.34,1.4,1.4,0,0,0-1.17.47,2.61,2.61,0,0,0-.37,1.58v3h-1.26v-5.94h1l0.18,0.78h0.06a1.75,1.75,0,0,1,.76-0.66,2.55,2.55,0,0,1,1.1-.23,1.91,1.91,0,0,1,2.14,2.18V495Z" fill="#666"/>
    <path d="M422.88,495l-2.26-5.94H422l1.21,3.45a6.85,6.85,0,0,1,.38,1.41h0a9.45,9.45,0,0,1,.38-1.41l1.21-3.45h1.34L424.25,495h-1.36Z" fill="#666"/>
    <path d="M432.68,492a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.84,2.84,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,432.68,492Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,428.36,492Z" fill="#666"/>
    <path d="M435.4,495h-1.26v-8.36h1.26V495Z" fill="#666"/>
    <path d="M438.55,495l-2.26-5.94h1.33l1.21,3.45a6.85,6.85,0,0,1,.38,1.41h0a9.45,9.45,0,0,1,.38-1.41l1.21-3.45h1.34L439.92,495h-1.36Z" fill="#666"/>
    <path d="M445.68,495.11a2.87,2.87,0,0,1-2.17-.81,3.07,3.07,0,0,1-.78-2.23,3.37,3.37,0,0,1,.73-2.29,2.5,2.5,0,0,1,2-.83,2.45,2.45,0,0,1,1.86.71,2.73,2.73,0,0,1,.68,2v0.68h-4a2,2,0,0,0,.47,1.33,1.62,1.62,0,0,0,1.24.46,4.57,4.57,0,0,0,1-.1,5.06,5.06,0,0,0,1-.33v1a3.92,3.92,0,0,1-.93.31A5.76,5.76,0,0,1,445.68,495.11Zm-0.23-5.2a1.27,1.27,0,0,0-1,.38,1.81,1.81,0,0,0-.43,1.11h2.7a1.64,1.64,0,0,0-.35-1.11A1.21,1.21,0,0,0,445.45,489.91Z" fill="#666"/>
  </g>
  <g>
    <path d="M408.08,625.31a1.55,1.55,0,0,1-.63,1.33,3,3,0,0,1-1.82.46,4.29,4.29,0,0,1-1.91-.36v-1.09a4.68,4.68,0,0,0,1.95.48q1.17,0,1.17-.7a0.56,0.56,0,0,0-.13-0.38,1.53,1.53,0,0,0-.42-0.31,7.3,7.3,0,0,0-.82-0.37,3.81,3.81,0,0,1-1.39-.79,1.47,1.47,0,0,1-.36-1,1.35,1.35,0,0,1,.62-1.18A2.92,2.92,0,0,1,406,621a4.74,4.74,0,0,1,2,.42l-0.41,1a4.4,4.4,0,0,0-1.62-.4q-1,0-1,.57a0.57,0.57,0,0,0,.26.47,5.72,5.72,0,0,0,1.14.53,5.19,5.19,0,0,1,1.07.52,1.56,1.56,0,0,1,.49.54A1.58,1.58,0,0,1,408.08,625.31Z" fill="#666"/>
    <path d="M414.67,627H413.4v-3.65a1.6,1.6,0,0,0-.28-1,1.07,1.07,0,0,0-.88-0.34,1.39,1.39,0,0,0-1.17.48,2.62,2.62,0,0,0-.37,1.59V627h-1.26v-8.36h1.26v2.12a9.9,9.9,0,0,1-.06,1.09h0.08a1.76,1.76,0,0,1,.72-0.67,2.31,2.31,0,0,1,1.07-.24,1.92,1.92,0,0,1,2.16,2.18V627Z" fill="#666"/>
    <path d="M420.14,627l-0.25-.83h0a2.43,2.43,0,0,1-.86.74,2.73,2.73,0,0,1-1.12.2,1.89,1.89,0,0,1-1.37-.47,1.77,1.77,0,0,1-.49-1.34,1.57,1.57,0,0,1,.68-1.39,3.93,3.93,0,0,1,2.08-.51l1,0v-0.32a1.2,1.2,0,0,0-.27-0.85,1.08,1.08,0,0,0-.82-0.28,2.86,2.86,0,0,0-.88.13,6.61,6.61,0,0,0-.81.32l-0.41-.9a4.37,4.37,0,0,1,1.06-.38,4.86,4.86,0,0,1,1.08-.13,2.57,2.57,0,0,1,1.71.49A1.94,1.94,0,0,1,421,623v4h-0.9Zm-1.88-.86a1.56,1.56,0,0,0,1.1-.38,1.39,1.39,0,0,0,.42-1.08v-0.52l-0.76,0a2.62,2.62,0,0,0-1.3.3,0.91,0.91,0,0,0-.41.81,0.79,0.79,0,0,0,.24.61A1,1,0,0,0,418.26,626.14Z" fill="#666"/>
    <path d="M425.82,621a3,3,0,0,1,.63.05l-0.12,1.18a2.39,2.39,0,0,0-.56-0.06,1.61,1.61,0,0,0-1.23.49,1.79,1.79,0,0,0-.47,1.28V627H422.8v-5.94h1l0.17,1H424a2.35,2.35,0,0,1,.77-0.84A1.83,1.83,0,0,1,425.82,621Z" fill="#666"/>
    <path d="M430.56,627.11a2.08,2.08,0,0,1-1.75-.81h-0.08q0.08,0.75.08,0.91v2.43h-1.26v-8.58h1q0,0.17.18,0.79h0.06a2,2,0,0,1,1.77-.9,2.06,2.06,0,0,1,1.73.81,4.42,4.42,0,0,1,0,4.53A2.08,2.08,0,0,1,430.56,627.11ZM430.25,622a1.31,1.31,0,0,0-1.1.44,2.29,2.29,0,0,0-.35,1.41V624a2.78,2.78,0,0,0,.34,1.57,1.28,1.28,0,0,0,1.12.49,1.14,1.14,0,0,0,1-.54,2.77,2.77,0,0,0,.35-1.53,2.68,2.68,0,0,0-.35-1.51A1.17,1.17,0,0,0,430.25,622Z" fill="#666"/>
    <path d="M437,627.11a2.87,2.87,0,0,1-2.17-.81,3.07,3.07,0,0,1-.78-2.23,3.37,3.37,0,0,1,.73-2.29,2.5,2.5,0,0,1,2-.83,2.45,2.45,0,0,1,1.86.71,2.73,2.73,0,0,1,.68,2v0.68h-4a2,2,0,0,0,.47,1.33,1.63,1.63,0,0,0,1.24.46,4.57,4.57,0,0,0,1-.1,5.13,5.13,0,0,0,1-.33v1a3.88,3.88,0,0,1-.93.31A5.71,5.71,0,0,1,437,627.11Zm-0.23-5.2a1.27,1.27,0,0,0-1,.38,1.81,1.81,0,0,0-.43,1.11h2.7a1.64,1.64,0,0,0-.35-1.11A1.21,1.21,0,0,0,436.76,621.91Z" fill="#666"/>
    <path d="M446,627H444.7v-3.65a1.6,1.6,0,0,0-.28-1,1.07,1.07,0,0,0-.88-0.34,1.4,1.4,0,0,0-1.17.47A2.61,2.61,0,0,0,442,624v3h-1.26v-5.94h1l0.18,0.78H442a1.76,1.76,0,0,1,.76-0.66,2.56,2.56,0,0,1,1.1-.23,1.91,1.91,0,0,1,2.14,2.18V627Z" fill="#666"/>
  </g>
  <g>
    <path d="M408.22,229.31a1.55,1.55,0,0,1-.63,1.33,3,3,0,0,1-1.82.46,4.29,4.29,0,0,1-1.91-.36v-1.09a4.68,4.68,0,0,0,1.95.48q1.17,0,1.17-.7a0.56,0.56,0,0,0-.13-0.38,1.53,1.53,0,0,0-.42-0.31,7.3,7.3,0,0,0-.82-0.37,3.81,3.81,0,0,1-1.39-.79,1.47,1.47,0,0,1-.36-1,1.35,1.35,0,0,1,.62-1.18,2.92,2.92,0,0,1,1.67-.42,4.74,4.74,0,0,1,2,.42l-0.41,1a4.4,4.4,0,0,0-1.62-.4q-1,0-1,.57a0.57,0.57,0,0,0,.26.47,5.72,5.72,0,0,0,1.14.53,5.19,5.19,0,0,1,1.07.52,1.56,1.56,0,0,1,.49.54A1.58,1.58,0,0,1,408.22,229.31Z" fill="#666"/>
    <path d="M414.85,228a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.85,2.85,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,414.85,228Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,410.53,228Z" fill="#666"/>
    <path d="M419.29,226h-1.45v5h-1.27v-5h-1v-0.59l1-.39v-0.39a2.16,2.16,0,0,1,.49-1.56,2,2,0,0,1,1.51-.51,4,4,0,0,1,1.31.22l-0.33,1a2.92,2.92,0,0,0-.89-0.15,0.73,0.73,0,0,0-.63.27,1.34,1.34,0,0,0-.2.8v0.39h1.45v1Z" fill="#666"/>
    <path d="M422.51,230.09a3.07,3.07,0,0,0,.92-0.15v1a2.55,2.55,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06,1.63,1.63,0,0,1-1.79-1.89V226H419.6v-0.56l0.87-.46,0.43-1.26h0.78v1.32h1.69v1h-1.69v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,422.51,230.09Z" fill="#666"/>
    <path d="M429.62,231h-1.27v-3.66a1.66,1.66,0,0,0-.26-1,1,1,0,0,0-.81-0.34,1.23,1.23,0,0,0-1.07.48,2.78,2.78,0,0,0-.34,1.58v3h-1.26v-5.94h1l0.18,0.78h0.06a1.64,1.64,0,0,1,.72-0.66,2.31,2.31,0,0,1,1-.23,1.81,1.81,0,0,1,1.82.93h0.09a1.81,1.81,0,0,1,.74-0.69,2.36,2.36,0,0,1,1.1-.25,2,2,0,0,1,1.55.54,2.38,2.38,0,0,1,.49,1.64V231h-1.26v-3.66a1.65,1.65,0,0,0-.26-1A1,1,0,0,0,431,226a1.25,1.25,0,0,0-1.08.46,2.37,2.37,0,0,0-.34,1.41V231Z" fill="#666"/>
    <path d="M438.85,231l-0.25-.83h0a2.43,2.43,0,0,1-.86.74,2.73,2.73,0,0,1-1.12.2,1.89,1.89,0,0,1-1.37-.47,1.77,1.77,0,0,1-.49-1.34,1.57,1.57,0,0,1,.68-1.39,3.93,3.93,0,0,1,2.08-.51l1,0v-0.32a1.2,1.2,0,0,0-.27-0.85,1.08,1.08,0,0,0-.82-0.28,2.86,2.86,0,0,0-.88.13,6.61,6.61,0,0,0-.81.32l-0.41-.9a4.37,4.37,0,0,1,1.06-.38,4.86,4.86,0,0,1,1.08-.13,2.57,2.57,0,0,1,1.71.49,1.94,1.94,0,0,1,.58,1.55v4h-0.9Zm-1.88-.86a1.56,1.56,0,0,0,1.1-.38,1.39,1.39,0,0,0,.42-1.08v-0.52l-0.76,0a2.62,2.62,0,0,0-1.3.3,0.91,0.91,0,0,0-.41.81,0.79,0.79,0,0,0,.24.61A1,1,0,0,0,437,230.14Z" fill="#666"/>
    <path d="M442.84,228l-2-2.91h1.44l1.35,2.08,1.36-2.08h1.43l-2,2.91,2.1,3H445.1l-1.47-2.22L442.18,231h-1.43Z" fill="#666"/>
  </g>
  <g>
    <path d="M396.57,99.27a2.07,2.07,0,0,1-1.73-.81,4.42,4.42,0,0,1,0-4.54,2.09,2.09,0,0,1,1.75-.81,2,2,0,0,1,1.78.86h0.06a7.54,7.54,0,0,1-.09-1V90.81h1.27v8.36h-1l-0.22-.78h-0.06A2,2,0,0,1,396.57,99.27Zm0.34-1a1.37,1.37,0,0,0,1.13-.44,2.31,2.31,0,0,0,.37-1.42V96.22a2.66,2.66,0,0,0-.37-1.6,1.36,1.36,0,0,0-1.14-.47,1.16,1.16,0,0,0-1,.54,2.77,2.77,0,0,0-.36,1.54,2.69,2.69,0,0,0,.35,1.51A1.18,1.18,0,0,0,396.91,98.25Z" fill="#666"/>
    <path d="M406.69,96.19a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.85,2.85,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,406.69,96.19Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,402.36,96.19Z" fill="#666"/>
    <path d="M410.35,98.25a3.07,3.07,0,0,0,.92-0.15v1a2.55,2.55,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06,1.63,1.63,0,0,1-1.79-1.89v-3.2h-0.81V93.62l0.87-.46,0.43-1.26h0.78v1.32h1.69v1h-1.69v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,410.35,98.25Z" fill="#666"/>
    <path d="M418.33,99.27a2.08,2.08,0,0,1-1.75-.81h-0.08q0.08,0.75.08,0.91v2.43h-1.26V93.23h1q0,0.17.18,0.79h0.06a2,2,0,0,1,1.77-.9,2.06,2.06,0,0,1,1.73.81,4.42,4.42,0,0,1,0,4.53A2.08,2.08,0,0,1,418.33,99.27ZM418,94.15a1.31,1.31,0,0,0-1.1.44,2.29,2.29,0,0,0-.35,1.41v0.19a2.78,2.78,0,0,0,.34,1.57,1.28,1.28,0,0,0,1.12.49,1.14,1.14,0,0,0,1-.54,2.77,2.77,0,0,0,.35-1.53,2.68,2.68,0,0,0-.35-1.51A1.17,1.17,0,0,0,418,94.15Z" fill="#666"/>
    <path d="M425.19,93.12a3,3,0,0,1,.63.05l-0.12,1.18a2.39,2.39,0,0,0-.56-0.06,1.61,1.61,0,0,0-1.23.49,1.79,1.79,0,0,0-.47,1.28v3.1h-1.26V93.23h1l0.17,1h0.06a2.35,2.35,0,0,1,.77-0.84A1.83,1.83,0,0,1,425.19,93.12Z" fill="#666"/>
    <path d="M432.18,96.19a3.24,3.24,0,0,1-.75,2.27,2.67,2.67,0,0,1-2.08.82,2.85,2.85,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,432.18,96.19Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.68,2.68,0,0,0,427.86,96.19Z" fill="#666"/>
    <path d="M435.64,99.27a2.07,2.07,0,0,1-1.73-.81,4.42,4.42,0,0,1,0-4.54,2.09,2.09,0,0,1,1.75-.81,2,2,0,0,1,1.78.86h0.06a7.54,7.54,0,0,1-.09-1V90.81h1.27v8.36h-1l-0.22-.78h-0.06A2,2,0,0,1,435.64,99.27Zm0.34-1a1.37,1.37,0,0,0,1.13-.44,2.31,2.31,0,0,0,.37-1.42V96.22a2.66,2.66,0,0,0-.37-1.6,1.36,1.36,0,0,0-1.14-.47,1.16,1.16,0,0,0-1,.54,2.77,2.77,0,0,0-.36,1.54,2.69,2.69,0,0,0,.35,1.51A1.18,1.18,0,0,0,436,98.25Z" fill="#666"/>
    <path d="M444.68,99.17l-0.18-.78h-0.06a1.79,1.79,0,0,1-.75.65,2.5,2.5,0,0,1-1.11.24,2.18,2.18,0,0,1-1.61-.54,2.23,2.23,0,0,1-.53-1.63V93.23h1.27v3.66a1.59,1.59,0,0,0,.28,1,1.07,1.07,0,0,0,.88.34,1.39,1.39,0,0,0,1.17-.48,2.62,2.62,0,0,0,.37-1.59v-3h1.27v5.94h-1Z" fill="#666"/>
    <path d="M449.87,99.27a2.6,2.6,0,0,1-2-.79,4,4,0,0,1,0-4.56,2.72,2.72,0,0,1,2.12-.81,4,4,0,0,1,1.69.35l-0.38,1a3.83,3.83,0,0,0-1.32-.31q-1.54,0-1.54,2a2.45,2.45,0,0,0,.38,1.5,1.33,1.33,0,0,0,1.13.5,3.23,3.23,0,0,0,1.6-.42v1.1a2.49,2.49,0,0,1-.72.28A4.34,4.34,0,0,1,449.87,99.27Z" fill="#666"/>
    <path d="M455.13,98.25a3.07,3.07,0,0,0,.92-0.15v1a2.55,2.55,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06A1.63,1.63,0,0,1,453,97.38v-3.2h-0.81V93.62l0.87-.46,0.43-1.26h0.78v1.32H456v1H454.3v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,455.13,98.25Z" fill="#666"/>
  </g>
  <use id="query" width="36" height="36" transform="translate(835.59 78)" xlink:href="#array-vector"/>
  <g id="memory">
    <use width="36" height="36" transform="translate(335 12)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(371 12)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(407 12)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(443 12)" xlink:href="#array-vector"/>
    <use width="36" height="36" transform="translate(479 12)" xlink:href="#array-vector"/>
  </g>
  <use width="26.87" height="26.87" transform="translate(880.37 82.78)" xlink:href="#pointer"/>
  <use width="26.87" height="26.87" transform="translate(881.72 346.66)" xlink:href="#pointer"/>
  <use width="26.87" height="26.87" transform="translate(952.89 477.66)" xlink:href="#pointer"/>
  <g opacity="0.6">
    <text transform="translate(525.41 33)" font-size="13" font-family="Open Sans">memory</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(528.5 156.63)" font-size="13" font-family="Open Sans" font-style="italic">Blue shows high similarity, <tspan x="0" y="20">pink high dissimilarity.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(835.09 328)" font-size="13" font-family="Open Sans">interpolation amount</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(835.09 460)" font-size="13" font-family="Open Sans">shift filter</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(825.09 12)" font-size="13" font-family="Open Sans" font-style="italic">RNN controller</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(678.56 12)" font-size="13" font-family="Open Sans" font-style="italic">attention mechanism</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(835.09 64)" font-size="13" font-family="Open Sans">query vector</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(597.03 266)" font-size="13" font-family="Open Sans">attention from previous step</text>
  </g>
  <g opacity="0.6">
    <text transform="translate(346.09 728)" font-size="13" font-family="Open Sans">new attention distribution</text>
  </g>
  <circle id="query-hover" cx="912.96" cy="95.44" r="87.04" fill="#fff" fill-opacity="0"/>
  <circle id="interpolate-hover" cx="862.96" cy="357.04" r="41.37" fill="#fff" fill-opacity="0"/>
  <rect id="shift-hover" x="815.59" y="449" width="168" height="84" fill-opacity="0" opacity="0.6"/>
</svg>
</figure>
<script>
"use strict";
//
// Data
//

var vectorScale = d3.scaleLinear().domain([0, 1]).range([-14, 14]);

var memoryData = [{ x: 0.4, y: 0.2 }, { x: 0.2, y: 0.2 }, { x: 0.1, y: 0.9 }, { x: 0.9, y: 0.9 }, { x: 0.4, y: 0.3 }];
var interpolationData = [0.3];
var shiftData = [0, 0.2, 0.8];
var previousAttentionData = [0, 0.2, 0, 0.2, 0.6];

//
// DOM
//

var html = d3.selectAll("#rnn-write-detail");
var svg = html.select("svg");
var svgBBox = svg.node().getBoundingClientRect();

var query = svg.selectAll("#query").style("opacity", 0);
var memory = svg.selectAll("#memory use").style("opacity", 0);
var shift = svg.selectAll("#shift use");

//
// Render
//

// Store positions of vectors
function cachePositions(selection) {
  selection.each(function (d) {
    var bBox = this.getBoundingClientRect();
    d.top = bBox.top - svgBBox.top;
    d.left = bBox.left - svgBBox.left;
    d.width = bBox.width;
  });
}

// Render new vector lines
function renderVector(selection) {
  selection.attr("transform", function (d) {
    return "translate(" + (d.left + d.width / 2 - vectorScale(d.x) / 2) + ", " + (d.top + d.width / 2 - vectorScale(d.y) / 2) + ")";
  }).attr("x2", function (d) {
    return vectorScale(d.x);
  }).attr("y2", function (d) {
    return vectorScale(d.y);
  }).attr("marker-end", "url(#arrowhead)").style("stroke", "grey");
}

// Memory
memory.data(memoryData);
cachePositions(memory);
var memoryVector = svg.selectAll(".memory-vector").data(memoryData).enter().append("line").attr("class", "memory-vector");
renderVector(memoryVector);

var queryData = [{ x: 0.7, y: 0.8 }];
query.data(queryData);
cachePositions(query);

var queryVector = svg.selectAll(".query-vector").data(queryData).enter().append("line").attr("class", "query-vector");

var clamp = d3.scaleLinear().clamp(true);

function redraw() {

  renderVector(queryVector);

  // Dot
  var dotData = memoryData.map(function (v) {
    return 2 * (v.x - 0.5) * 2 * (queryData[0].x - 0.5) + 2 * (v.y - 0.5) * 2 * (queryData[0].y - 0.5);
  });
  svg.selectAll("#dot use").data(dotData).attr("xlink:href", function (d) {
    return d < 0 ? "#array-negative-value" : "#array-positive-value";
  }).style("opacity", function (d) {
    return Math.abs(d);
  });

  // Softmax
  var expDotData = dotData.map(Math.exp);
  var softmaxData = expDotData.map(function (x) {
    return x / d3.sum(expDotData);
  });
  svg.selectAll("#softmax use").data(softmaxData).style("opacity", function (d) {
    return d;
  });

  // Interpolate
  svg.selectAll("#previous use").data(previousAttentionData).style("opacity", function (d) {
    return d;
  });

  svg.selectAll("#interpolate-amount").data(interpolationData).style("opacity", function (d) {
    return d;
  });

  var interpolateData = previousAttentionData.map(function (d, i) {
    return interpolationData * d + (1 - interpolationData) * softmaxData[i];
  });
  svg.selectAll("#interpolate use").data(interpolateData).style("opacity", function (d) {
    return d;
  });

  // Convolve
  shift.data(shiftData).style("opacity", function (d) {
    return d;
  });

  var convolveData = dotData.map(function (x) {
    return 0;
  });
  for (var n in shiftData) {
    for (var i in convolveData) {
      if (i - (1 - n) >= 0) {
        convolveData[i - (1 - n)] += shiftData[n] * interpolateData[i];
      }
    }
  }
  // = dotData;
  svg.selectAll("#convolve use").data(convolveData).style("opacity", function (d) {
    return d;
  });

  // Sharpen
  var sharpenData = convolveData.map(function (x) {
    return x * x;
  });
  sharpenData = sharpenData.map(function (x) {
    return x / d3.sum(sharpenData);
  });
  svg.selectAll("#new-attention use").data(sharpenData).style("opacity", function (d) {
    return d;
  });
}

svg.select("#query-hover").on("mousemove", function () {
  var bbox = svg.select("#query").node().getBoundingClientRect();
  var x = d3.event.clientX - bbox.left - bbox.width / 2;
  var y = d3.event.clientY - bbox.top - bbox.height / 2;
  //TODO: this clamping is awkward
  queryData[0].x = clamp((x + 25) / 50);
  queryData[0].y = clamp((y + 25) / 50);
  redraw();
});
svg.select("#interpolate-hover").on("mousemove", function () {
  var bbox = svg.select("#interpolate-amount").node().getBoundingClientRect();
  interpolationData = [Math.max(0, Math.min(1, (d3.event.clientX - bbox.left) / bbox.width))];
  redraw();
});
// .on("mouseout", function() {
//   interpolationData = [0.3];
//   redraw();
// });

svg.select("#shift-hover").on("mousemove", function () {
  //  shiftData = [0, 0.2, 0.8];
  shiftData = [];
  shift.each(function () {
    var bbox = this.getBoundingClientRect();
    var distance = Math.abs(bbox.left - d3.event.clientX + bbox.width / 2);
    shiftData.push(Math.exp(-distance / 25));
  });
  shiftData = shiftData.map(function (d) {
    return d / d3.sum(shiftData);
  });
  redraw();
});
redraw();
</script>
</p>
<p>This capability to read and write allows NTMs to perform many simple algorithms, previously beyond neural networks. For example, they can learn to store a long sequence in memory, and then loop over it, repeating it back repeatedly. As they do this, we can watch where they read and write, to better understand what they’re doing:</p>
<figure class="p-right-margin external" style="width: 396px; margin-left: 48px;">
  <img src="assets/NTM-Copy-ReadWrite.svg"></img>
  <figcaption style="bottom: 0px;">See more experiments in <a href="https://arxiv.org/pdf/1410.5401.pdf">Graves, <em>et al.</em>, 2014</a>. This figure is based on the Repeat Copy experiment.</figcaption>
</figure>


<p>They can also learn to mimic a lookup table, or even learn to sort numbers (although they kind of cheat)! On the other hand, they still can’t do many basic things, like add or multiply numbers.</p>
<p>Since the original NTM paper, there’s been a number of exciting papers exploring similar directions. The Neural GPU (<a href="http://arxiv.org/pdf/1511.08228.pdf">Kaiser &amp; Sutskever, 2015</a>) overcomes the NTM’s inability to add and multiply numbers.  <a href="http://arxiv.org/pdf/1505.00521.pdf">Zaremba &amp; Sutskever, 2016</a> train NTMs using reinforcement learning instead of the differentiable read/writes used by the original. Neural Random Access Machines (<a href="http://arxiv.org/pdf/1511.06392.pdf">Kurach <em>et al.</em>, 2015</a>) work based on pointers. Some papers have explored differentiable data structures, like stacks and queues (<a href="http://papers.nips.cc/paper/5648-learning-to-transduce-with-unbounded-memory.pdf">Grefenstette <em>et al</em>. 2015</a>; <a href="https://arxiv.org/pdf/1503.01007.pdf">Joulin &amp; Mikolov, 2015</a>). And memory networks (<a href="http://arxiv.org/abs/1410.3916">Weston <em>et al.</em>, 2014</a>; <a href="http://arxiv.org/abs/1506.07285">Kumar <em>et al.</em>, 2015</a>) are another approach to attacking similar problems.</p>
<p>In some objective sense, many of the tasks these models can perform – such as learning how to add numbers – aren’t that objectively hard. The traditional program synthesis community would eat them for lunch. But neural networks are capable of many other things, and models like the Neural Turing Machine seem to have knocked away a very profound limit on their abilities.</p>
<h3 id="code">Code</h3>
<p>There are a number of open source implementations of these models. Open source implementations of the Neural Turing Machine include <a href="https://github.com/carpedm20/NTM-tensorflow">Taehoon Kim’s</a> (TensorFlow), <a href="https://github.com/shawntan/neural-turing-machines">Shawn Tan’s</a> (Thenao), <a href="https://github.com/fumin/ntm">Fumin’s</a> (Go), <a href="https://github.com/kaishengtai/torch-ntm">Kai Sheng Tai’s</a> (Torch), and <a href="https://github.com/snipsco/ntm-lasagne">Snip’s</a> (Lasagne). Code for the Neural GPU publication was open sourced and put in the <a href="https://github.com/tensorflow/models/tree/master/neural_gpu">TensorFlow Models repository</a>. Open source implementations of Memory Networks include <a href="https://github.com/facebook/MemNN">Facebook’s</a> (Torch/Matlab), <a href="https://github.com/YerevaNN/Dynamic-memory-networks-in-Theano">YerevaNN’s</a> (Theano), and <a href="https://github.com/carpedm20/MemN2N-tensorflow">Taehoon Kim’s</a> (TensorFlow). </span></p></p>
<hr>
<h2 id="attentional-interfaces">Attentional Interfaces</h2>
<p>When I’m translating a sentence, I pay special attention to the word I’m presently translating. When I’m transcribing an audio recording, I listen carefully to the segment I’m actively writing down. And if you ask me to describe the room I’m sitting in, I’ll glance around at the objects I’m describing as I do so.</p>
<p>Neural networks can achieve this same behavior using <em>attention</em>, focusing on part of a subset of the information they’re given. For example, an RNN can attend over the output of another RNN. At every time step, it focuses on different positions in the other RNN.</p>
<p>We’d like attention to be differentiable, so that we can learn where to focus. To do this, we use the same trick Neural Turing Machines use: we focus everywhere, just to different extents.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="252" viewBox="0 0 984 252">
  <defs>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-b" data-name="rnn-b" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M19.83,16.21h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25,6,6,0,0,1-3.94,1.17H19.83V16.21Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58H21.64v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68H21.64Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-15" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="447.56" y="12" width="360.44" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="447.56" y="12" width="360.44" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <rect x="167.56" y="168" width="360.44" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="167.56" y="168" width="360.44" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <g>
    <line x1="579" y1="108.81" x2="579" y2="82.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M579,77a27.2,27.2,0,0,0,4.28,7.69L579,83.14l-4.28,1.55A27.17,27.17,0,0,0,579,77Z" fill="#666"/>
  </g>
  <g>
    <line x1="483" y1="108.81" x2="483" y2="82.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M483,77a27.2,27.2,0,0,0,4.28,7.69L483,83.14l-4.28,1.55A27.17,27.17,0,0,0,483,77Z" fill="#666"/>
  </g>
  <g>
    <line x1="505.92" y1="48.73" x2="544.57" y2="48.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M550,48.73A27.2,27.2,0,0,0,542.31,53l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,550,48.73Z" fill="#666"/>
  </g>
  <g>
    <line x1="225.92" y1="204" x2="264.57" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M270,204a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,270,204Z" fill="#666"/>
  </g>
  <g>
    <line x1="321.92" y1="204" x2="360.57" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M366,204a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,366,204Z" fill="#666"/>
  </g>
  <g>
    <line x1="417.92" y1="204" x2="456.57" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M462,204a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,462,204Z" fill="#666"/>
  </g>
  <g>
    <line x1="602.92" y1="48.73" x2="640.57" y2="48.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M646,48.73A27.2,27.2,0,0,0,638.31,53l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,646,48.73Z" fill="#666"/>
  </g>
  <g>
    <line x1="697.92" y1="48.73" x2="736.57" y2="48.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M742,48.73A27.2,27.2,0,0,0,734.31,53l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,742,48.73Z" fill="#666"/>
  </g>
  <g>
    <line x1="675" y1="108.81" x2="675" y2="82.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M675,77a27.2,27.2,0,0,0,4.28,7.69L675,83.14l-4.28,1.55A27.17,27.17,0,0,0,675,77Z" fill="#666"/>
  </g>
  <g>
    <line x1="771" y1="108.81" x2="771" y2="82.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M771,77a27.2,27.2,0,0,0,4.28,7.69L771,83.14l-4.28,1.55A27.17,27.17,0,0,0,771,77Z" fill="#666"/>
  </g>
  <g>
    <g opacity="0.2">
      <path d="M204.5,199V163.5a11.56,11.56,0,0,1,9.93-11.17l253.64-29.89c5.46-.64,9.93-4.16,9.93-7.81V108" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.4">
      <path d="M300,199V167.29a12.42,12.42,0,0,1,9.85-11.75l161.31-28.72c5.41-1,9.85-5.59,9.85-10.28V108" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <path d="M396,199V171.08a15.4,15.4,0,0,1,9.39-13.44l69.22-25.35A15.4,15.4,0,0,0,484,118.85V108" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    <g opacity="0.2">
      <path d="M491.5,199V171.08a167.71,167.71,0,0,0-1.44-19.9l-1.25-8.64a167.71,167.71,0,0,1-1.44-19.9V108" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g>
    <path d="M574.67,112a36.23,36.23,0,0,1,.33,6c-2,9-12,9-20.38,9.39L533.5,128.5" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M535.42,128.4l19.42-1C563.17,127,574,127.08,575,118a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M537.34,128.3l17.73-.93C563.34,127,574,127,575,118a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M539.26,128.2l16-.84C563.51,127,574,126.92,575,118a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M541.18,128.09l14.33-.75C563.67,127,574,126.84,575,118a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M543.1,128l12.64-.66c8.1-.37,18.3-0.57,19.26-9.34a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M545,127.89l10.94-.57c8-.37,18.08-0.64,19-9.33a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M546.94,127.79l9.25-.47c8-.37,17.87-0.71,18.81-9.32a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M548.86,127.69l7.55-.38c7.94-.37,17.65-0.78,18.59-9.31a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M550.78,127.59l5.85-.29c7.88-.36,17.44-0.85,18.37-9.3a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M552.7,127.49l4.16-.2c7.83-.36,17.23-0.93,18.14-9.29a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M554.62,127.39l2.46-.11c7.77-.36,16.11-1.14,17.92-9.28a36.23,36.23,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M577.67,112c0,5.08,1,10.8-2.73,14.82-4,4.25-11,4.32-16.43,5.14L535,134.5" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M537.14,134.27L558.57,132c5.43-.78,12.38-0.9,16.36-5.13,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M539.27,134l19.37-2.1c5.41-.77,12.33-0.91,16.29-5.12,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.16"/>
    <path d="M541.41,133.81l17.3-1.88c5.4-.77,12.28-0.92,16.22-5.11,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.25"/>
    <path d="M543.55,133.58l15.23-1.65c5.39-.76,12.23-0.93,16.16-5.1,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.33"/>
    <path d="M545.68,133.35l13.16-1.43c5.38-.76,12.18-0.93,16.09-5.09s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.41"/>
    <path d="M547.82,133.12l11.09-1.21c5.37-.75,12.13-0.94,16-5.08s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.49"/>
    <path d="M550,132.88l9-1c5.36-.75,12.08-1,16-5.07s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.57"/>
    <path d="M552.1,132.65l7-.77c5.35-.75,12-1,15.88-5.06s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.65"/>
    <path d="M554.23,132.42l4.88-.55c5.33-.75,12-1,15.82-5.06s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.74"/>
    <path d="M556.37,132.19l2.82-.33c5.32-.74,11.92-1,15.75-5s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.82"/>
    <path d="M558.51,132l0.75-.11c5.31-.73,11.87-1,15.68-5s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.9"/>
  </g>
  <g>
    <path d="M580.67,112v8.09c0,6.89-2.61,13.08-9.7,15.37-1.66.54-3.39,0.91-5.07,1.36L545,144" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M546.9,143.35L566,136.79c1.65-.43,3.33-0.81,5-1.33,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M548.8,142.69l17.33-5.93c1.61-.42,3.26-0.79,4.84-1.3,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M550.7,142l15.54-5.31c1.57-.41,3.18-0.77,4.72-1.27,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M552.6,141.39c0.15,0,13.6-4.65,13.76-4.69,1.53-.4,3.1-0.75,4.61-1.24,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M554.5,140.74c0.19-.05,11.78-4,12-4.06,1.5-.38,3-0.74,4.49-1.21,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M556.4,140.08c0.23-.06,10-3.38,10.19-3.44,1.46-.37,2.94-0.72,4.38-1.18,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M558.3,139.43c0.27-.07,8.14-2.75,8.41-2.82,1.42-.36,2.87-0.7,4.26-1.15,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.06"/>
    <path d="M560.2,138.78c0.31-.08,6.31-2.12,6.62-2.2,1.39-.35,2.79-0.68,4.14-1.12,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.07"/>
    <path d="M562.1,138.13c0.34-.09,4.49-1.49,4.84-1.57,1.35-.34,2.71-0.67,4-1.09,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M564,137.47c0.38-.1,2.67-0.85,3.05-1,1.31-.33,2.63-0.65,3.91-1.06,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.09"/>
    <path d="M565.9,136.82l1.27-.33c1.27-.32,2.56-0.63,3.8-1,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.1"/>
  </g>
  <g>
    <path d="M584,112c0,10.32,1.14,20.66-5.19,29.6L570,150" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M570.8,149.24c0-.07,8.13-7.78,8.18-7.84,5.74-9.18,5.06-19.15,5.06-29.39" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M571.61,148.47c0.1-.14,7.42-7.15,7.51-7.29,5.63-9.1,4.93-19,4.93-29.18" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M572.41,147.71c0.15-.21,6.71-6.53,6.83-6.74,5.53-9,4.79-18.89,4.79-29" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M573.22,146.95c0.2-.28,6-5.91,6.16-6.19C584.8,131.82,584,122,584,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M574,146.18c0.25-.35,5.28-5.28,5.49-5.63,5.31-8.86,4.53-18.63,4.53-28.55" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M574.83,145.42c0.29-.42,4.57-4.66,4.82-5.08,5.21-8.78,4.39-18.5,4.39-28.34" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M575.63,144.66c0.34-.49,3.86-4,4.15-4.53,5.1-8.7,4.26-18.37,4.26-28.13" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M576.44,143.89c0.39-.55,3.15-3.41,3.48-4,5-8.62,4.13-18.24,4.13-27.92" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M577.24,143.13c0.44-.62,2.44-2.79,2.81-3.42,4.89-8.54,4-18.11,4-27.71" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M578,142.37c0.49-.69,1.73-2.16,2.13-2.87C585,131,584,121.52,584,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M578.85,141.6a25.6,25.6,0,0,0,1.46-2.32C585,130.9,584,121.44,584,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M670.33,112a36.23,36.23,0,0,1,.33,6c-2,9-12,9-20.38,9.39l-21.12,1.11" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M631.09,128.4l19.42-1c8.33-.38,19.16-0.29,20.16-9.38a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M633,128.3l17.73-.93C659,127,669.68,127,670.67,118a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.16"/>
    <path d="M634.93,128.2l16-.84c8.21-.38,18.73-0.43,19.71-9.36a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.25"/>
    <path d="M636.85,128.09l14.33-.75c8.16-.38,18.51-0.5,19.49-9.35a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.33"/>
    <path d="M638.77,128l12.64-.66c8.1-.37,18.3-0.57,19.26-9.34a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.41"/>
    <path d="M640.69,127.89l10.94-.57c8-.37,18.08-0.64,19-9.33a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.49"/>
    <path d="M642.61,127.79l9.25-.47c8-.37,17.87-0.71,18.81-9.32a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.57"/>
    <path d="M644.53,127.69l7.55-.38c7.94-.37,17.65-0.78,18.59-9.31a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.65"/>
    <path d="M646.45,127.59l5.85-.29c7.88-.36,17.44-0.85,18.37-9.3a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.74"/>
    <path d="M648.37,127.49l4.16-.2c7.83-.36,17.23-0.93,18.14-9.29a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.82"/>
    <path d="M650.29,127.39l2.46-.11c7.77-.36,16.11-1.14,17.92-9.28a36.23,36.23,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.9"/>
  </g>
  <g>
    <path d="M673.33,112c0,5.08,1,10.8-2.73,14.82-4,4.25-11,4.32-16.43,5.14l-23.51,2.54" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M632.8,134.27L654.24,132c5.43-.78,12.38-0.9,16.36-5.13,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M634.94,134l19.37-2.1c5.41-.77,12.33-0.91,16.29-5.12,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M637.08,133.81l17.3-1.88c5.4-.77,12.28-0.92,16.22-5.11,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M639.21,133.58l15.23-1.65c5.39-.76,12.23-0.93,16.16-5.1,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M641.35,133.35l13.16-1.43c5.38-.76,12.18-0.93,16.09-5.09s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M643.49,133.12l11.09-1.21c5.37-.75,12.13-0.94,16-5.08s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M645.63,132.88l9-1c5.36-.75,12.08-1,16-5.07s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.06"/>
    <path d="M647.76,132.65l7-.77c5.35-.75,12-1,15.88-5.06s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.07"/>
    <path d="M649.9,132.42l4.88-.55c5.33-.75,12-1,15.82-5.06s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M652,132.19l2.82-.33c5.32-.74,11.92-1,15.75-5s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.09"/>
    <path d="M654.17,132l0.75-.11c5.31-.73,11.87-1,15.68-5s2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.1"/>
  </g>
  <g>
    <path d="M676.33,112v8.09c0,6.89-2.61,13.08-9.7,15.37-1.66.54-3.39,0.91-5.07,1.36L640.67,144" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M642.57,143.35l19.11-6.56c1.65-.43,3.33-0.81,5-1.33,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M644.47,142.69l17.33-5.93c1.61-.42,3.26-0.79,4.84-1.3,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M646.37,142l15.54-5.31c1.57-.41,3.18-0.77,4.72-1.27,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M648.27,141.39c0.15,0,13.6-4.65,13.76-4.69,1.53-.4,3.1-0.75,4.61-1.24,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M650.16,140.74c0.19-.05,11.78-4,12-4.06,1.5-.38,3-0.74,4.49-1.21,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M652.06,140.08c0.23-.06,10-3.38,10.19-3.44,1.46-.37,2.94-0.72,4.38-1.18,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M654,139.43c0.27-.07,8.14-2.75,8.41-2.82,1.42-.36,2.87-0.7,4.26-1.15,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M655.86,138.78c0.31-.08,6.31-2.12,6.62-2.2,1.39-.35,2.79-0.68,4.14-1.12,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M657.76,138.13c0.34-.09,4.49-1.49,4.84-1.57,1.35-.34,2.71-0.67,4-1.09,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M659.66,137.47c0.38-.1,2.67-0.85,3.05-1,1.31-.33,2.63-0.65,3.91-1.06,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M661.56,136.82l1.27-.33c1.27-.32,2.56-0.63,3.8-1,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M679.71,112c0,10.32,1.14,20.66-5.19,29.6l-8.85,8.4" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M666.47,149.24c0-.07,8.13-7.78,8.18-7.84,5.74-9.18,5.06-19.15,5.06-29.39" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M667.28,148.47c0.1-.14,7.42-7.15,7.51-7.29,5.63-9.1,4.93-19,4.93-29.18" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M668.08,147.71c0.15-.21,6.71-6.53,6.83-6.74,5.53-9,4.79-18.89,4.79-29" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M668.88,146.95c0.2-.28,6-5.91,6.16-6.19,5.42-8.94,4.66-18.76,4.66-28.76" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M669.69,146.18c0.25-.35,5.28-5.28,5.49-5.63,5.31-8.86,4.53-18.63,4.53-28.55" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M670.49,145.42c0.29-.42,4.57-4.66,4.82-5.08,5.21-8.78,4.39-18.5,4.39-28.34" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M671.3,144.66c0.34-.49,3.86-4,4.15-4.53,5.1-8.7,4.26-18.37,4.26-28.13" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M672.1,143.89c0.39-.55,3.15-3.41,3.48-4,5-8.62,4.13-18.24,4.13-27.92" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M672.91,143.13c0.44-.62,2.44-2.79,2.81-3.42,4.89-8.54,4-18.11,4-27.71" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M673.71,142.37c0.49-.69,1.73-2.16,2.13-2.87,4.79-8.46,3.86-18,3.86-27.5" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M674.52,141.6a25.6,25.6,0,0,0,1.46-2.32c4.68-8.39,3.73-17.85,3.73-27.28" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M767,112a36.23,36.23,0,0,1,.33,6c-2,9-12,9-20.38,9.39l-21.12,1.11" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M727.75,128.4l19.42-1c8.33-.38,19.16-0.29,20.16-9.38a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M729.67,128.3l17.73-.93c8.27-.38,18.94-0.36,19.93-9.37a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M731.59,128.2l16-.84c8.21-.38,18.73-0.43,19.71-9.36a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M733.51,128.09l14.33-.75c8.16-.38,18.51-0.5,19.49-9.35a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M735.43,128l12.64-.66c8.1-.37,18.3-0.57,19.26-9.34a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M737.35,127.89l10.94-.57c8-.37,18.08-0.64,19-9.33a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M739.27,127.79l9.25-.47c8-.37,17.87-0.71,18.81-9.32a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M741.19,127.69l7.55-.38c7.94-.37,17.65-0.78,18.59-9.31a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M743.11,127.59l5.85-.29c7.88-.36,17.44-0.85,18.37-9.3a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M745,127.49l4.16-.2c7.83-.36,17.23-0.93,18.14-9.29a22,22,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M747,127.39l2.46-.11c7.77-.36,16.11-1.14,17.92-9.28a36.23,36.23,0,0,0-.33-6" fill="none" stroke="#d6baf7" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M770,112c0,5.08,1,10.8-2.73,14.82-4,4.25-11,4.32-16.43,5.14l-23.51,2.54" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M729.47,134.27L750.91,132c5.43-.78,12.38-0.9,16.36-5.13,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M731.61,134l19.37-2.1c5.41-.77,12.33-0.91,16.29-5.12,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M733.74,133.81l17.3-1.88c5.4-.77,12.28-0.92,16.22-5.11,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M735.88,133.58l15.23-1.65c5.39-.76,12.23-0.93,16.16-5.1,3.78-4,2.73-9.74,2.73-14.82" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M738,133.35l13.16-1.43c5.38-.76,12.18-0.93,16.09-5.09S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M740.16,133.12l11.09-1.21c5.37-.75,12.13-0.94,16-5.08S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M742.29,132.88l9-1c5.36-.75,12.08-1,16-5.07S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.06"/>
    <path d="M744.43,132.65l7-.77c5.35-.75,12-1,15.88-5.06S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.07"/>
    <path d="M746.57,132.42l4.88-.55c5.33-.75,12-1,15.82-5.06S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M748.7,132.19l2.82-.33c5.32-.74,11.92-1,15.75-5S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.09"/>
    <path d="M750.84,132l0.75-.11c5.31-.73,11.87-1,15.68-5S770,117.08,770,112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.1"/>
  </g>
  <g>
    <path d="M773,112v8.09c0,6.89-2.61,13.08-9.7,15.37-1.66.54-3.39,0.91-5.07,1.36L737.33,144" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M739.23,143.35l19.11-6.56c1.65-.43,3.33-0.81,5-1.33,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M741.13,142.69l17.33-5.93c1.61-.42,3.26-0.79,4.84-1.3,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M743,142l15.54-5.31c1.57-.41,3.18-0.77,4.72-1.27,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.01"/>
    <path d="M744.93,141.39c0.15,0,13.6-4.65,13.76-4.69,1.53-.4,3.1-0.75,4.61-1.24,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M746.83,140.74c0.19-.05,11.78-4,12-4.06,1.5-.38,3-0.74,4.49-1.21,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.02"/>
    <path d="M748.73,140.08c0.23-.06,10-3.38,10.19-3.44,1.46-.37,2.94-0.72,4.38-1.18,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M750.63,139.43c0.27-.07,8.14-2.75,8.41-2.82,1.42-.36,2.87-0.7,4.26-1.15,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.03"/>
    <path d="M752.53,138.78c0.31-.08,6.31-2.12,6.62-2.2,1.39-.35,2.79-0.68,4.14-1.12,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M754.43,138.13c0.34-.09,4.49-1.49,4.84-1.57,1.35-.34,2.71-0.67,4-1.09,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.04"/>
    <path d="M756.33,137.47c0.38-.1,2.67-0.85,3.05-1,1.31-.33,2.63-0.65,3.91-1.06,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
    <path d="M758.23,136.82l1.27-.33c1.27-.32,2.56-0.63,3.8-1,7.09-2.29,9.7-8.48,9.7-15.37V112" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.05"/>
  </g>
  <g>
    <path d="M776.38,112c0,10.32,1.14,20.66-5.19,29.6L762,151.75" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0"/>
    <path d="M762.83,150.83c0-.07,8.44-9.37,8.48-9.44,5.74-9.18,5.06-19.15,5.06-29.39" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.08"/>
    <path d="M763.67,149.91c0.1-.14,7.69-8.58,7.78-8.72,5.63-9.1,4.93-19,4.93-29.18" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.16"/>
    <path d="M764.5,149c0.15-.21,6.95-7.8,7.08-8,5.53-9,4.79-18.89,4.79-29" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.25"/>
    <path d="M765.34,148.06c0.2-.28,6.21-7,6.38-7.3,5.42-8.94,4.66-18.76,4.66-28.76" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.33"/>
    <path d="M766.17,147.14c0.25-.35,5.46-6.24,5.67-6.59,5.31-8.86,4.53-18.63,4.53-28.55" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.41"/>
    <path d="M767,146.22c0.29-.42,4.72-5.46,5-5.88,5.21-8.78,4.39-18.5,4.39-28.34" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.49"/>
    <path d="M767.84,145.29c0.34-.49,4-4.67,4.27-5.17,5.1-8.7,4.26-18.37,4.26-28.13" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.57"/>
    <path d="M768.68,144.37c0.39-.55,3.24-3.89,3.57-4.45,5-8.62,4.13-18.24,4.13-27.92" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.65"/>
    <path d="M769.51,143.45c0.44-.62,2.5-3.11,2.87-3.74,4.89-8.54,4-18.11,4-27.71" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.74"/>
    <path d="M770.35,142.53c0.49-.69,1.76-2.32,2.17-3,4.79-8.46,3.86-18,3.86-27.5" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.82"/>
    <path d="M771.18,141.6a25.6,25.6,0,0,0,1.46-2.32c4.68-8.39,3.73-17.85,3.73-27.28" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5" opacity="0.9"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="460" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="460" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="460" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="460" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M479.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,484.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(458.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="556" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="556" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="556" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="556" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M575.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,580.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(554.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="652" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="652" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="652" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="652" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M671.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,676.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(650.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g id="_Group_4" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="748" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="748" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="748" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="748" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M767.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,772.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(746.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="180" y="182" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="180" y="182" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M209,213l-1.93-4.94h-6.23L198.94,213h-1.83l6.14-15.61h1.52L210.89,213H209Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(178.25 179.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="276" y="182" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="276" y="182" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M305,213l-1.93-4.94h-6.23L294.94,213h-1.83l6.14-15.61h1.52L306.89,213H305Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(274.25 179.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_5" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="372" y="182" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="372" y="182" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M401,213l-1.93-4.94h-6.23L390.94,213h-1.83l6.14-15.61h1.52L402.89,213H401Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(370.25 179.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_6" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="468" y="182" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="468" y="182" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M497,213l-1.93-4.94h-6.23L486.94,213h-1.83l6.14-15.61h1.52L498.89,213H497Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(466.25 179.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_7" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="484" cy="109.75" r="11.25"/>
      <circle cx="484" cy="109.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M479.88,110.25v-1.31h3.41V105.5h1.34v3.43H488v1.31h-3.41v3.42h-1.34v-3.42h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(471 95.75)" xlink:href="#op-sum"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="676" cy="109.75" r="11.25"/>
      <circle cx="676" cy="109.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M671.88,110.25v-1.31h3.41V105.5h1.34v3.43H680v1.31h-3.41v3.42h-1.34v-3.42h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(663 95.75)" xlink:href="#op-sum"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="772" cy="109.75" r="11.25"/>
      <circle cx="772" cy="109.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M767.88,110.25v-1.31h3.41V105.5h1.34v3.43H776v1.31h-3.41v3.42h-1.34v-3.42h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(759 95.75)" xlink:href="#op-sum"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(167 35.88)" font-size="13" font-family="Open Sans">Network B focuses on different <tspan x="0" y="20">information from network A at </tspan><tspan x="0" y="40">every step.</tspan></text>
  </g>
  <g id="_Group_8" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="580.25" cy="109.75" r="11.25"/>
      <circle cx="580.25" cy="109.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M576.13,110.25v-1.31h3.41V105.5h1.34v3.43h3.41v1.31h-3.41v3.42h-1.34v-3.42h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(567.25 95.75)" xlink:href="#op-sum"/>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="287" y1="135" x2="287" y2="134" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="287" y1="131.97" x2="287" y2="68.02" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.03 2.03"/>
      <line x1="287" y1="67" x2="287" y2="66" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
</svg>
</figure>

<p>The attention distribution is usually generated with content-based attention. The attending RNN generates a query describing what it wants to focus on. Each item is dot producted with the query to produce a score, describing how well it matches the query. The scores are fed into a softmax to create the attention distribution.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="438" viewBox="0 0 984 438">
  <defs>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-b" data-name="rnn-b" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-15" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M19.83,16.21h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25,6,6,0,0,1-3.94,1.17H19.83V16.21Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58H21.64v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68H21.64Z" fill="#666"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
    <symbol id="op-dot" data-name="op-dot" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M14.46,12.51a2.33,2.33,0,0,1-.67,1.71,2.3,2.3,0,0,1-1.7.68,2.3,2.3,0,0,1-1.7-.68,2.32,2.32,0,0,1-.67-1.71,2.29,2.29,0,0,1,.67-1.7,2.31,2.31,0,0,1,1.7-.67,2.32,2.32,0,0,1,1.7.67A2.29,2.29,0,0,1,14.46,12.51Z" fill="#666"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-14" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="453.56" y="12" width="360.44" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="453.56" y="12" width="360.44" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <line x1="205" y1="366" x2="205" y2="226" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="205" y1="230" x2="205" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M212,330h9.63a9.85,9.85,0,0,0,9.63-10V290" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M492,330l0.58-14c0.23-5.5,4.44-12,9.36-14.46L517,294" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M397,330l0.58-14c0.23-5.5,4.44-12,9.36-14.46L422,294" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M301,330l0.58-14c0.23-5.5,4.44-12,9.36-14.46L326,294" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M205,330l0.58-14c0.23-5.5,4.44-12,9.36-14.46L230,294" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="301" y1="366" x2="301" y2="263" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="301" y1="230" x2="301" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M310,330h9.13c5,0,9.13-4.5,9.13-10V290" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="397" y1="366" x2="397" y2="263" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="397" y1="230" x2="397" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="492" y1="230" x2="492" y2="204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M406,330h9.13c5,0,9.13-4.5,9.13-10V290" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="492" y1="366" x2="492" y2="261" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M496,330h13.25a10,10,0,0,0,10-10V290" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="209" y1="330" x2="297" y2="330" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="305" y1="330" x2="393" y2="330" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="400.67" y1="330" x2="487.67" y2="330" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g>
    <g opacity="0.2">
      <path d="M205,206V170.5a11.11,11.11,0,0,1,10-10.85l358.7-30.53c5.48-.47,10-3.83,10-7.48V115" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.4">
      <path d="M300.5,206V174.29a11.49,11.49,0,0,1,9.94-11.12l266.25-30c5.47-.62,9.94-5,9.94-9.65V115" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <path d="M396.5,206V178.08a12.25,12.25,0,0,1,9.86-11.65l173.4-28.94a12.25,12.25,0,0,0,9.86-11.65V115" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    <g opacity="0.2">
      <path d="M492,206V178.08a14,14,0,0,1,9.63-12.71l81.75-23A14,14,0,0,0,593,129.65V115" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <rect x="168" y="354" width="360.44" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="168" y="354" width="360.44" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="182" y="368" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="182" y="368" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M211,399l-1.93-4.94h-6.23L200.94,399h-1.83l6.14-15.61h1.52L212.89,399H211Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(180.25 365.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="278" y="368" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="278" y="368" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M307,399l-1.93-4.94h-6.23L296.94,399h-1.83l6.14-15.61h1.52L308.89,399H307Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(276.25 365.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="374" y="368" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="374" y="368" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M403,399l-1.93-4.94h-6.23L392.94,399h-1.83l6.14-15.61h1.52L404.89,399H403Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(372.25 365.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_4" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="470" y="368" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="470" y="368" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M499,399l-1.93-4.94h-6.23L488.94,399h-1.83l6.14-15.61h1.52L500.89,399H499Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(468.25 365.25)" xlink:href="#rnn-a"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(168.25 25.88)" font-size="13" font-family="Open Sans">The attending RNN generates a <tspan x="-0.53" y="20">query describing what it wants </tspan><tspan x="-1.06" y="40">to focus on</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(562 223.88)" font-size="13" font-family="Open Sans">Each item is dot producted with the <tspan x="0" y="20">query to produce a score, describing </tspan><tspan x="0" y="40">how well it matches the query. The </tspan><tspan x="0" y="60">scores are fed into a softmax to </tspan><tspan x="0" y="80">create the attention distribution.</tspan></text>
  </g>
  <path d="M201,330H177a10,10,0,0,1-10-10V118a10,10,0,0,1,10-10H529a10,10,0,0,0,10-10V58a10,10,0,0,0-10-10H516.37" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g>
    <line x1="227.92" y1="389.73" x2="265.57" y2="389.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M271,389.73a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,271,389.73Z" fill="#666"/>
  </g>
  <g>
    <line x1="323.92" y1="389.73" x2="361.57" y2="389.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M367,389.73a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,367,389.73Z" fill="#666"/>
  </g>
  <g>
    <line x1="419.92" y1="389.73" x2="457.57" y2="389.73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M463,389.73a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,463,389.73Z" fill="#666"/>
  </g>
  <g>
    <path d="M519,237v-6c0-3.3-3.49-8.84-7.76-12.31l-4-3.27" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M503,212a27.2,27.2,0,0,0,8.67,1.53l-3.9,2.35-1.5,4.3A27.18,27.18,0,0,0,503,212Z" fill="#666"/>
  </g>
  <g>
    <line x1="231.25" y1="282" x2="231.25" y2="267.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M231.25,262a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55L227,269.69A27.17,27.17,0,0,0,231.25,262Z" fill="#666"/>
  </g>
  <g>
    <path d="M423,237v-6c0-3.3-3.49-8.84-7.76-12.31l-4-3.27" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M407,212a27.2,27.2,0,0,0,8.67,1.53l-3.9,2.35-1.5,4.3A27.18,27.18,0,0,0,407,212Z" fill="#666"/>
  </g>
  <g>
    <line x1="327.25" y1="282" x2="327.25" y2="267.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M327.25,262a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55L323,269.69A27.17,27.17,0,0,0,327.25,262Z" fill="#666"/>
  </g>
  <g>
    <path d="M327,237v-6c0-3.3-3.49-8.84-7.76-12.31l-4-3.27" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M311,212a27.2,27.2,0,0,0,8.67,1.53l-3.9,2.35-1.5,4.3A27.18,27.18,0,0,0,311,212Z" fill="#666"/>
  </g>
  <g>
    <line x1="423.25" y1="282" x2="423.25" y2="267.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M423.25,262a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55L419,269.69A27.17,27.17,0,0,0,423.25,262Z" fill="#666"/>
  </g>
  <g>
    <path d="M231,237v-6c0-3.3-3.49-8.84-7.76-12.31l-4-3.27" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M215,212a27.2,27.2,0,0,0,8.67,1.53l-3.9,2.35-1.5,4.3A27.18,27.18,0,0,0,215,212Z" fill="#666"/>
  </g>
  <g>
    <line x1="519.25" y1="282" x2="519.25" y2="267.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M519.25,262a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55L515,269.69A27.17,27.17,0,0,0,519.25,262Z" fill="#666"/>
  </g>
  <g>
    <line x1="513.92" y1="48" x2="551.57" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M557,48a27.2,27.2,0,0,0-7.69,4.28L550.86,48l-1.55-4.28A27.18,27.18,0,0,0,557,48Z" fill="#666"/>
  </g>
  <g>
    <line x1="610.92" y1="48" x2="648.57" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M654,48a27.2,27.2,0,0,0-7.69,4.28L647.86,48l-1.55-4.28A27.18,27.18,0,0,0,654,48Z" fill="#666"/>
  </g>
  <g>
    <line x1="705.92" y1="48" x2="743.57" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M749,48a27.2,27.2,0,0,0-7.69,4.28L742.86,48l-1.55-4.28A27.18,27.18,0,0,0,749,48Z" fill="#666"/>
  </g>
  <g>
    <line x1="587" y1="108.81" x2="587" y2="82.08" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M587,76.65a27.2,27.2,0,0,0,4.28,7.69L587,82.79l-4.28,1.55A27.18,27.18,0,0,0,587,76.65Z" fill="#666"/>
  </g>
  <g id="_Group_5" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="467" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="467" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="467" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="467" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M486.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,491.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(465.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g id="_Group_6" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="563" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="563" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="563" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="563" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M582.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,587.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(561.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="659" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="659" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="659" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="659" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M678.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,683.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(657.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g id="_Group_7" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="755" y="26" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="755" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="755" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="755" y="26" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M774.08,41.46h4.39a8.29,8.29,0,0,1,4.48.92,3.27,3.27,0,0,1,1.38,2.92,3.38,3.38,0,0,1-.77,2.28,3.72,3.72,0,0,1-2.25,1.16v0.11q3.54,0.6,3.54,3.72a4,4,0,0,1-1.41,3.25A6,6,0,0,1,779.5,57h-5.42V41.46Zm1.81,6.66h3a4.85,4.85,0,0,0,2.75-.6,2.32,2.32,0,0,0,.84-2,2,2,0,0,0-.94-1.89,5.84,5.84,0,0,0-3-.58h-2.66v5.09Zm0,1.53v5.82h3.24a4.62,4.62,0,0,0,2.83-.73,2.69,2.69,0,0,0,1-2.28,2.42,2.42,0,0,0-1-2.13,5.2,5.2,0,0,0-3-.68h-3.09Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(753.25 23.25)" xlink:href="#rnn-b"/>
  </g>
  <g id="_Group_8" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="588.75" cy="109.25" r="11.25"/>
      <circle cx="588.75" cy="109.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M584.63,109.75v-1.31H588V105h1.34v3.43h3.41v1.31h-3.41v3.42H588v-3.42h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(575.75 95.25)" xlink:href="#op-sum"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="216" y="236" width="322.72" height="24" rx="12" ry="12"/>
      <rect x="216" y="236" width="322.72" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.4"/>
    </g>
    <g>
      <rect x="215" y="234" width="322.72" height="24" rx="12" ry="12" fill="#e0cef5"/>
      <rect x="215" y="234" width="322.72" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.4"/>
    </g>
  </g>
  <g>
    <path d="M339.86,248.3a1.55,1.55,0,0,1-.63,1.33,3,3,0,0,1-1.82.46,4.28,4.28,0,0,1-1.91-.36v-1.09a4.68,4.68,0,0,0,1.95.48q1.17,0,1.17-.7a0.56,0.56,0,0,0-.13-0.38,1.54,1.54,0,0,0-.42-0.31,7.4,7.4,0,0,0-.82-0.37,3.79,3.79,0,0,1-1.39-.79,1.47,1.47,0,0,1-.36-1,1.35,1.35,0,0,1,.62-1.18,2.92,2.92,0,0,1,1.67-.42,4.75,4.75,0,0,1,2,.42l-0.41,1a4.39,4.39,0,0,0-1.62-.4q-1,0-1,.57a0.57,0.57,0,0,0,.26.47,5.73,5.73,0,0,0,1.14.53,5.19,5.19,0,0,1,1.07.52,1.55,1.55,0,0,1,.49.54A1.58,1.58,0,0,1,339.86,248.3Z" fill="#666"/>
    <path d="M346.49,247a3.24,3.24,0,0,1-.75,2.27,2.68,2.68,0,0,1-2.08.82,2.85,2.85,0,0,1-1.47-.38,2.48,2.48,0,0,1-1-1.08,3.68,3.68,0,0,1-.34-1.63,3.22,3.22,0,0,1,.74-2.26,2.69,2.69,0,0,1,2.09-.81,2.62,2.62,0,0,1,2,.83A3.2,3.2,0,0,1,346.49,247Zm-4.32,0q0,2.06,1.52,2.06t1.5-2.06q0-2-1.51-2a1.29,1.29,0,0,0-1.15.53A2.67,2.67,0,0,0,342.17,247Z" fill="#666"/>
    <path d="M350.92,245h-1.45v5H348.2v-5h-1v-0.59l1-.39v-0.39a2.16,2.16,0,0,1,.49-1.56,2,2,0,0,1,1.51-.51,4,4,0,0,1,1.31.22l-0.33,1a2.9,2.9,0,0,0-.89-0.15,0.73,0.73,0,0,0-.63.27,1.34,1.34,0,0,0-.2.8v0.39h1.45v1Z" fill="#666"/>
    <path d="M354.14,249.08a3.07,3.07,0,0,0,.92-0.15v1a2.61,2.61,0,0,1-.54.15,3.73,3.73,0,0,1-.68.06,1.63,1.63,0,0,1-1.79-1.89V245h-0.81v-0.56l0.87-.46,0.43-1.26h0.78v1.32H355v1h-1.69v3.18a0.89,0.89,0,0,0,.23.67A0.83,0.83,0,0,0,354.14,249.08Z" fill="#666"/>
    <path d="M361.26,250H360v-3.66a1.66,1.66,0,0,0-.26-1,1,1,0,0,0-.81-0.34,1.23,1.23,0,0,0-1.07.48,2.78,2.78,0,0,0-.34,1.58v3h-1.26v-5.94h1l0.18,0.78h0.06a1.65,1.65,0,0,1,.72-0.66,2.32,2.32,0,0,1,1-.23,1.81,1.81,0,0,1,1.82.93h0.09a1.8,1.8,0,0,1,.74-0.69,2.35,2.35,0,0,1,1.1-.25,2,2,0,0,1,1.55.54,2.38,2.38,0,0,1,.49,1.64V250h-1.26v-3.66a1.65,1.65,0,0,0-.26-1,1,1,0,0,0-.81-0.34,1.25,1.25,0,0,0-1.08.46,2.37,2.37,0,0,0-.34,1.41V250Z" fill="#666"/>
    <path d="M370.49,250l-0.25-.83h0a2.44,2.44,0,0,1-.86.74,2.73,2.73,0,0,1-1.12.2,1.9,1.9,0,0,1-1.37-.47,1.77,1.77,0,0,1-.49-1.34,1.57,1.57,0,0,1,.68-1.39,3.93,3.93,0,0,1,2.08-.51l1,0V246a1.2,1.2,0,0,0-.27-0.85,1.08,1.08,0,0,0-.82-0.28,2.87,2.87,0,0,0-.88.13,6.61,6.61,0,0,0-.81.32l-0.41-.9a4.33,4.33,0,0,1,1.06-.38,4.86,4.86,0,0,1,1.08-.13,2.57,2.57,0,0,1,1.71.49,1.93,1.93,0,0,1,.58,1.55v4h-0.9Zm-1.88-.86a1.56,1.56,0,0,0,1.1-.38,1.39,1.39,0,0,0,.42-1.08v-0.52l-0.76,0a2.62,2.62,0,0,0-1.3.3,0.91,0.91,0,0,0-.41.81,0.79,0.79,0,0,0,.24.62A1,1,0,0,0,368.61,249.13Z" fill="#666"/>
    <path d="M374.47,247l-2-2.91h1.44l1.35,2.08,1.36-2.08h1.43l-2,2.91,2.1,3h-1.43l-1.47-2.22L373.81,250h-1.43Z" fill="#666"/>
  </g>
  <g id="_Group_9" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="233" cy="296" r="11.25"/>
      <circle cx="233" cy="296" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M235.46,296.51a2.33,2.33,0,0,1-.67,1.71,2.48,2.48,0,0,1-3.41,0,2.32,2.32,0,0,1-.67-1.71,2.29,2.29,0,0,1,.67-1.7A2.37,2.37,0,0,1,235.46,296.51Z"/>
    </g>
    <use width="24" height="24" transform="translate(220 282)" xlink:href="#op-dot"/>
  </g>
  <g id="_Group_10" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="425" cy="296" r="11.25"/>
      <circle cx="425" cy="296" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M427.46,296.51a2.33,2.33,0,0,1-.67,1.71,2.48,2.48,0,0,1-3.41,0,2.32,2.32,0,0,1-.67-1.71,2.29,2.29,0,0,1,.67-1.7A2.37,2.37,0,0,1,427.46,296.51Z"/>
    </g>
    <use width="24" height="24" transform="translate(412 282)" xlink:href="#op-dot"/>
  </g>
  <g id="_Group_11" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="521" cy="296" r="11.25"/>
      <circle cx="521" cy="296" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M523.46,296.51a2.33,2.33,0,0,1-.67,1.71,2.48,2.48,0,0,1-3.41,0,2.32,2.32,0,0,1-.67-1.71,2.29,2.29,0,0,1,.67-1.7A2.37,2.37,0,0,1,523.46,296.51Z"/>
    </g>
    <use width="24" height="24" transform="translate(508 282)" xlink:href="#op-dot"/>
  </g>
  <g id="_Group_12" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="329" cy="296" r="11.25"/>
      <circle cx="329" cy="296" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M331.46,296.51a2.33,2.33,0,0,1-.67,1.71,2.48,2.48,0,0,1-3.41,0,2.32,2.32,0,0,1-.67-1.71,2.29,2.29,0,0,1,.67-1.7A2.37,2.37,0,0,1,331.46,296.51Z"/>
    </g>
    <use width="24" height="24" transform="translate(316 282)" xlink:href="#op-dot"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="205" cy="205.25" r="11.25"/>
      <circle cx="205" cy="205.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M202.16,208.53l-1-1,2.56-2.56-2.58-2.58,1-1,2.58,2.58,2.56-2.56,1,1L205.72,205l2.57,2.57-1,1L204.72,206Z"/>
    </g>
    <use width="24" height="24" transform="translate(192 191.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="301" cy="205.25" r="11.25"/>
      <circle cx="301" cy="205.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M298.16,208.53l-1-1,2.56-2.56-2.58-2.58,1-1,2.58,2.58,2.56-2.56,1,1L301.72,205l2.57,2.57-1,1L300.72,206Z"/>
    </g>
    <use width="24" height="24" transform="translate(288 191.25)" xlink:href="#op-x"/>
  </g>
  <g id="_Group_13" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="397" cy="205.25" r="11.25"/>
      <circle cx="397" cy="205.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M394.16,208.53l-1-1,2.56-2.56-2.58-2.58,1-1,2.58,2.58,2.56-2.56,1,1L397.72,205l2.57,2.57-1,1L396.72,206Z"/>
    </g>
    <use width="24" height="24" transform="translate(384 191.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="493" cy="205.25" r="11.25"/>
      <circle cx="493" cy="205.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M490.16,208.53l-1-1,2.56-2.56-2.58-2.58,1-1,2.58,2.58,2.56-2.56,1,1L493.72,205l2.57,2.57-1,1L492.72,206Z"/>
    </g>
    <use width="24" height="24" transform="translate(480 191.25)" xlink:href="#op-x"/>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="222" y1="72" x2="222" y2="73" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="222" y1="75" x2="222" y2="106" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2 2"/>
      <line x1="222" y1="107" x2="222" y2="108" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
</svg>
</figure>

<p>One use of attention between RNNs is translation (<a href="https://arxiv.org/pdf/1409.0473.pdf">Bahdanau, <em>et al.</em> 2014</a>). A traditional sequence-to-sequence model has to boil the entire input down into a single vector and then expands it back out. Attention avoids this by allowing the RNN processing the input to pass along information about each word it sees, and then for the RNN generating the output to focus on words as they become relevant.</p>
<p>
<figure id="attentional-ex2" class="w-page">
  <div id="attentional-ex2-data" style="display: none;">0.50, 0.02, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.01, 0.00, 0.00, 0.00, 0.05, 0.05
0.14, 0.89, 0.07, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.06, 0.00, 0.00, 0.00, 0.02, 0.00
0.02, 0.00, 0.56, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.00, 0.02, 0.00
0.00, 0.00, 0.01, 0.61, 0.02, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00
0.00, 0.00, 0.02, 0.03, 0.01, 0.21, 0.97, 0.05, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00
0.00, 0.00, 0.02, 0.07, 0.25, 0.76, 0.02, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.02, 0.00
0.02, 0.04, 0.03, 0.27, 0.71, 0.02, 0.00, 0.02, 0.00, 0.00, 0.02, 0.00, 0.00, 0.05, 0.01
0.02, 0.00, 0.07, 0.00, 0.00, 0.00, 0.00, 0.60, 0.40, 0.01, 0.04, 0.00, 0.00, 0.13, 0.01
0.13, 0.02, 0.02, 0.00, 0.01, 0.00, 0.00, 0.23, 0.52, 0.91, 0.07, 0.00, 0.00, 0.10, 0.00
0.04, 0.00, 0.01, 0.00, 0.00, 0.00, 0.00, 0.01, 0.03, 0.00, 0.67, 0.00, 0.00, 0.16, 0.02
0.02, 0.00, 0.04, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.14, 0.96, 0.00, 0.02, 0.07
0.02, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.02, 0.02, 1.00, 0.02, 0.03
0.02, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.01, 0.00, 0.00, 0.32, 0.11
0.04, 0.00, 0.08, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.01, 0.00, 0.00, 0.04, 0.67
</div>
  <svg>
    <defs>
      <marker id="edgeArrowhead" viewBox="0 -5 10 10" markerWidth="6" markerHeight="10" orient="auto" refX="5" refY="0">
        <path d="M0,-5L5,0L0,5" fill="none" stroke="#666"/>
      </marker>
      <marker id="edgeArrowheadLeft" viewBox="0 -5 10 10" markerWidth="6" markerHeight="10" orient="auto" refX="0" refY="0">
        <path d="M5,-5L0,0L5,5" fill="none" stroke="#666"/>
      </marker>
    </defs>
    <g class="labels" style="display: none;">
      <text transform="translate(0, 20)">output text</text>
      <text transform="translate(0, 65)">network B</text>
      <text transform="translate(0, 185)">network A</text>
      <text transform="translate(0, 233)">input text</text>
    </g>
  </svg>
  <figcaption>Diagram derived from Fig. 3 of <a href="https://arxiv.org/pdf/1409.0473.pdf">Bahdanau, <i>et al.</i> 2014</a></figcaption>
</figure>

<style>
  #attentional-ex2 svg {
  width: 100%;
  height: 240px;
  margin-bottom: 24px;
}
#attentional-ex2 figcaption {
  text-align: center;
}
#attentional-ex2 svg .labels {
  font-size: 12px;
  fill-opacity: 0.5;
}
#attentional-ex2 .background {
  fill: rgb(240, 240, 245);
  fill-opacity: 0.8;
}
#attentional-ex2 .cell .node {
  fill: white;
  fill-opacity: 0.9;
  stroke: black;
  stroke-width: 1px;
  stroke-opacity: 0.25;
  /*transition: stroke-opacity, 0.2s, linear;*/
}
#attentional-ex2 .cell:hover .node {
  stroke-opacity: 1;
}
#attentional-ex2 .cell .shadow {
  fill: black;
  fill-opacity: 0.07;
}
#attentional-ex2 .cell text {
  font-size: 13px;
  fill-opacity: 0.6;
  text-anchor: middle;
  alignment-baseline: middle;
}
#attentional-ex2 .cell text.label {
  font-size: 13px;
  /*fill-opacity: 0.9;*/
  text-anchor: middle;
  alignment-baseline: middle;
}
#attentional-ex2 .link-group {
  transition: opacity, 0.3s, linear;
}
#attentional-ex2 .link-group .node-highlight {
  transition: stroke-opacity, 0.3s, linear;
  stroke: black;
  stroke-opacity: 0;
  fill: none;
}
#attentional-ex2 .link-group:hover .node-highlight {
  stroke-opacity: 1;
}
#attentional-ex2 .link {
  fill: none;
  stroke: rgb(131, 89, 178);
  stroke-width: 2px;
  pointer-events: none;
}
#attentional-ex2 .arrow {
  stroke: black;
  stroke-opacity: 0.6;
}
#attentional-ex2 .cell:last-child .arrow:first-of-type {
  display: none;
}
</style>

<script>
(function() {

var labelsA = [
  "the",
  "agreement",
  "on",
  "the",
  "European",
  "Economic",
  "Area",
  "was",
  "signed",
  "in",
  "August",
  "1992",
  ".",
  "<end>"
];

var labelsB = [
  "l’",
  "accord",
  "sur",
  "la",
  "zone",
  "économique",
  "européenne",
  "a",
  "été",
  "signé",
  "en",
  "août",
  "1992",
  ".",
  "<end>"
];

var data = d3.csvParseRows(d3.select("#attentional-ex2-data").text());

var linkData = [];
data.forEach(function(a, ai) {
  a.forEach(function(b, bi) {
    linkData.push({
      ai: ai,
      bi: bi,
      v: data[ai][bi]
    });
  });
});

var nodeMargin = 10;
var networkMargin = 120;

var html = d3.select("#attentional-ex2");
var outerWidth = html.node().getBoundingClientRect().width;
var outerHeight = html.node().getBoundingClientRect().height;
var margin = {top: 36, right: nodeMargin, bottom: 24, left: nodeMargin};
var width = outerWidth - margin.left - margin.right;
var height = outerHeight - margin.top - margin.bottom;

var xa = d3.scaleBand()
    .domain(d3.range(labelsA.length))
    .paddingInner(0.5)
    .range([nodeMargin, width - nodeMargin]);

var xb = d3.scaleBand()
    .domain(d3.range(labelsB.length))
    .paddingInner(0.5)
    .range([nodeMargin, width - nodeMargin]);

var nodeSizeA = xa.bandwidth();
var nodeSizeB = xb.bandwidth();

var networkHeightA = nodeSizeA + nodeMargin * 2;
var networkHeightB = nodeSizeB + nodeMargin * 2;

var link = function(d) {
  return "M" + (xb(d.bi) + nodeSizeB / 2) + "," + (nodeSizeB + nodeMargin)
      + "C" + (xb(d.bi) + nodeSizeB / 2) + "," + (nodeSizeB + networkMargin / 3 + nodeMargin)
      + " " + (xa(d.ai) + nodeSizeA / 2) + "," + (networkMargin - networkMargin / 3 + nodeMargin)
      + " " + (xa(d.ai) + nodeSizeA / 2) + "," + (networkMargin + nodeMargin);
};

html.select("svg .labels")
    .attr("transform", "translate(" + (width + nodeMargin * 3) + ", 0)");

var svg = html.select("svg")
    .attr("width", outerWidth)
    .attr("height", outerHeight)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var networkA = svg.append("g")
    .attr("transform", "translate(0, " + networkMargin + ")");

networkA.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", nodeSizeA + 2 * nodeMargin)
    .attr("rx", nodeMargin * 0.7)
    .attr("ry", nodeMargin * 0.7);

var cellA = networkA.selectAll(".cell")
    .data(labelsA)
  .enter().append("g")
    .attr("class", "cell")
    .attr("transform", function(d, i) { return "translate(" + xa(i) + ", " + nodeMargin + ")"; })
    .on("mouseover", function(d, i) {
      link.style("display", function(ld) {
        return ld.ai === i ? "" : "none";
      });
    })
    .on("mouseout", function() { link.style("display", ""); });

cellA.append("rect")
    .attr("class", "shadow")
    .attr("transform", "translate(1, 3)")
    .attr("width", nodeSizeA)
    .attr("height", nodeSizeA)
    .attr("rx", 4)
    .attr("ry", 4);

cellA.append("rect")
    .attr("class", "node")
    .attr("width", nodeSizeA)
    .attr("height", nodeSizeA)
    .attr("rx", 4)
    .attr("ry", 4);

cellA.append("line")
    .attr("class", "arrow")
    .attr("marker-start", "url(#edgeArrowheadLeft)")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("x1", nodeSizeA + 8)
    .attr("x2", nodeSizeA + nodeMargin + 20)
    .attr("y1", nodeSizeA / 2)
    .attr("y2", nodeSizeA / 2);

cellA.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("transform", "translate(" + nodeSizeA / 2 + ", 0)")
    .attr("y1", nodeSizeA + nodeMargin * 2 - 2)
    .attr("y2", nodeSizeA + 4);

cellA.append("text")
    .style("opacity", 0.8)
    .text("A")
    .attr("dx", nodeSizeA / 2)
    .attr("dy", nodeSizeA / 2 + 1);

cellA.append("text")
    .attr("class", "label")
    .attr("dx", nodeSizeA / 2)
    .attr("dy", nodeSizeA + 24 + 8)
    .text(function(d) { return d; });

cellA.append("rect")
    .style("opacity", 0)
    .attr("transform", "translate(-" + ((xa.step() - nodeSizeA) / 2) + ",-" + (nodeMargin + (networkMargin - networkHeightB) / 2) + ")")
    .attr("width", xa.step())
    .attr("height", networkHeightA + (networkMargin - networkHeightA) / 2);

//
// Network B
//

var networkB = svg.append("g");

networkB.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", nodeSizeB + 2 * nodeMargin)
    .attr("rx", nodeMargin * 0.7)
    .attr("ry", nodeMargin * 0.7);

var cellB = networkB.selectAll(".cell")
    .data(labelsB)
  .enter().append("g")
    .attr("class", "cell")
    .attr("transform", function(d, i) { return "translate(" + xb(i) + "," + nodeMargin + ")"; })
    .on("mouseover", function(d, i) {
      link.style("display", function(ld) {
        return ld.bi === i ? "" : "none";
      });
    })
    .on("mouseout", function() { link.style("display", ""); });

cellB.append("rect")
    .attr("class", "shadow")
    .attr("transform", "translate(1, 3)")
    .attr("width", nodeSizeB)
    .attr("height", nodeSizeB)
    .attr("rx", 4)
    .attr("ry", 4);

cellB.append("rect")
    .attr("class", "node")
    .attr("width", nodeSizeB)
    .attr("height", nodeSizeB)
    .attr("rx", 4)
    .attr("ry", 4);

cellB.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("x1", nodeSizeB)
    .attr("x2", nodeSizeB + nodeMargin + 14)
    .attr("y1", nodeSizeB / 2)
    .attr("y2", nodeSizeB / 2);

cellB.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("transform", "translate(" + nodeSizeB / 2 + ", 0)")
    .attr("y1", 0)
    .attr("y2", -nodeMargin * 2 + 5);

cellB.append("text")
    .style("opacity", 0.8)
    .text("B")
    .attr("dx", nodeSizeB / 2)
    .attr("dy", nodeSizeB / 2 + 1);

cellB.append("text")
    .attr("class", "label")
    .attr("dx", function(d) { return d === "européenne" ? nodeSizeB / 2 + 15 : nodeSizeB / 2; })
    .attr("dy", - 24 - 5)
    .text(function(d) { return d; });

cellB.append("rect")
    .style("opacity", 0)
    .attr("transform", "translate(-" + ((xb.step() - nodeSizeB) / 2) + ",-" + nodeMargin + ")")
    .attr("width", xb.step())
    .attr("height", networkHeightB + (networkMargin - networkHeightB) / 2);
//
// Links
//
var linkGroup = svg.append("g").attr("class", ".link-group")

var link = linkGroup.selectAll(".link")
    .data(linkData)
  .enter().append("path")
    .attr("class", "link")
    .attr("d", link)
    .style("opacity", function(d) { return d.v; });
//
//
//
// var hoverB = svg.selectAll(".hover-b")
//     .data(labelsB)
//   .enter().append("rect")
//     .attr("class", "hover-b")
//     .style("opacity", 0)
//     .attr("transform", function(d, i) { return "translate(" + (xb(i) - xb.step() / 4) + ", 0)"; })
//     .attr("width", xb.step())
//     .attr("height", networkMargin / 2 + nodeSizeB)


})();</script>
</p>
<p>This kind of attention between RNNs has a number of other applications. It can be used in voice recognition (<a href="https://arxiv.org/pdf/1508.01211.pdf">Chan, <em>et al.</em> 2015</a>), allowing one RNN process the audio and then have another RNN skim over it, focusing on relevant parts as it generates a transcript.</p>
<p>
<figure id="attentional-ex3" class="w-page">
  <svg>
    <g class="labels">
      <text transform="translate(0, 18)">output text</text>
      <text transform="translate(0, 55)">network B</text>
      <text transform="translate(0, 195)">network A</text>
      <text transform="translate(0, 250)">input audio</text>
    </g>
  </svg>
  <div id="attentional-ex3-data" style="display: none;">0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.09, 0.11, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.78, 0.33, 0.04, 0.02, 0.02, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.05, 0.61, 0.37, 0.78, 0.07, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.05, 0.21, 0.07, 0.74, 0.31, 0.00, 0.01, 0.01, 0.01, 0.02, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.04, 0.02, 0.02, 0.47, 0.98, 0.02, 0.01, 0.01, 0.02, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.96, 0.98, 0.28, 0.02, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.02, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.40, 0.49, 0.61, 0.30, 0.02, 0.02, 0.01, 0.01, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.05, 0.07, 0.09, 0.18, 0.96, 0.89, 0.87, 0.54, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.02, 0.10, 0.05, 0.13, 0.01, 0.03, 0.05, 0.10, 0.14, 0.32, 0.13, 0.01, 0.02, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.12, 0.60, 0.04, 0.03, 0.02, 0.02, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.05, 0.41, 0.66, 0.02, 0.02, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.94, 0.72, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, 0.76, 0.02, 0.01, 0.01, 0.01, 0.01, 0.02, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.77, 0.45, 0.66, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.04, 0.01, 0.00, 0.02, 0.13, 0.98, 0.97, 0.02, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.09, 0.00, 0.01, 0.01, 0.01, 0.02, 0.90, 0.02, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.08, 0.10, 0.01, 0.01, 0.01, 0.03, 0.96, 0.19, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.13, 0.02, 0.01, 0.01, 0.01, 0.01, 0.60, 0.18
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.02, 0.60
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.02
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.02, 0.02, 0.02, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.00, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01
</div>
  <img src="assets/rnn-attention-waveform-bw.png">
  <figcaption>Figure derived from <a href="https://arxiv.org/pdf/1508.01211.pdf">Chan, <i>et al.</i> 2015</a></figcaption>
</figure>

<style>
#attentional-ex3 {
  position: relative;
}
#attentional-ex3 img {
  position: absolute;
  opacity: 0.7;
}
#attentional-ex3 svg {
  z-index: 1;
  position: relative;
  width: 100%;
  height: 280px;
  margin-bottom: 24px;
}
#attentional-ex3 svg .labels {
  font-size: 12px;
  fill-opacity: 0.5;
}
#attentional-ex3 figcaption {
  text-align: center;
}
#attentional-ex3 .background {
  fill: rgb(240, 240, 245);
  fill-opacity: 0.8;
}
#attentional-ex3 .audio-background {
  fill: none;
  stroke: black;
  stroke-opacity: 0.3;
}
#attentional-ex3 .cell .node {
  fill: white;
  fill-opacity: 0.9;
  stroke: black;
  stroke-width: 1px;
  stroke-opacity: 0.15;
}
#attentional-ex3 .cell:hover .node {
  stroke-opacity: 1;
}
#attentional-ex3 .cell .shadow {
  fill: black;
  fill-opacity: 0.07;
}
#attentional-ex3 .cell text {
  font-size: 13px;
  fill-opacity: 0.5;
  text-anchor: middle;
  alignment-baseline: middle;
}
#attentional-ex3 .cell text.label {
  font-size: 15px;
  /*fill-opacity: 0.8;*/
  text-anchor: middle;
  alignment-baseline: middle;
}
#attentional-ex3 .cell:last-child text.label {
  font-size: 10px;
}
#attentional-ex3 .link-group {
  transition: opacity, 0.3s, linear;
}
#attentional-ex3 .link-group .node-highlight {
  transition: stroke-opacity, 0.3s, linear;
  stroke: black;
  stroke-opacity: 0;
  fill: none;
}
#attentional-ex3 .link-group:hover .node-highlight {
  stroke-opacity: 1;
}
#attentional-ex3 .link {
  fill: none;
  stroke: rgb(131, 89, 178);
  stroke-width: 2px;
  pointer-events: none;
}
#attentional-ex3 .arrow {
  stroke: black;
  stroke-opacity: 0.3;
}
#attentional-ex3 .cell:last-child .arrow:first-of-type {
  display: none;
}
#attentional-ex3 .tick {
  stroke: black;
  stroke-opacity: 0.2;
}
</style>

<script>
(function() {

var data = d3.csvParseRows(d3.select("#attentional-ex3-data").text());
var labelsB = ["h","o","w","_","m","u","c","h","_","w","o","u","l","d","_","a","_","w","o","o","d","c","h","u","c","k","_","c","h","u","c","k","<end>"];
var labelsA = d3.range(data.length);

var linkData = [];
data.forEach(function(a, ai) {
  a.forEach(function(b, bi) {
    linkData.push({
      ai: ai,
      bi: bi,
      v: data[ai][bi]
    });
  });
});

var nodeMargin = 8;
var networkMargin = 140;
var audioHeight = 60;

var html = d3.select("#attentional-ex3");
var outerWidth = html.node().getBoundingClientRect().width;
var outerHeight = html.node().getBoundingClientRect().height;
var margin = {top: 36, right: nodeMargin + 80, bottom: 24, left: nodeMargin};
var width = outerWidth - margin.left - margin.right;
var height = outerHeight - margin.top - margin.bottom;

var xa = d3.scaleBand()
    .domain(d3.range(labelsA.length))
    .paddingInner(0.5)
    .range([nodeMargin, width - nodeMargin]);

var xb = d3.scaleBand()
    .domain(d3.range(labelsB.length))
    .paddingInner(0.5)
    .range([nodeMargin, width - nodeMargin]);

var nodeSizeA = xa.bandwidth();
var nodeSizeB = xb.bandwidth();

var networkHeightA = nodeSizeA + nodeMargin * 2;
var networkHeightB = nodeSizeB + nodeMargin * 2;

var link = function(d) {
  return "M" + (xb(d.bi) + nodeSizeB / 2) + "," + (nodeSizeB + nodeMargin)
      + "C" + (xb(d.bi) + nodeSizeB / 2) + "," + (nodeSizeB + networkMargin / 3 + nodeMargin)
      + " " + (xa(d.ai) + nodeSizeA / 2) + "," + (networkMargin - networkMargin / 3 + nodeMargin)
      + " " + (xa(d.ai) + nodeSizeA / 2) + "," + (networkMargin + nodeMargin);
};

var svg = html.select("svg")
    .attr("width", outerWidth)
    .attr("height", outerHeight)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

html.select("svg .labels")
    .attr("transform", "translate(" + (width + nodeMargin * 3) + ", 0)");

var audio = svg.append("g")
    .attr("class", "audio")
    .attr("transform", "translate(0, " + (nodeMargin * 4 + nodeSizeA + networkMargin) + ")");

//
// Network A
//

var networkA = svg.append("g")
    .attr("transform", "translate(0, " + networkMargin + ")");

networkA.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", nodeSizeA + 2 * nodeMargin)
    .attr("rx", nodeMargin * 0.7)
    .attr("ry", nodeMargin * 0.7);

var cellA = networkA.selectAll(".cell")
    .data(labelsA)
  .enter().append("g")
    .attr("class", "cell")
    .attr("transform", function(d, i) { return "translate(" + xa(i) + ", " + nodeMargin + ")"; })
    .on("mouseover", function(d, i) {
      link.style("display", function(ld) {
        return ld.ai === i ? "" : "none";
      });
    })
    .on("mouseout", function() { link.style("display", ""); });

cellA.append("rect")
    .attr("class", "shadow")
    .attr("transform", "translate(1, 3)")
    .attr("width", nodeSizeA)
    .attr("height", nodeSizeA)
    .attr("rx", 4)
    .attr("ry", 4);

cellA.append("rect")
    .attr("class", "node")
    .attr("width", nodeSizeA)
    .attr("height", nodeSizeA)
    .attr("rx", 2)
    .attr("ry", 2);

cellA.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("x1", nodeSizeA)
    .attr("x2", nodeSizeA + nodeMargin)
    .attr("y1", nodeSizeA / 2)
    .attr("y2", nodeSizeA / 2);

cellA.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("transform", "translate(" + nodeSizeA / 2 + ", " + nodeSizeA + ")")
    .attr("y1",  nodeMargin * 3)
    .attr("y2",  4);

cellA.append("rect")
    .style("opacity", 0)
    .attr("transform", "translate(-" + ((xa.step() - nodeSizeA) / 2) + ",-" + (nodeMargin + (networkMargin - networkHeightB) / 2) + ")")
    .attr("width", xa.step())
    .attr("height", networkHeightA + (networkMargin - networkHeightA) / 2 + audioHeight + nodeMargin * 2);


//
// Network B
//

var networkB = svg.append("g");

networkB.append("rect")
    .attr("class", "background")
    .attr("width", width)
    .attr("height", nodeSizeB + 2 * nodeMargin)
    .attr("rx", nodeMargin * 0.7)
    .attr("ry", nodeMargin * 0.7);

var cellB = networkB.selectAll(".cell")
    .data(labelsB)
  .enter().append("g")
    .attr("class", "cell")
    .attr("transform", function(d, i) { return "translate(" + xb(i) + ", " + nodeMargin + ")"; })
    .on("mouseover", function(d, i) {
      link.style("display", function(ld) {
        return ld.bi === i ? "" : "none";
      });
    })
    .on("mouseout", function() { link.style("display", ""); });

cellB.append("rect")
    .attr("class", "shadow")
    .attr("transform", "translate(1, 3)")
    .attr("width", nodeSizeB)
    .attr("height", nodeSizeB)
    .attr("rx", 4)
    .attr("ry", 4);

cellB.append("rect")
    .attr("class", "node")
    .attr("width", nodeSizeB)
    .attr("height", nodeSizeB)
    .attr("rx", 2)
    .attr("ry", 2);

cellB.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("x1", nodeSizeB)
    .attr("x2", nodeSizeB + nodeMargin)
    .attr("y1", nodeSizeB / 2)
    .attr("y2", nodeSizeB / 2);

cellB.append("line")
    .attr("class", "arrow")
    .attr("marker-end", "url(#edgeArrowhead)")
    .attr("transform", "translate(" + nodeSizeB / 2 + ", 0)")
    .attr("y1", 0)
    .attr("y2", -nodeMargin * 2);

cellB.append("text")
    .attr("class", "label")
    .attr("dx", nodeSizeB / 2)
    .attr("dy", - nodeMargin * 2 - 15)
    .text(function(d) { return d; });

cellB.append("rect")
    .style("opacity", 0)
    .attr("transform", "translate(-" + ((xb.step() - nodeSizeB) / 2) + ",-" + nodeMargin + ")")
    .attr("width", xb.step())
    .attr("height", networkHeightB + (networkMargin - networkHeightB) / 2);
//
// Links
//

var linkGroup = svg.append("g").attr("class", ".link-group")

var link = linkGroup.selectAll(".link")
    .data(linkData)
  .enter().append("path")
    .attr("class", "link")
    .attr("d", link)
    .style("opacity", function(d) { return d.v; });

//
// Audio
//

html.select("img")
    .style("left", margin.left + "px")
    .style("top", margin.top + networkMargin + nodeSizeA + nodeMargin * 4 + "px")
    .style("width", width + "px")
    .style("height", audioHeight + "px")

audio.append("rect")
    .attr("class", "audio-background")
    .attr("width", width)
    .attr("height", audioHeight)
    .attr("rx", nodeMargin * 0.7)
    .attr("ry", nodeMargin * 0.7);

audio.selectAll(".tick")
    .data(labelsA)
  .enter().append("line")
    .style("display", function(d) { return d == 0 ? "none" : ""; })
    .attr("class", "tick")
    .attr("transform", "translate(-" + (xa.step() - xa.bandwidth()) / 2 + ", " + 0 + ")")
    .attr("x1", function(d) { return xa(d); })
    .attr("x2", function(d) { return xa(d); })
    .attr("y2", audioHeight)

audio.selectAll(".segment")
    .data(labelsA)
  .enter().append("rect")
    .style("opacity", 0)
    .attr("class", "segment")
    .attr("transform", function(d) {
      return "translate(" + ((-xa.step() + xa.bandwidth()) / 2 + xa(d)) + ", " + nodeMargin + ")";
    })
    .attr("width", xa.step())
    .attr("height", audioHeight)

})();
</script>
</p>
<p>Other uses of this kind of attention include parsing text (<a href="https://arxiv.org/pdf/1412.7449.pdf">Vinyals, <em>et al.</em>, 2014</a>), where it allows the model to glance at words as it generates the parse tree, and for conversational modeling (<a href="http://arxiv.org/pdf/1506.05869.pdf">Vinyals &amp; Le, 2015</a>), where it lets the model focus on previous parts of the conversation as it generates its response.</p>
<p>Attention can also be used on the interface between a convolutional neural network and an RNN. This allows the RNN to look at different position of an image every step. One popular use of this kind of attention is for image captioning. First, a conv net processes the image, extracting high-level features. Then an RNN runs, generating a description of the image. As it generates each word in the description, the RNN focuses on the conv nets interpretation of the relevant parts of the image. We can explicitly visualize this:</p>
<figure class="w-body-plus external">
  <img src="assets/show-attend-tell.png">
  <figcaption style="bottom: 0px;">Figure from <a href="https://arxiv.org/pdf/1502.03044.pdf">Xu, <em>et al.</em>, 2015</a></figcaption>
</figure>

<p>More broadly, attentional interfaces can be used whenever one wants to interface with a neural network that has a repeating structure in its output.</p>
<p>Attentional interfaces have been found to be an extremely general and powerful technique, and are becoming increasingly widespread.</p>
<hr>
<h2 id="adaptive-computation-time">Adaptive Computation Time</h2>
<p class="equation-mimic">Standard RNNs do the same amount of computation each time step. This seems unintuitive. Surely, one should think more when things are hard? It also limits RNNs to doing <span class="equation-mimic">O(n)</span> operations for a list of length <span class="equation-mimic">n</span>.</p>

<p>Adaptive Computation Time (<a href="https://arxiv.org/pdf/1603.08983v4.pdf">Graves, 2016</a>), is a way for RNNs to different amounts of computation each step. The big picture idea is simple: allow the RNN to do multiple steps of computation for each time step.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="287" viewBox="0 0 984 287">
  <defs>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-5" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <rect x="792" y="63" width="132" height="156" rx="10" ry="10" fill="#f0f0f5"/>
  <path d="M898,87.5H885.5a10,10,0,0,0-10,10v28a10,10,0,0,1-10,10h-1.83" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  <g>
    <line x1="840" y1="231" x2="840" y2="168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M840,163a27.2,27.2,0,0,0,4.28,7.69L840,169.14l-4.28,1.55A27.18,27.18,0,0,0,840,163Z" fill="#666"/>
  </g>
  <g>
    <path d="M900,87.5h32a10.16,10.16,0,0,1,10.11,10l0.29,27.5a10.42,10.42,0,0,0,10.1,10.21l8.57,0.18" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M966.5,135.5a27.2,27.2,0,0,0-7.78,4.12l1.64-4.25-1.46-4.31A27.18,27.18,0,0,0,966.5,135.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M900,87.5h32a10,10,0,0,0,10-10V50.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M942,45a27.2,27.2,0,0,0,4.28,7.69L942,51.14l-4.28,1.55A27.18,27.18,0,0,0,942,45Z" fill="#666"/>
  </g>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="817" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="817" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="817" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="817" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M845.93,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L845,130.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,845.93,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(815.25 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="841.75" cy="190.25" r="11.25"/>
      <circle cx="841.75" cy="190.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M839.63,187.33a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44,3.75,3.75,0,0,1,.74,2.26v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1,3.86,3.86,0,0,1-.9-2.66v-0.09a3.42,3.42,0,0,1,.64-2,2.76,2.76,0,0,1,1.63-1.14v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,839.63,187.33Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.94,1.94,0,0,0,3,0,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,840.05,192.53Z"/>
    </g>
    <use width="24" height="24" transform="translate(828.75 176.25)" xlink:href="#op-sum_2"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="899.75" cy="89.39" r="11.25"/>
      <circle cx="899.75" cy="89.39" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M895.63,89.88V88.57H899V85.14h1.34v3.43h3.41v1.31h-3.41V93.3H899V89.88h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(886.75 75.39)" xlink:href="#op-sum"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(65 15.88)" font-size="13" font-family="Open Sans">For every time step the RNN can <tspan x="0" y="20">do multiple computation steps.</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(335.67 15.88)" font-size="13" font-family="Open Sans">The output is a weighted combination <tspan x="0" y="20">of the computation step outputs</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(639.67 15.88)" font-size="13" font-family="Open Sans">The process is repeated for <tspan x="0" y="20">each time step</tspan></text>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <rect x="468" y="63" width="275.67" height="156" rx="10" ry="10" fill="#f0f0f5"/>
  </g>
  <path d="M707.33,87h-74.5a10,10,0,0,0-10,10v28.5a10,10,0,0,1-10,10h-1.17" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  <g opacity="0.4">
    <path d="M719.33,91h-14.5a10,10,0,0,0-10,10v24.5a10,10,0,0,1-10,10h-1.5" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <g opacity="0.4">
    <path d="M539.33,135.5l2-.34a10.22,10.22,0,0,0,10-10.16V93.5a10.07,10.07,0,0,1,10-10l146-.47" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <g>
    <line x1="515.33" y1="231" x2="515.33" y2="168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M515.33,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,515.33,163Z" fill="#666"/>
  </g>
  <g>
    <path d="M515.33,231V217a10,10,0,0,1,10-10h51.5a10,10,0,0,0,10-10V168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M586.83,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,586.83,163Z" fill="#666"/>
  </g>
  <g>
    <path d="M538.83,207h110.5a10,10,0,0,0,10-10V168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M659.33,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,659.33,163Z" fill="#666"/>
  </g>
  <g>
    <line x1="539.33" y1="135.5" x2="555.9" y2="135.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M561.33,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,561.33,135.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="611.33" y1="135.5" x2="627.9" y2="135.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M633.33,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,633.33,135.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M719.33,87.5h32.5a9.9,9.9,0,0,1,9.9,10l-0.29,28a9.9,9.9,0,0,0,9.9,10H806.4" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M811.83,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,811.83,135.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M719.33,87.5h32.5a10,10,0,0,0,10-10V50.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M761.83,45a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,761.83,45Z" fill="#666"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="517.08" cy="190.25" r="11.25"/>
      <circle cx="517.08" cy="190.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M515,187.33a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26A4.6,4.6,0,0,1,520,190a3.75,3.75,0,0,1,.74,2.26v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1,3.86,3.86,0,0,1-.9-2.66v-0.09a3.42,3.42,0,0,1,.64-2,2.76,2.76,0,0,1,1.63-1.14v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,515,187.33Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.94,1.94,0,0,0,3,0,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,515.39,192.53Z"/>
    </g>
    <use width="24" height="24" transform="translate(504.08 176.25)" xlink:href="#op-sum_2"/>
  </g>
  <g id="_Group_4" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="492.33" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="492.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="492.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="492.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M521.27,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,513,129.3a5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85l-0.56,1.57a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,521.27,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(490.58 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_5" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="564.33" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="564.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="564.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="564.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M593.27,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,585,129.3a5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85l-0.56,1.57a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,593.27,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(562.58 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_6" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="636.33" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="636.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="636.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="636.33" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M665.27,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,657,129.3a5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85l-0.56,1.57a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,665.27,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(634.58 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_7" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="719.58" cy="89.39" r="11.25"/>
      <circle cx="719.58" cy="89.39" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M715.46,89.88V88.57h3.41V85.14h1.34v3.43h3.41v1.31h-3.41V93.3h-1.34V89.88h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(706.58 75.39)" xlink:href="#op-sum"/>
  </g>
  <g id="_Group_8" data-name="&lt;Group&gt;">
    <rect x="66" y="63" width="348" height="156" rx="10" ry="10" fill="#f0f0f5"/>
  </g>
  <g opacity="0.2">
    <path d="M137.67,135.5h1.83a10,10,0,0,0,10-10v-34a10,10,0,0,1,10-10H389" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <g opacity="0.5">
    <path d="M210,135.5h1.5a10,10,0,0,0,10-10v-30a10,10,0,0,1,10-10H389" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <path d="M389,89.5H303.5a10,10,0,0,0-10,10v26a10,10,0,0,1-10,10h-1.17" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  <g opacity="0.2">
    <path d="M389,93.5H375.5a10,10,0,0,0-10,10v22a10,10,0,0,1-10,10h-1.17" fill="none" stroke="#8359b2" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <g>
    <line x1="114" y1="231" x2="114" y2="168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M114,163a27.2,27.2,0,0,0,4.28,7.69L114,169.14l-4.28,1.55A27.18,27.18,0,0,0,114,163Z" fill="#666"/>
  </g>
  <g>
    <path d="M138,207H248.5a10,10,0,0,0,10-10V168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M258.5,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,258.5,163Z" fill="#666"/>
  </g>
  <g>
    <path d="M114,231V217a10,10,0,0,1,10-10H320.5a10,10,0,0,0,10-10V168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M330.5,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,330.5,163Z" fill="#666"/>
  </g>
  <g>
    <line x1="138" y1="135.5" x2="154.57" y2="135.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M160,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,160,135.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="210" y1="135.5" x2="226.57" y2="135.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M232,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,232,135.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="282" y1="135.5" x2="298.57" y2="135.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M304,135.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,304,135.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M390,87.5h32.5a9.9,9.9,0,0,1,9.9,10l-0.29,28a9.9,9.9,0,0,0,9.9,10h36.74" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M484.17,135.5a27.2,27.2,0,0,0-7.69,4.28L478,135.5l-1.55-4.28A27.18,27.18,0,0,0,484.17,135.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M387,87.5h35.5a10,10,0,0,0,10-10V50.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M432.5,45a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,432.5,45Z" fill="#666"/>
  </g>
  <g>
    <path d="M138,207h38.5a10,10,0,0,0,10-10V168.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M186.5,163a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,186.5,163Z" fill="#666"/>
  </g>
  <g id="_Group_9" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="91" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="91" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="91" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="91" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M119.93,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L119,130.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,119.93,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(89.25 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_10" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="163" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="163" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="163" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="163" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M191.93,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L191,130.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,191.93,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(161.25 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_11" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="235" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="235" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="235" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="235" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M263.93,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L263,130.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,263.93,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(233.25 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_12" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="307" y="113" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="307" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="307" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="307" y="113" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M335.93,139.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L335,130.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,335.93,139.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(305.25 110.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_13" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="115.75" cy="190.25" r="11.25"/>
      <circle cx="115.75" cy="190.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M113.63,187.33a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44,3.75,3.75,0,0,1,.74,2.26v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1,3.86,3.86,0,0,1-.9-2.66v-0.09a3.42,3.42,0,0,1,.64-2,2.76,2.76,0,0,1,1.63-1.14v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,113.63,187.33Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.94,1.94,0,0,0,3,0,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,114.05,192.53Z"/>
    </g>
    <use width="24" height="24" transform="translate(102.75 176.25)" xlink:href="#op-sum_2"/>
  </g>
  <g id="_Group_14" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="389.75" cy="89.39" r="11.25"/>
      <circle cx="389.75" cy="89.39" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M385.63,89.88V88.57H389V85.14h1.34v3.43h3.41v1.31h-3.41V93.3H389V89.88h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(376.75 75.39)" xlink:href="#op-sum"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(66 251.14)" font-size="13" font-family="Open Sans">A special bit is set to denote <tspan x="0" y="20">the first computation step</tspan></text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="108" y1="48" x2="108" y2="49" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="108" y1="51.03" x2="108" y2="110.98" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.03 2.03"/>
      <line x1="108" y1="112" x2="108" y2="113" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="105" y1="195" x2="104.29" y2="195.71" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="102.79" y1="197.21" x2="85.46" y2="214.54" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2.13 2.13"/>
      <polyline points="84.71 215.29 84 216 84 217" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="84" y1="218.78" x2="84" y2="232.11" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="1.78 1.78"/>
      <line x1="84" y1="233" x2="84" y2="234" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="388" y1="48" x2="388" y2="49" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="388" y1="51" x2="388" y2="70" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2 2"/>
      <line x1="388" y1="71" x2="388" y2="72" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="647" y1="48" x2="647" y2="49" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="647" y1="51" x2="647" y2="66" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="2 2"/>
      <line x1="647" y1="67" x2="647" y2="68" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
</svg>
</figure>

<p>In order for the network to learn how many steps to do, we want the number of steps to be differentiable. We achieve this with the same trick we used before: instead of deciding to run for a discrete number of steps, we have a attention distribution over the number of steps to run. The output is a weighted combination of the outputs of each step.</p>
<p>There are a few more details, which were left out in the previous diagram. Here’s a complete diagram of a time step with three computation steps.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="264" viewBox="0 0 984 264">
  <defs>
    <symbol id="op-halo" data-name="op-halo" viewBox="0 0 31.45 31.45">
      <circle cx="15.73" cy="15.73" r="14.73" fill="#e6eaf2" stroke="#fff" stroke-miterlimit="10" stroke-width="2"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_5" data-name="op-sum 5" viewBox="0 0 24 24">
      <use id="op-bg-6" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <g>
        <path d="M11,12.65L4.21,15.32V14.26l5.51-2.12L4.21,10V9L11,11.66v1Z" fill="#666"/>
        <path d="M16.34,11.45H15.48q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28H19a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38A2.21,2.21,0,0,1,12,12.79a1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69A1.56,1.56,0,0,1,12.24,9a1.8,1.8,0,0,1,.3-1,2,2,0,0,1,.74-0.69,4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H17.36a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-sum_4" data-name="op-sum 4" viewBox="0 0 24 24">
      <use id="op-bg-9" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.51,11.21h9v1.15h-9V11.21Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_3" data-name="op-sum 3" viewBox="0 0 24 24">
      <use id="op-bg-12" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.65,10V9.21a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23h0.83V16H11.62V10h-2Z" fill="#666"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-15" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-sigma" data-name="rnn-sigma" viewBox="0 0 25.17 25.17">
      <rect x="0.75" y="0.75" width="23.67" height="23.67" rx="6" ry="6" fill="#f0f0f5" stroke="#666" stroke-width="1.5"/>
      <path d="M19,8.67H16.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32,5.73,5.73,0,0,1,1.5-4.07,5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21H19V8.67ZM15.8,12.78a5.89,5.89,0,0,0-.74-2.92,2.87,2.87,0,0,0-2.65-1.41A2.86,2.86,0,0,0,9.8,9.79a5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,2.89,2.89,0,0,0,2.47,1.26A2.88,2.88,0,0,0,15,15.74,5.37,5.37,0,0,0,15.8,12.78Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="168" y="11.89" width="612" height="240" rx="10" ry="10" fill="#f0f0f5"/>
  </g>
  <line x1="348" y1="38.89" x2="348" y2="263.89" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="540" y1="38.89" x2="540" y2="263.89" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="732" y1="38.89" x2="732" y2="263.89" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M240,180h50a10,10,0,0,0,10-10V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M432,180h50a10,10,0,0,0,10-10V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M624,180h50a10,10,0,0,0,10-10V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="456" y1="132" x2="456" y2="73.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="648" y1="132" x2="648" y2="77" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M299.5,95.89V79.39a10,10,0,0,1,10-10H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M491.5,96V83.5a10,10,0,0,1,10-10H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M683.51,94V85.75c0-4.54,4.5-8.25,10-8.25H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="240" y1="47.89" x2="648" y2="47.89" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M612,76.5v9.75A9.91,9.91,0,0,0,622,96h22" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M576,47.89h26c5.5,0,10,3.83,10,8.5v8.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <use id="op-halo-3" data-name="op-halo" width="31.45" height="31.45" transform="translate(332.94 9)" xlink:href="#op-halo"/>
  <use id="op-halo-6" data-name="op-halo" width="31.45" height="31.45" transform="translate(524.94 9)" xlink:href="#op-halo"/>
  <use id="op-halo-9" data-name="op-halo" width="31.45" height="31.45" transform="translate(716.94 9)" xlink:href="#op-halo"/>
  <g>
    <path d="M396,240H589.5a10,10,0,0,0,10-10V210.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M599.5,205a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,599.5,205Z" fill="#666"/>
  </g>
  <g>
    <path d="M216,270V250a10,10,0,0,1,10-10H397.5a10,10,0,0,0,10-10V210.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M407.5,205a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,407.5,205Z" fill="#666"/>
  </g>
  <g>
    <line x1="150" y1="180" x2="186.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M192,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,192,180Z" fill="#666"/>
  </g>
  <g>
    <line x1="762" y1="72.89" x2="786.57" y2="72.89" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M792,72.89a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,792,72.89Z" fill="#666"/>
  </g>
  <g>
    <line x1="240" y1="180" x2="378.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M384,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,384,180Z" fill="#666"/>
  </g>
  <g>
    <line x1="432" y1="180" x2="570.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M576,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,576,180Z" fill="#666"/>
  </g>
  <g>
    <path d="M240,180h14a10,10,0,0,0,10-10V149.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M264,144a27.2,27.2,0,0,0,4.28,7.69L264,150.14l-4.28,1.55A27.18,27.18,0,0,0,264,144Z" fill="#666"/>
  </g>
  <g>
    <path d="M432,180h14a10,10,0,0,0,10-10V149.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M456,144a27.2,27.2,0,0,0,4.28,7.69L456,150.14l-4.28,1.55A27.18,27.18,0,0,0,456,144Z" fill="#666"/>
  </g>
  <g>
    <path d="M624,180h14a10,10,0,0,0,10-10V149.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M648,144a27.2,27.2,0,0,0,4.28,7.69L648,150.14l-4.28,1.55A27.18,27.18,0,0,0,648,144Z" fill="#666"/>
  </g>
  <g>
    <line x1="264" y1="131.89" x2="264" y2="65.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M264,59.89a27.2,27.2,0,0,0,4.28,7.69L264,66l-4.28,1.55A27.18,27.18,0,0,0,264,59.89Z" fill="#666"/>
  </g>
  <g>
    <line x1="456" y1="66.14" x2="456" y2="65.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M456,59.89a27.2,27.2,0,0,0,4.28,7.69L456,66l-4.28,1.55A27.18,27.18,0,0,0,456,59.89Z" fill="#666"/>
  </g>
  <g>
    <line x1="648" y1="65.89" x2="648" y2="65.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M648,59.89a27.2,27.2,0,0,0,4.28,7.69L648,66l-4.28,1.55A27.18,27.18,0,0,0,648,59.89Z" fill="#666"/>
  </g>
  <g>
    <path d="M264,132V106a10,10,0,0,1,10-10h8.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M288,96a27.2,27.2,0,0,0-7.69,4.28L281.86,96l-1.55-4.28A27.18,27.18,0,0,0,288,96Z" fill="#666"/>
  </g>
  <g>
    <path d="M456,132V106a10,10,0,0,1,10-10h8.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M480,96a27.2,27.2,0,0,0-7.69,4.28L473.86,96l-1.55-4.28A27.18,27.18,0,0,0,480,96Z" fill="#666"/>
  </g>
  <g>
    <path d="M264,48.39h18a16.83,16.83,0,0,0,10.26-4.22L308,28.61a16.83,16.83,0,0,1,10.26-4.22h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M333,24.39a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,333,24.39Z" fill="#666"/>
  </g>
  <g>
    <path d="M456,47.89h18a17.11,17.11,0,0,0,10.31-4.18l15.63-15.15a17.11,17.11,0,0,1,10.31-4.18h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M525,24.39a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,525,24.39Z" fill="#666"/>
  </g>
  <g>
    <path d="M648,48.39h18a16.83,16.83,0,0,0,10.26-4.22L692,28.61a16.83,16.83,0,0,1,10.26-4.22h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M717,24.39a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,717,24.39Z" fill="#666"/>
  </g>
  <g>
    <line x1="652" y1="96" x2="666.57" y2="96.12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M672,96.16a27.2,27.2,0,0,0-7.73,4.22l1.58-4.27-1.51-4.29A27.18,27.18,0,0,0,672,96.16Z" fill="#666"/>
  </g>
  <g>
    <line x1="216" y1="258" x2="216" y2="209.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M216,204a27.2,27.2,0,0,0,4.28,7.69L216,210.14l-4.28,1.55A27.18,27.18,0,0,0,216,204Z" fill="#666"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="757.75" cy="74.89" r="11.25"/>
      <circle cx="757.75" cy="74.89" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M753.63,75.39V74.08H757V70.65h1.34v3.43h3.41v1.31h-3.41v3.42H757V75.39h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(744.75 60.89)" xlink:href="#op-sum"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="349.75" cy="26.64" r="11.25"/>
      <circle cx="349.75" cy="26.64" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M348.71,27.29L342,30V28.9l5.51-2.12L342,24.68V23.62l6.75,2.68v1Z"/>
      <path d="M354.09,26.09h-0.85q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28h1.34a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38,2.21,2.21,0,0,1-1.18-2.08,1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69,1.56,1.56,0,0,1-.43-1.14,1.8,1.8,0,0,1,.3-1A2,2,0,0,1,351,21.9a4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2h-1.34a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z"/>
    </g>
    <use width="24" height="24" transform="translate(336.75 12.64)" xlink:href="#op-sum_5"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="265.75" cy="49.99" r="11.25"/>
      <circle cx="265.75" cy="49.99" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M261.26,49.2h9v1.15h-9V49.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(252.75 35.99)" xlink:href="#op-sum_4"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="228.25" cy="50.64" r="11.25"/>
      <circle cx="228.25" cy="50.64" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M225.9,48.66V47.85a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23H229V54.6h-1.12V48.66h-2Z"/>
    </g>
    <use width="24" height="24" transform="translate(215.25 36.64)" xlink:href="#op-sum_3"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="301.01" cy="97.25" r="11.25"/>
      <circle cx="301.01" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M298.17,100.53l-1-1L299.74,97l-2.58-2.58,1-1L300.74,96l2.56-2.56,1,1L301.73,97l2.57,2.57-1,1L300.73,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(288.01 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M221.93,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L221,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,221.93,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(191.25 155.25)" xlink:href="#rnn-s"/>
  </g>
  <use width="24" height="24" transform="translate(528.74 12.64)" xlink:href="#op-sum_5"/>
  <g>
    <g opacity="0.1">
      <circle cx="457.74" cy="49.99" r="11.25"/>
      <circle cx="457.74" cy="49.99" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M453.26,49.2h9v1.15h-9V49.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(444.74 35.99)" xlink:href="#op-sum_4"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="493" cy="97.25" r="11.25"/>
      <circle cx="493" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M490.16,100.53l-1-1L491.73,97l-2.58-2.58,1-1L492.74,96l2.56-2.56,1,1L493.72,97l2.57,2.57-1,1L492.72,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(480 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M413.93,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L413,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,413.93,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(383.24 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_4" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="733.74" cy="26.64" r="11.25"/>
      <circle cx="733.74" cy="26.64" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M732.7,27.29L725.95,30V28.9l5.51-2.12-5.51-2.11V23.62l6.75,2.68v1Z"/>
      <path d="M738.07,26.09h-0.85q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28h1.34a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38,2.21,2.21,0,0,1-1.18-2.08,1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69,1.56,1.56,0,0,1-.43-1.14,1.8,1.8,0,0,1,.3-1A2,2,0,0,1,735,21.9a4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H739.1a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z"/>
    </g>
    <use width="24" height="24" transform="translate(720.74 12.64)" xlink:href="#op-sum_5"/>
  </g>
  <g id="_Group_5" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="648.74" cy="49.99" r="11.25"/>
      <circle cx="648.74" cy="49.99" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M644.25,49.2h9v1.15h-9V49.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(635.74 35.99)" xlink:href="#op-sum_4"/>
  </g>
  <g id="_Group_6" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="685" cy="97.25" r="11.25"/>
      <circle cx="685" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M682.16,100.53l-1-1L683.73,97l-2.58-2.58,1-1L684.74,96l2.56-2.56,1,1L685.72,97l2.57,2.57-1,1L684.72,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(672 83.25)" xlink:href="#op-x"/>
  </g>
  <g id="_Group_7" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M605.92,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L605,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,605.92,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.24 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="216.75" cy="228" r="11.25"/>
      <circle cx="216.75" cy="228" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M214.63,225.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44,3.75,3.75,0,0,1,.74,2.26v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1,3.86,3.86,0,0,1-.9-2.66v-0.09a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,216,227v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,214.63,225.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.94,1.94,0,0,0,3,0,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,215.05,230.28Z"/>
    </g>
    <use width="24" height="24" transform="translate(203.75 214)" xlink:href="#op-sum_2"/>
  </g>
  <g id="_Group_8" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="445.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M463.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,453,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,460.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(443.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <g id="_Group_9" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="253.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M271.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,261,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,268.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(251.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <g id="_Group_10" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="637.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M655.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,645,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,652.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(635.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
</svg>
</figure>

<p>That’s a bit complicated, so let’s work through it step by step. At a high-level, we’re still running the RNN and outputting a weighted combination of the states:</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="264" viewBox="0 0 984 264">
  <defs>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-14" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
    <symbol id="op-halo" data-name="op-halo" viewBox="0 0 31.45 31.45">
      <circle cx="15.73" cy="15.73" r="14.73" fill="#e6eaf2" stroke="#fff" stroke-miterlimit="10" stroke-width="2"/>
    </symbol>
    <symbol id="op-sum_5" data-name="op-sum 5" viewBox="0 0 24 24">
      <use id="op-bg-17" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <g>
        <path d="M11,12.65L4.21,15.32V14.26l5.51-2.12L4.21,10V9L11,11.66v1Z" fill="#666"/>
        <path d="M16.34,11.45H15.48q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28H19a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38A2.21,2.21,0,0,1,12,12.79a1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69A1.56,1.56,0,0,1,12.24,9a1.8,1.8,0,0,1,.3-1,2,2,0,0,1,.74-0.69,4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H17.36a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-sum_4" data-name="op-sum 4" viewBox="0 0 24 24">
      <use id="op-bg-20" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.51,11.21h9v1.15h-9V11.21Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_3" data-name="op-sum 3" viewBox="0 0 24 24">
      <use id="op-bg-23" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.65,10V9.21a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23h0.83V16H11.62V10h-2Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-sigma" data-name="rnn-sigma" viewBox="0 0 25.17 25.17">
      <rect x="0.75" y="0.75" width="23.67" height="23.67" rx="6" ry="6" fill="#f0f0f5" stroke="#666" stroke-width="1.5"/>
      <path d="M19,8.67H16.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32,5.73,5.73,0,0,1,1.5-4.07,5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21H19V8.67ZM15.8,12.78a5.89,5.89,0,0,0-.74-2.92,2.87,2.87,0,0,0-2.65-1.41A2.86,2.86,0,0,0,9.8,9.79a5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,2.89,2.89,0,0,0,2.47,1.26A2.88,2.88,0,0,0,15,15.74,5.37,5.37,0,0,0,15.8,12.78Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <rect x="168" y="13.25" width="612" height="238.75" rx="10" ry="10" fill="#f0f0f5"/>
  <line x1="348" y1="39" x2="348" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="540" y1="39" x2="540" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="732" y1="39" x2="732" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M240,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M432,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M624,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M300,84V75.5a6,6,0,0,1,6-6H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M492,96V79.5a6,6,0,0,1,6-6H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M684,96V83.5a6,6,0,0,1,6-6h66" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g>
    <g opacity="0.1">
      <circle cx="301.01" cy="97.25" r="11.25"/>
      <circle cx="301.01" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M298.17,100.53l-1-1L299.75,97l-2.58-2.58,1-1L300.75,96l2.56-2.56,1,1L301.74,97l2.57,2.57-1,1L300.73,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(288.01 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M221.93,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L221,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,221.93,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(191.25 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="493.01" cy="97.25" r="11.25"/>
      <circle cx="493.01" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M490.17,100.53l-1-1L491.74,97l-2.58-2.58,1-1L492.74,96l2.56-2.56,1,1L493.73,97l2.57,2.57-1,1L492.73,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(480.01 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="384.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M413.93,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L413,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,413.93,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(383.24 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="685" cy="97.25" r="11.25"/>
      <circle cx="685" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M682.16,100.53l-1-1L683.73,97l-2.58-2.58,1-1L684.74,96l2.56-2.56,1,1L685.72,97l2.57,2.57-1,1L684.72,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(672 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M605.92,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L605,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,605.92,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.24 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g>
    <g>
      <line x1="156" y1="180" x2="186.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M192,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,192,180Z" fill="#666"/>
    </g>
    <g>
      <line x1="762" y1="73" x2="786.57" y2="73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M792,73a27.2,27.2,0,0,0-7.69,4.28L785.86,73l-1.55-4.28A27.17,27.17,0,0,0,792,73Z" fill="#666"/>
    </g>
    <g>
      <line x1="240" y1="180" x2="378.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M384,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,384,180Z" fill="#666"/>
    </g>
    <g>
      <line x1="432" y1="180" x2="570.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M576,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,576,180Z" fill="#666"/>
    </g>
    <g>
      <path d="M396,240H589.5a10,10,0,0,0,10-10V210.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M599.5,205a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,599.5,205Z" fill="#666"/>
    </g>
    <g>
      <path d="M216,270V250a10,10,0,0,1,10-10H397.5a10,10,0,0,0,10-10V210.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M407.5,205a27.2,27.2,0,0,0,4.28,7.69l-4.28-1.55-4.28,1.55A27.18,27.18,0,0,0,407.5,205Z" fill="#666"/>
    </g>
    <g>
      <line x1="216" y1="258" x2="216" y2="209.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <path d="M216,204a27.2,27.2,0,0,0,4.28,7.69L216,210.14l-4.28,1.55A27.18,27.18,0,0,0,216,204Z" fill="#666"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="216.75" cy="226.25" r="11.25"/>
      <circle cx="216.75" cy="226.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M214.63,223.33a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44,3.75,3.75,0,0,1,.74,2.26v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1,3.86,3.86,0,0,1-.9-2.66v-0.09a3.42,3.42,0,0,1,.64-2,2.76,2.76,0,0,1,1.63-1.14v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,214.63,223.33Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.94,1.94,0,0,0,3,0,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,215.05,228.53Z"/>
    </g>
    <use width="24" height="24" transform="translate(203.75 212.25)" xlink:href="#op-sum_2"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="757.75" cy="75" r="11.25"/>
      <circle cx="757.75" cy="75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M753.63,75.49V74.18H757V70.75h1.34v3.43h3.41v1.31h-3.41v3.42H757V75.49h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(744.75 61)" xlink:href="#op-sum"/>
  </g>
  <g opacity="0.2">
    <g>
      <path d="M240,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 147.96 267.02 148.57 264 145.32 260.98 148.57 260.32 147.96 264 144 267.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M432,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 147.96 459.02 148.57 456 145.32 452.98 148.57 452.32 147.96 456 144 459.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M624,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 147.96 651.02 148.57 648 145.32 644.98 148.57 644.32 147.96 648 144 651.68 147.96" fill="#666"/>
    </g>
    <g>
      <line x1="264" y1="132" x2="264" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 63.96 267.02 64.57 264 61.32 260.98 64.57 260.32 63.96 264 60 267.68 63.96" fill="#666"/>
    </g>
    <g>
      <line x1="456" y1="66.25" x2="456" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 63.96 459.02 64.57 456 61.32 452.98 64.57 452.32 63.96 456 60 459.68 63.96" fill="#666"/>
    </g>
    <line x1="456" y1="132" x2="456" y2="73.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="648" y1="66" x2="648" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 63.96 651.02 64.57 648 61.32 644.98 64.57 644.32 63.96 648 60 651.68 63.96" fill="#666"/>
    </g>
    <line x1="648" y1="132" x2="648" y2="77" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="284.05 99.68 283.43 99.02 286.68 96 283.43 92.98 284.05 92.32 288.01 96 284.05 99.68" fill="#666"/>
    </g>
    <g>
      <path d="M456,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="476.05 99.68 475.43 99.02 478.68 96 475.43 92.98 476.05 92.32 480.01 96 476.05 99.68" fill="#666"/>
    </g>
    <line x1="228" y1="48" x2="648" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,48.5h18a16.83,16.83,0,0,0,10.26-4.22L308,28.72a16.83,16.83,0,0,1,10.26-4.22H332" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="329.04 28.18 328.43 27.52 331.68 24.5 328.43 21.48 329.04 20.82 333 24.5 329.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M456,48h18a17.11,17.11,0,0,0,10.31-4.18l15.63-15.15a17.11,17.11,0,0,1,10.31-4.18H524" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="521.04 28.18 520.43 27.52 523.68 24.5 520.43 21.48 521.04 20.82 525 24.5 521.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M648,48.5h18a16.83,16.83,0,0,0,10.26-4.22L692,28.72a16.83,16.83,0,0,1,10.26-4.22H716" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="713.04 28.18 712.43 27.52 715.68 24.5 712.43 21.48 713.04 20.82 717 24.5 713.04 28.18" fill="#666"/>
    </g>
    <g>
      <line x1="652" y1="96" x2="671.03" y2="96.16" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="668.02 99.81 667.41 99.15 670.68 96.15 667.46 93.11 668.08 92.45 672.01 96.17 668.02 99.81" fill="#666"/>
    </g>
    <path d="M612,76.5V90a6,6,0,0,0,6,6h26" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M576,48h30a6,6,0,0,1,6,6V65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <use id="op-halo-3" data-name="op-halo" width="31.45" height="31.45" transform="translate(332.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-6" data-name="op-halo" width="31.45" height="31.45" transform="translate(524.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-9" data-name="op-halo" width="31.45" height="31.45" transform="translate(716.94 9.11)" xlink:href="#op-halo"/>
    <use width="24" height="24" transform="translate(336.75 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(252.75 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(203.25 36.75)" xlink:href="#op-sum_3"/>
    <use width="24" height="24" transform="translate(528.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(444.74 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(720.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(635.74 36.09)" xlink:href="#op-sum_4"/>
    <use id="rnn-sigma-3" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(251.58 118.58)" xlink:href="#rnn-sigma"/>
    <use id="rnn-sigma-6" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(443.58 118.58)" xlink:href="#rnn-sigma"/>
    <use id="rnn-sigma-9" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(635.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
</svg>
</figure>

<p>The weight for each step is determined by a “halting neuron”. It’s a sigmoid neuron that looks at the RNN state and gives an halting weight, which we can think of as the probability that we should stop at that step.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="264" viewBox="0 0 984 264">
  <defs>
    <symbol id="op-halo" data-name="op-halo" viewBox="0 0 31.45 31.45">
      <circle cx="15.73" cy="15.73" r="14.73" fill="#e6eaf2" stroke="#fff" stroke-miterlimit="10" stroke-width="2"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum_5" data-name="op-sum 5" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <g>
        <path d="M11,12.65L4.21,15.32V14.26l5.51-2.12L4.21,10V9L11,11.66v1Z" fill="#666"/>
        <path d="M16.34,11.45H15.48q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28H19a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38A2.21,2.21,0,0,1,12,12.79a1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69A1.56,1.56,0,0,1,12.24,9a1.8,1.8,0,0,1,.3-1,2,2,0,0,1,.74-0.69,4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H17.36a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-sum_4" data-name="op-sum 4" viewBox="0 0 24 24">
      <use id="op-bg-6" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.51,11.21h9v1.15h-9V11.21Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_3" data-name="op-sum 3" viewBox="0 0 24 24">
      <use id="op-bg-9" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.65,10V9.21a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23h0.83V16H11.62V10h-2Z" fill="#666"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-18" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-sigma" data-name="rnn-sigma" viewBox="0 0 25.17 25.17">
      <rect x="0.75" y="0.75" width="23.67" height="23.67" rx="6" ry="6" fill="#f0f0f5" stroke="#666" stroke-width="1.5"/>
      <path d="M19,8.67H16.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32,5.73,5.73,0,0,1,1.5-4.07,5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21H19V8.67ZM15.8,12.78a5.89,5.89,0,0,0-.74-2.92,2.87,2.87,0,0,0-2.65-1.41A2.86,2.86,0,0,0,9.8,9.79a5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,2.89,2.89,0,0,0,2.47,1.26A2.88,2.88,0,0,0,15,15.74,5.37,5.37,0,0,0,15.8,12.78Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-32" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <rect x="168" y="13.25" width="612" height="238.75" rx="10" ry="10" fill="#f0f0f5"/>
  <line x1="348" y1="39" x2="348" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="540" y1="39" x2="540" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="732" y1="39" x2="732" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <g opacity="0.6">
    <text transform="translate(60.76 134)" font-size="13" font-family="Open Sans">halting neuron</text>
  </g>
  <g opacity="0.6">
    <g>
      <line x1="157" y1="132" x2="158" y2="132" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
      <line x1="159.98" y1="132" x2="250.01" y2="132" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5" stroke-dasharray="1.98 1.98"/>
      <line x1="251" y1="132" x2="252" y2="132" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="0.5"/>
    </g>
  </g>
  <g opacity="0.2">
    <g>
      <path d="M396,240H593.5a6,6,0,0,0,6-6V206" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="603.18 208.96 602.52 209.57 599.5 206.32 596.48 209.57 595.82 208.96 599.5 205 603.18 208.96" fill="#666"/>
    </g>
    <g>
      <path d="M407.5,206.14V234a6,6,0,0,1-6,6H222a6,6,0,0,0-6,6v18h0V204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="403.21 209.62 403.98 210.33 407.5 206.54 411.02 210.33 411.79 209.62 407.5 205 403.21 209.62" fill="#666"/>
    </g>
    <g>
      <line x1="240" y1="180" x2="383.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="380.04 183.68 379.43 183.02 382.68 180 379.43 176.98 380.04 176.32 384 180 380.04 183.68" fill="#666"/>
    </g>
    <g>
      <line x1="432" y1="180" x2="575.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="572.04 183.68 571.43 183.02 574.68 180 571.43 176.98 572.04 176.32 576 180 572.04 183.68" fill="#666"/>
    </g>
    <g>
      <path d="M432,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 147.96 459.02 148.57 456 145.32 452.98 148.57 452.32 147.96 456 144 459.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M624,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 147.96 651.02 148.57 648 145.32 644.98 148.57 644.32 147.96 648 144 651.68 147.96" fill="#666"/>
    </g>
    <path d="M432,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M624,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="264" y1="132" x2="264" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 63.96 267.02 64.57 264 61.32 260.98 64.57 260.32 63.96 264 60 267.68 63.96" fill="#666"/>
    </g>
    <g>
      <line x1="456" y1="66.25" x2="456" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 63.96 459.02 64.57 456 61.32 452.98 64.57 452.32 63.96 456 60 459.68 63.96" fill="#666"/>
    </g>
    <line x1="456" y1="132" x2="456" y2="73.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="648" y1="66" x2="648" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 63.96 651.02 64.57 648 61.32 644.98 64.57 644.32 63.96 648 60 651.68 63.96" fill="#666"/>
    </g>
    <line x1="648" y1="132" x2="648" y2="77" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M456,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="476.04 99.68 475.43 99.02 478.68 96 475.43 92.98 476.04 92.32 480 96 476.04 99.68" fill="#666"/>
    </g>
    <path d="M492,84V78.75c0-2.89,2.7-5.25,6-5.25H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M684,95V83.5a6,6,0,0,1,6-6h66" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <line x1="228" y1="48" x2="648" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,48.5h18a16.83,16.83,0,0,0,10.26-4.22L308,28.72a16.83,16.83,0,0,1,10.26-4.22H332" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="329.04 28.18 328.43 27.52 331.68 24.5 328.43 21.48 329.04 20.82 333 24.5 329.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M456,48h18a17.11,17.11,0,0,0,10.31-4.18l15.63-15.15a17.11,17.11,0,0,1,10.31-4.18H524" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="521.04 28.18 520.43 27.52 523.68 24.5 520.43 21.48 521.04 20.82 525 24.5 521.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M648,48.5h18a16.83,16.83,0,0,0,10.26-4.22L692,28.72a16.83,16.83,0,0,1,10.26-4.22H716" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="713.04 28.18 712.43 27.52 715.68 24.5 712.43 21.48 713.04 20.82 717 24.5 713.04 28.18" fill="#666"/>
    </g>
    <g>
      <line x1="652" y1="96" x2="671.02" y2="96.16" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="668.01 99.81 667.4 99.15 670.68 96.15 667.45 93.11 668.07 92.45 672 96.17 668.01 99.81" fill="#666"/>
    </g>
    <path d="M612,76.5V90a6,6,0,0,0,6,6h26" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M576,48h30a6,6,0,0,1,6,6V65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <use id="op-halo-3" data-name="op-halo" width="31.45" height="31.45" transform="translate(332.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-6" data-name="op-halo" width="31.45" height="31.45" transform="translate(524.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-9" data-name="op-halo" width="31.45" height="31.45" transform="translate(716.94 9.11)" xlink:href="#op-halo"/>
    <use width="24" height="24" transform="translate(336.75 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(252.75 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(203.25 36.75)" xlink:href="#op-sum_3"/>
    <use width="24" height="24" transform="translate(528.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(444.74 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(480.01 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(383.24 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(720.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(635.74 36.09)" xlink:href="#op-sum_4"/>
    <use id="op-x-5" data-name="op-x" width="24" height="24" transform="translate(672 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(575.24 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(203.75 212.25)" xlink:href="#op-sum_2"/>
    <use id="rnn-sigma-3" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(443.58 118.58)" xlink:href="#rnn-sigma"/>
    <use id="rnn-sigma-6" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(635.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <path d="M240,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g>
    <line x1="156" y1="180" x2="186.57" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M192,180a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,192,180Z" fill="#666"/>
  </g>
  <g>
    <line x1="762" y1="73" x2="786.57" y2="73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M792,73a27.2,27.2,0,0,0-7.69,4.28L785.86,73l-1.55-4.28A27.17,27.17,0,0,0,792,73Z" fill="#666"/>
  </g>
  <g>
    <path d="M240,180h18a6,6,0,0,0,6-6V149.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M264,144a27.2,27.2,0,0,0,4.28,7.69L264,150.14l-4.28,1.55A27.17,27.17,0,0,0,264,144Z" fill="#666"/>
  </g>
  <g>
    <path d="M264,132V102a6,6,0,0,1,6-6h12.57" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M288,96a27.2,27.2,0,0,0-7.69,4.28L281.86,96l-1.55-4.28A27.17,27.17,0,0,0,288,96Z" fill="#666"/>
  </g>
  <path d="M299.49,84V75.5a6,6,0,0,1,6-6H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="757.75" cy="75" r="11.25"/>
      <circle cx="757.75" cy="75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M753.63,75.49V74.18H757V70.75h1.34v3.43h3.41v1.31h-3.41v3.42H757V75.49h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(744.75 61)" xlink:href="#op-sum"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="301" cy="97.25" r="11.25"/>
      <circle cx="301" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M298.16,100.53l-1-1L299.73,97l-2.58-2.58,1-1L300.74,96l2.56-2.56,1,1L301.72,97l2.57,2.57-1,1L300.72,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(288 83.25)" xlink:href="#op-x"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="193" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M221.93,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L221,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,221.93,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(191.25 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="253.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M271.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,261,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,268.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(251.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
</svg>
</figure>

<p>We have a total budget for the halting weights of 1, so we track that budget along the top. When it gets to less than epsilon, we stop.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="264" viewBox="0 0 984 264">
  <defs>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-6" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="op-halo" data-name="op-halo" viewBox="0 0 31.45 31.45">
      <circle cx="15.73" cy="15.73" r="14.73" fill="#e6eaf2" stroke="#fff" stroke-miterlimit="10" stroke-width="2"/>
    </symbol>
    <symbol id="op-sum_5" data-name="op-sum 5" viewBox="0 0 24 24">
      <use id="op-bg-17" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <g>
        <path d="M11,12.65L4.21,15.32V14.26l5.51-2.12L4.21,10V9L11,11.66v1Z" fill="#666"/>
        <path d="M16.34,11.45H15.48q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28H19a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38A2.21,2.21,0,0,1,12,12.79a1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69A1.56,1.56,0,0,1,12.24,9a1.8,1.8,0,0,1,.3-1,2,2,0,0,1,.74-0.69,4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H17.36a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-sum_3" data-name="op-sum 3" viewBox="0 0 24 24">
      <use id="op-bg-20" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.65,10V9.21a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23h0.83V16H11.62V10h-2Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_4" data-name="op-sum 4" viewBox="0 0 24 24">
      <use id="op-bg-29" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.51,11.21h9v1.15h-9V11.21Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-sigma" data-name="rnn-sigma" viewBox="0 0 25.17 25.17">
      <rect x="0.75" y="0.75" width="23.67" height="23.67" rx="6" ry="6" fill="#f0f0f5" stroke="#666" stroke-width="1.5"/>
      <path d="M19,8.67H16.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32,5.73,5.73,0,0,1,1.5-4.07,5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21H19V8.67ZM15.8,12.78a5.89,5.89,0,0,0-.74-2.92,2.87,2.87,0,0,0-2.65-1.41A2.86,2.86,0,0,0,9.8,9.79a5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,2.89,2.89,0,0,0,2.47,1.26A2.88,2.88,0,0,0,15,15.74,5.37,5.37,0,0,0,15.8,12.78Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <rect x="168" y="13.25" width="612" height="238.75" rx="10" ry="10" fill="#f0f0f5"/>
  <line x1="348" y1="39" x2="348" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="540" y1="39" x2="540" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="732" y1="39" x2="732" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <g opacity="0.2">
    <g>
      <path d="M396,240H593.5a6,6,0,0,0,6-6V206" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="603.18 208.96 602.52 209.57 599.5 206.32 596.48 209.57 595.82 208.96 599.5 205 603.18 208.96" fill="#666"/>
    </g>
    <g>
      <path d="M407.5,206.14V234a6,6,0,0,1-6,6H222a6,6,0,0,0-6,6v18h0V204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="403.21 209.62 403.98 210.33 407.5 206.54 411.02 210.33 411.79 209.62 407.5 205 403.21 209.62" fill="#666"/>
    </g>
    <g>
      <line x1="156" y1="180" x2="191.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="188.04 183.68 187.43 183.02 190.68 180 187.43 176.98 188.04 176.32 192 180 188.04 183.68" fill="#666"/>
    </g>
    <g>
      <line x1="762" y1="73" x2="791.02" y2="73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="788.04 76.68 787.43 76.02 790.68 73 787.43 69.98 788.04 69.32 792 73 788.04 76.68" fill="#666"/>
    </g>
    <g>
      <line x1="240" y1="180" x2="383.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="380.04 183.68 379.43 183.02 382.68 180 379.43 176.98 380.04 176.32 384 180 380.04 183.68" fill="#666"/>
    </g>
    <g>
      <line x1="432" y1="180" x2="575.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="572.04 183.68 571.43 183.02 574.68 180 571.43 176.98 572.04 176.32 576 180 572.04 183.68" fill="#666"/>
    </g>
    <g>
      <path d="M240,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 147.96 267.02 148.57 264 145.32 260.98 148.57 260.32 147.96 264 144 267.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M432,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 147.96 459.02 148.57 456 145.32 452.98 148.57 452.32 147.96 456 144 459.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M624,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 147.96 651.02 148.57 648 145.32 644.98 148.57 644.32 147.96 648 144 651.68 147.96" fill="#666"/>
    </g>
    <path d="M240,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M432,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M624,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="284.04 99.68 283.43 99.02 286.68 96 283.43 92.98 284.04 92.32 288 96 284.04 99.68" fill="#666"/>
    </g>
    <g>
      <path d="M456,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="476.04 99.68 475.43 99.02 478.68 96 475.43 92.98 476.04 92.32 480 96 476.04 99.68" fill="#666"/>
    </g>
    <path d="M300,84V75.5a6,6,0,0,1,6-6H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M492,84V78.75c0-2.89,2.7-5.25,6-5.25H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M684,99V83.5a6,6,0,0,1,6-6h66" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="652" y1="96" x2="671.02" y2="96.16" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="668.01 99.81 667.4 99.15 670.68 96.15 667.45 93.11 668.07 92.45 672 96.17 668.01 99.81" fill="#666"/>
    </g>
    <path d="M612,76.5V90a6,6,0,0,0,6,6h26" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M576,48h30a6,6,0,0,1,6,6V65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <use id="op-sum-3" data-name="op-sum" width="24" height="24" transform="translate(744.75 61)" xlink:href="#op-sum"/>
    <use width="24" height="24" transform="translate(288.01 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(191.25 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(480.01 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(383.24 155.25)" xlink:href="#rnn-s"/>
    <use id="op-x-7" data-name="op-x" width="24" height="24" transform="translate(672 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(575.24 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(203.75 212.25)" xlink:href="#op-sum_2"/>
  </g>
  <line x1="228" y1="48" x2="648" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <use id="op-halo-3" data-name="op-halo" width="31.45" height="31.45" transform="translate(332.94 9.11)" xlink:href="#op-halo"/>
  <use id="op-halo-6" data-name="op-halo" width="31.45" height="31.45" transform="translate(524.94 9.11)" xlink:href="#op-halo"/>
  <use id="op-halo-9" data-name="op-halo" width="31.45" height="31.45" transform="translate(716.94 9.11)" xlink:href="#op-halo"/>
  <g>
    <g opacity="0.1">
      <circle cx="349.75" cy="26.75" r="11.25"/>
      <circle cx="349.75" cy="26.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M348.71,27.39L342,30.07V29l5.51-2.12L342,24.78V23.72l6.75,2.68v1Z"/>
      <path d="M354.09,26.2h-0.85q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28h1.34a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38,2.21,2.21,0,0,1-1.18-2.08,1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69,1.56,1.56,0,0,1-.43-1.14,1.8,1.8,0,0,1,.3-1A2,2,0,0,1,351,22a4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2h-1.34a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88V26.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(336.75 12.75)" xlink:href="#op-sum_5"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="216.25" cy="50.75" r="11.25"/>
      <circle cx="216.25" cy="50.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M213.9,48.77V48a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23H217v8.36h-1.12V48.77h-2Z"/>
    </g>
    <use width="24" height="24" transform="translate(203.25 36.75)" xlink:href="#op-sum_3"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="541.74" cy="26.75" r="11.25"/>
      <circle cx="541.74" cy="26.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M540.71,27.39L534,30.07V29l5.51-2.12L534,24.78V23.72l6.75,2.68v1Z"/>
      <path d="M546.08,26.2h-0.85q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28h1.34a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38,2.21,2.21,0,0,1-1.18-2.08,1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69,1.56,1.56,0,0,1-.43-1.14,1.8,1.8,0,0,1,.3-1A2,2,0,0,1,543,22a4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H547.1a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88V26.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(528.74 12.75)" xlink:href="#op-sum_5"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="733.74" cy="26.75" r="11.25"/>
      <circle cx="733.74" cy="26.75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M732.7,27.39l-6.75,2.67V29l5.51-2.12-5.51-2.11V23.72l6.75,2.68v1Z"/>
      <path d="M738.07,26.2h-0.85q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28h1.34a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38,2.21,2.21,0,0,1-1.18-2.08,1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69,1.56,1.56,0,0,1-.43-1.14,1.8,1.8,0,0,1,.3-1A2,2,0,0,1,735,22a4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H739.1a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88V26.2Z"/>
    </g>
    <use width="24" height="24" transform="translate(720.74 12.75)" xlink:href="#op-sum_5"/>
  </g>
  <g>
    <line x1="264" y1="132" x2="264" y2="65.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M264,60a27.2,27.2,0,0,0,4.28,7.69L264,66.14l-4.28,1.55A27.17,27.17,0,0,0,264,60Z" fill="#666"/>
  </g>
  <g>
    <line x1="456" y1="132" x2="456" y2="65.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M456,60a27.2,27.2,0,0,0,4.28,7.69L456,66.14l-4.28,1.55A27.18,27.18,0,0,0,456,60Z" fill="#666"/>
  </g>
  <g>
    <line x1="648" y1="132" x2="648" y2="65.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M648,60a27.2,27.2,0,0,0,4.28,7.69L648,66.14l-4.28,1.55A27.18,27.18,0,0,0,648,60Z" fill="#666"/>
  </g>
  <g>
    <path d="M264,48.5h18a16.83,16.83,0,0,0,10.26-4.22L308,28.72a16.83,16.83,0,0,1,10.26-4.22h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M333,24.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,333,24.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M456,48h18a17.11,17.11,0,0,0,10.31-4.18l15.63-15.15a17.11,17.11,0,0,1,10.31-4.18h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M525,24.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,525,24.5Z" fill="#666"/>
  </g>
  <g>
    <path d="M648,48.5h18a16.83,16.83,0,0,0,10.26-4.22L692,28.72a16.83,16.83,0,0,1,10.26-4.22h9.32" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M717,24.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.17,27.17,0,0,0,717,24.5Z" fill="#666"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="265.75" cy="50.09" r="11.25"/>
      <circle cx="265.75" cy="50.09" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M261.26,49.3h9v1.15h-9V49.3Z"/>
    </g>
    <use width="24" height="24" transform="translate(252.75 36.09)" xlink:href="#op-sum_4"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="648.74" cy="50.09" r="11.25"/>
      <circle cx="648.74" cy="50.09" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M644.25,49.3h9v1.15h-9V49.3Z"/>
    </g>
    <use width="24" height="24" transform="translate(635.74 36.09)" xlink:href="#op-sum_4"/>
  </g>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="253.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M271.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,261,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,268.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(251.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="445.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M463.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,453,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,460.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(443.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="637.33" y="121.33" width="23.67" height="23.67" rx="6" ry="6" stroke="#000" stroke-width="1.5"/>
      <path d="M655.54,129.25h-2.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32A5.73,5.73,0,0,1,645,129a5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21h4.88v1.57Zm-3.16,4.11a5.89,5.89,0,0,0-.74-2.92,3.2,3.2,0,0,0-5.26-.06,5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,3.11,3.11,0,0,0,5.05-.06A5.37,5.37,0,0,0,652.39,133.37Z"/>
    </g>
    <use width="25.17" height="25.17" transform="translate(635.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <g>
    <g opacity="0.1">
      <circle cx="457.74" cy="50.09" r="11.25"/>
      <circle cx="457.74" cy="50.09" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M453.26,49.3h9v1.15h-9V49.3Z"/>
    </g>
    <use width="24" height="24" transform="translate(444.74 36.09)" xlink:href="#op-sum_4"/>
  </g>
</svg>
</figure>

<p>When we stop, might have some left over halting budget because we stop when it gets to less than epsilon. What should we do with it? Technically, it’s being given to future steps but we don’t want to compute those, so we attribute it to the last step.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="264" viewBox="0 0 984 264">
  <defs>
    <symbol id="op-halo" data-name="op-halo" viewBox="0 0 31.45 31.45">
      <circle cx="15.73" cy="15.73" r="14.73" fill="#e6eaf2" stroke="#fff" stroke-miterlimit="10" stroke-width="2"/>
    </symbol>
    <symbol id="op-bg" data-name="op-bg" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="11.25" fill="#e0cef5" stroke="#000" stroke-miterlimit="10" stroke-opacity="0.5" stroke-width="1.5"/>
    </symbol>
    <symbol id="op-sum_5" data-name="op-sum 5" viewBox="0 0 24 24">
      <use id="op-bg-3" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <g>
        <path d="M11,12.65L4.21,15.32V14.26l5.51-2.12L4.21,10V9L11,11.66v1Z" fill="#666"/>
        <path d="M16.34,11.45H15.48q-0.37,0-.73,0a1.84,1.84,0,0,0-.66.17,1,1,0,0,0-.46.42,1.19,1.19,0,0,0-.21.73,1.13,1.13,0,0,0,.2.67,1.4,1.4,0,0,0,.46.43,2.73,2.73,0,0,0,1.33.3,3,3,0,0,0,1.54-.37,1.66,1.66,0,0,0,.73-1.28H19a2.55,2.55,0,0,1-1.09,2.09,4,4,0,0,1-2.32.7,7.39,7.39,0,0,1-1.28-.11,4.23,4.23,0,0,1-1.17-.38A2.21,2.21,0,0,1,12,12.79a1.72,1.72,0,0,1,.55-1.3,2.33,2.33,0,0,1,1.2-.66v0a2.71,2.71,0,0,1-1.07-.69A1.56,1.56,0,0,1,12.24,9a1.8,1.8,0,0,1,.3-1,2,2,0,0,1,.74-0.69,4.19,4.19,0,0,1,2-.52,4.65,4.65,0,0,1,2.34.55,2.37,2.37,0,0,1,1.05,2H17.36a1.21,1.21,0,0,0-.64-1.15,3.21,3.21,0,0,0-1.36-.29,2.53,2.53,0,0,0-1.1.24,1,1,0,0,0-.58,1,1,1,0,0,0,.58,1,2.79,2.79,0,0,0,1.2.22h0.88v1.16Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-sum_4" data-name="op-sum 4" viewBox="0 0 24 24">
      <use id="op-bg-6" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.51,11.21h9v1.15h-9V11.21Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum_3" data-name="op-sum 3" viewBox="0 0 24 24">
      <use id="op-bg-9" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.65,10V9.21a4.3,4.3,0,0,0,1.59-.37,1.83,1.83,0,0,0,.67-1.23h0.83V16H11.62V10h-2Z" fill="#666"/>
    </symbol>
    <symbol id="op-x" data-name="op-x" viewBox="0 0 24 24">
      <use id="op-bg-12" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.16,15.28l-1-1,2.56-2.56L8.16,9.16l1-1,2.58,2.58L14.3,8.17l1,1-2.56,2.56,2.57,2.57-1,1-2.57-2.57Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-s" data-name="rnn-s" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.68,27.61a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71V29.51a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1A7.38,7.38,0,0,1,21,22.68a4.06,4.06,0,0,1-.93-2.77A3.45,3.45,0,0,1,21.45,17,5.61,5.61,0,0,1,25,16a10.54,10.54,0,0,1,4.26.85l-0.56,1.57A9.63,9.63,0,0,0,25,17.6a3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1A8.56,8.56,0,0,1,28.76,25,3.68,3.68,0,0,1,29.68,27.61Z" fill="#5b5b5b"/>
    </symbol>
    <symbol id="op-sum_2" data-name="op-sum 2" viewBox="0 0 24 24">
      <use width="24" height="24" xlink:href="#op-bg"/>
      <path d="M9.88,9.08a1.77,1.77,0,0,1,.69-1.47,3,3,0,0,1,1.89-.54,4.84,4.84,0,0,1,1.87.38v1.1a5.22,5.22,0,0,0-1.88-.4,1.57,1.57,0,0,0-.93.25,0.78,0.78,0,0,0-.35.67q0,0.74,1.51,1.26a4.6,4.6,0,0,1,2.22,1.44A3.75,3.75,0,0,1,15.64,14v0.27a4.23,4.23,0,0,1-.4,1.87,3,3,0,0,1-1.15,1.28,3.29,3.29,0,0,1-1.74.45,3.08,3.08,0,0,1-2.42-1A3.86,3.86,0,0,1,9,14.22V14.13a3.42,3.42,0,0,1,.64-2A2.76,2.76,0,0,1,11.29,11v0a2.36,2.36,0,0,1-1-.75A1.76,1.76,0,0,1,9.88,9.08Zm0.42,5.2a3,3,0,0,0,.55,1.89,1.8,1.8,0,0,0,1.49.69,1.79,1.79,0,0,0,1.48-.69,3.23,3.23,0,0,0,.55-2,2.67,2.67,0,0,0-.58-1.67,2.35,2.35,0,0,0-1.43-.92,1.81,1.81,0,0,0-1.49.7A3.19,3.19,0,0,0,10.3,14.28Z" fill="#666"/>
    </symbol>
    <symbol id="rnn-sigma" data-name="rnn-sigma" viewBox="0 0 25.17 25.17">
      <rect x="0.75" y="0.75" width="23.67" height="23.67" rx="6" ry="6" fill="#f0f0f5" stroke="#666" stroke-width="1.5"/>
      <path d="M19,8.67H16.48a5.39,5.39,0,0,1,1.41,3.87,6.62,6.62,0,0,1-1.37,4.36,5.13,5.13,0,0,1-4.11,1.73,5,5,0,0,1-4.09-1.78,6.66,6.66,0,0,1-1.37-4.32,5.73,5.73,0,0,1,1.5-4.07,5.22,5.22,0,0,1,4-1.58,6.18,6.18,0,0,1,1.67.21H19V8.67ZM15.8,12.78a5.89,5.89,0,0,0-.74-2.92,2.87,2.87,0,0,0-2.65-1.41A2.86,2.86,0,0,0,9.8,9.79a5.53,5.53,0,0,0-.77,3,4.82,4.82,0,0,0,.91,3,2.89,2.89,0,0,0,2.47,1.26A2.88,2.88,0,0,0,15,15.74,5.37,5.37,0,0,0,15.8,12.78Z" fill="#666"/>
    </symbol>
    <symbol id="op-sum" data-name="op-sum" viewBox="0 0 24 24">
      <use id="op-bg-35" data-name="op-bg" width="24" height="24" xlink:href="#op-bg"/>
      <path d="M7.88,12.5V11.18h3.41V7.75h1.34v3.43H16V12.5H12.62v3.42H11.29V12.5H7.88Z" fill="#666"/>
    </symbol>
  </defs>
  <title>rnn</title>
  <rect x="168" y="13.25" width="612" height="238.75" rx="10" ry="10" fill="#f0f0f5"/>
  <line x1="348" y1="39" x2="348" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="540" y1="39" x2="540" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <line x1="732" y1="39" x2="732" y2="264" stroke="#fff" stroke-miterlimit="10" stroke-width="1.5"/>
  <g opacity="0.2">
    <g>
      <path d="M396,240H593.5a6,6,0,0,0,6-6V206" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="603.18 208.96 602.52 209.57 599.5 206.32 596.48 209.57 595.82 208.96 599.5 205 603.18 208.96" fill="#666"/>
    </g>
    <g>
      <path d="M407.5,206.14V234a6,6,0,0,1-6,6H222a6,6,0,0,0-6,6v18h0V204" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="403.21 209.62 403.98 210.33 407.5 206.54 411.02 210.33 411.79 209.62 407.5 205 403.21 209.62" fill="#666"/>
    </g>
    <g>
      <line x1="156" y1="180" x2="191.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="188.04 183.68 187.43 183.02 190.68 180 187.43 176.98 188.04 176.32 192 180 188.04 183.68" fill="#666"/>
    </g>
    <g>
      <line x1="240" y1="180" x2="383.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="380.04 183.68 379.43 183.02 382.68 180 379.43 176.98 380.04 176.32 384 180 380.04 183.68" fill="#666"/>
    </g>
    <g>
      <line x1="432" y1="180" x2="575.02" y2="180" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="572.04 183.68 571.43 183.02 574.68 180 571.43 176.98 572.04 176.32 576 180 572.04 183.68" fill="#666"/>
    </g>
    <g>
      <path d="M240,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 147.96 267.02 148.57 264 145.32 260.98 148.57 260.32 147.96 264 144 267.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M432,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 147.96 459.02 148.57 456 145.32 452.98 148.57 452.32 147.96 456 144 459.68 147.96" fill="#666"/>
    </g>
    <g>
      <path d="M624,180h18a6,6,0,0,0,6-6V145" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 147.96 651.02 148.57 648 145.32 644.98 148.57 644.32 147.96 648 144 651.68 147.96" fill="#666"/>
    </g>
    <path d="M240,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M432,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="264" y1="132" x2="264" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="267.68 63.96 267.02 64.57 264 61.32 260.98 64.57 260.32 63.96 264 60 267.68 63.96" fill="#666"/>
    </g>
    <g>
      <line x1="456" y1="66.25" x2="456" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="459.68 63.96 459.02 64.57 456 61.32 452.98 64.57 452.32 63.96 456 60 459.68 63.96" fill="#666"/>
    </g>
    <line x1="456" y1="132" x2="456" y2="73.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <line x1="648" y1="66" x2="648" y2="60.97" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="651.68 63.96 651.02 64.57 648 61.32 644.98 64.57 644.32 63.96 648 60 651.68 63.96" fill="#666"/>
    </g>
    <line x1="648" y1="92" x2="648" y2="77" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <line x1="648" y1="120" x2="648" y2="100" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="284.04 99.68 283.43 99.02 286.68 96 283.43 92.98 284.04 92.32 288 96 284.04 99.68" fill="#666"/>
    </g>
    <g>
      <path d="M456,132V102a6,6,0,0,1,6-6h17" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="476.04 99.68 475.43 99.02 478.68 96 475.43 92.98 476.04 92.32 480 96 476.04 99.68" fill="#666"/>
    </g>
    <path d="M300,84V75.5a6,6,0,0,1,6-6H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M492,84V78.75c0-2.89,2.7-5.25,6-5.25H756" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <line x1="228" y1="48" x2="648" y2="48" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <g>
      <path d="M264,48.5h18a16.83,16.83,0,0,0,10.26-4.22L308,28.72a16.83,16.83,0,0,1,10.26-4.22H332" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="329.04 28.18 328.43 27.52 331.68 24.5 328.43 21.48 329.04 20.82 333 24.5 329.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M456,48h18a17.11,17.11,0,0,0,10.31-4.18l15.63-15.15a17.11,17.11,0,0,1,10.31-4.18H524" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="521.04 28.18 520.43 27.52 523.68 24.5 520.43 21.48 521.04 20.82 525 24.5 521.04 28.18" fill="#666"/>
    </g>
    <g>
      <path d="M648,48.5h18a16.83,16.83,0,0,0,10.26-4.22L692,28.72a16.83,16.83,0,0,1,10.26-4.22H716" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
      <polygon points="713.04 28.18 712.43 27.52 715.68 24.5 712.43 21.48 713.04 20.82 717 24.5 713.04 28.18" fill="#666"/>
    </g>
    <use id="op-halo-3" data-name="op-halo" width="31.45" height="31.45" transform="translate(332.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-6" data-name="op-halo" width="31.45" height="31.45" transform="translate(524.94 9.11)" xlink:href="#op-halo"/>
    <use id="op-halo-9" data-name="op-halo" width="31.45" height="31.45" transform="translate(716.94 9.11)" xlink:href="#op-halo"/>
    <use width="24" height="24" transform="translate(336.75 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(252.75 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(203.25 36.75)" xlink:href="#op-sum_3"/>
    <use width="24" height="24" transform="translate(288.01 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(191.25 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(528.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(444.74 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(480.01 83.25)" xlink:href="#op-x"/>
    <use width="49.5" height="49.5" transform="translate(383.24 155.25)" xlink:href="#rnn-s"/>
    <use width="24" height="24" transform="translate(720.74 12.75)" xlink:href="#op-sum_5"/>
    <use width="24" height="24" transform="translate(635.74 36.09)" xlink:href="#op-sum_4"/>
    <use width="24" height="24" transform="translate(203.75 212.25)" xlink:href="#op-sum_2"/>
    <use id="rnn-sigma-3" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(251.58 118.58)" xlink:href="#rnn-sigma"/>
    <use id="rnn-sigma-6" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(443.58 118.58)" xlink:href="#rnn-sigma"/>
    <use id="rnn-sigma-9" data-name="rnn-sigma" width="25.17" height="25.17" transform="translate(635.58 118.58)" xlink:href="#rnn-sigma"/>
  </g>
  <path d="M624,180h54a6,6,0,0,0,6-6V108" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M684,97V83.5a6,6,0,0,1,6-6h66" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M612,61V90a6,6,0,0,0,6,6h36" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <path d="M540,48h66a6,6,0,0,1,6,6V65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="685" cy="97.25" r="11.25"/>
      <circle cx="685" cy="97.25" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M682.16,100.53l-1-1L683.73,97l-2.58-2.58,1-1L684.74,96l2.56-2.56,1,1L685.72,97l2.57,2.57-1,1L684.72,98Z"/>
    </g>
    <use width="24" height="24" transform="translate(672 83.25)" xlink:href="#op-x"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <rect x="576.99" y="158" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M605.92,184.86a3.81,3.81,0,0,1-1.49,3.2,6.46,6.46,0,0,1-4,1.15,10.1,10.1,0,0,1-4.25-.71v-1.74a11.16,11.16,0,0,0,2.08.64,10.92,10.92,0,0,0,2.23.23,4.49,4.49,0,0,0,2.72-.69,2.25,2.25,0,0,0,.92-1.91,2.45,2.45,0,0,0-.32-1.32,3,3,0,0,0-1.08-1,15.14,15.14,0,0,0-2.31-1,7.38,7.38,0,0,1-3.1-1.84,4.06,4.06,0,0,1-.93-2.77,3.45,3.45,0,0,1,1.35-2.86,5.61,5.61,0,0,1,3.57-1.06,10.54,10.54,0,0,1,4.26.85L605,175.66a9.63,9.63,0,0,0-3.74-.81,3.62,3.62,0,0,0-2.24.62,2,2,0,0,0-.81,1.71,2.62,2.62,0,0,0,.3,1.32,2.8,2.8,0,0,0,1,.95,12.47,12.47,0,0,0,2.16,1,8.56,8.56,0,0,1,3.37,1.87A3.68,3.68,0,0,1,605.92,184.86Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.24 155.25)" xlink:href="#rnn-s"/>
  </g>
  <g>
    <line x1="762" y1="73" x2="786.57" y2="73" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M792,73a27.2,27.2,0,0,0-7.69,4.28L785.86,73l-1.55-4.28A27.17,27.17,0,0,0,792,73Z" fill="#666"/>
  </g>
  <g>
    <line x1="652" y1="96" x2="666.57" y2="96.12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M672,96.16a27.2,27.2,0,0,0-7.73,4.22l1.58-4.27-1.51-4.29A27.18,27.18,0,0,0,672,96.16Z" fill="#666"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <circle cx="757.75" cy="75" r="11.25"/>
      <circle cx="757.75" cy="75" r="11.25" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5" opacity="0.5"/>
      <path d="M753.63,75.49V74.18H757V70.75h1.34v3.43h3.41v1.31h-3.41v3.42H757V75.49h-3.41Z"/>
    </g>
    <use width="24" height="24" transform="translate(744.75 61)" xlink:href="#op-sum"/>
  </g>
</svg>
</figure>

<p>When training Adaptive Computation Time models, one adds a “ponder cost” term to the cost function. This penalizes the model for the amount of computation it uses. The bigger you make this term, the more it will trade-off performance for lowering compute time.</p>
<p>Adaptive Computation Time is a very new idea, but we believe that it, along with similar ideas, will be very important.</p>
<h3 id="code">Code</h3>
<p>The only open source implementation of Adaptive Computation Time at the moment seems to be <a href="https://github.com/DeNeutoy/act-tensorflow">Mark Neumann’s</a> (TensorFlow).</p>
<hr>
<h2 id="neural-programmer">Neural Programmer</h2>
<p>Neural nets are excellent at many tasks, but they also struggle to do some basic things like arithmetic, which are trivial in normal approaches to computing. It would be really nice to have a way to fuse neural nets with normal programming, and get the best of both worlds.</p>
<p>The neural programmer (<a href="http://arxiv.org/abs/1511.04834">Neelakantan, <em>et al.</em>, 2015</a>) is one approach to this. It learns to create programs in order to solve a task. In fact, it learns to generate such programs <em>without needing examples of correct programs</em>. It discovers how to produce programs as a means to the end of accomplishing some task.</p>
<p>The actual model in the paper answers questions about tables by generating SQL-like programs to query the table. However, there are a number of details here that make it a bit complicated, so let’s start by imagining a slightly simpler model, which is given an arithmetic expression and generates a program to evaluate it.</p>
<p>The generated program is a sequence of operations. Each operation is defined to operate on the output of past operations. So an operation might be something like “add the output of the operation 2 steps ago and the output of the operation 1 step ago.” It’s more like a unix pipe than a program with variables being assigned to and read from.</p>
<figure class="w-page">
<svg id="text" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="66" viewBox="0 0 984 66">
  <defs>
    <symbol id="op-1" data-name="op-1" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M35.86,16.27H34.49V10.74q0-1,0-1.57l-0.33.31-1.32,1.08L32.2,9.69l2.52-2h1.15v8.57Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-2" data-name="op-2" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M37.63,16.27H31.82v-1L34,13a18.79,18.79,0,0,0,1.3-1.42,3.39,3.39,0,0,0,.47-0.79A2.12,2.12,0,0,0,35.94,10a1.21,1.21,0,0,0-.35-0.91,1.34,1.34,0,0,0-1-.33,2.57,2.57,0,0,0-1,.18,4.46,4.46,0,0,0-1.06.66l-0.74-.91a4.8,4.8,0,0,1,1.39-.86,4.07,4.07,0,0,1,1.44-.25,2.82,2.82,0,0,1,1.92.62,2.11,2.11,0,0,1,.72,1.68,3,3,0,0,1-.21,1.1,4.48,4.48,0,0,1-.64,1.08A14.6,14.6,0,0,1,35,13.56L33.56,15v0.06h4.07v1.21Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-3" data-name="op-3" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12ZM13.5,12a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.55,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.5,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.74V9.79h1.11q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.61,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.69,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.2,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.69,10.8Z" fill="#666"/>
        <path d="M37.36,9.67A2,2,0,0,1,36.88,11a2.39,2.39,0,0,1-1.34.73v0a2.59,2.59,0,0,1,1.55.64,1.84,1.84,0,0,1,.52,1.36,2.26,2.26,0,0,1-.87,1.91,4,4,0,0,1-2.48.67,5.59,5.59,0,0,1-2.4-.46V14.7a5.49,5.49,0,0,0,1.15.42,5,5,0,0,0,1.17.15,2.47,2.47,0,0,0,1.49-.37,1.34,1.34,0,0,0,.49-1.14,1.09,1.09,0,0,0-.54-1,3.48,3.48,0,0,0-1.71-.32H33.16V11.3h0.76Q36,11.3,36,9.88A1,1,0,0,0,35.6,9a1.61,1.61,0,0,0-1.05-.3,3.19,3.19,0,0,0-.94.14,4.44,4.44,0,0,0-1.07.54l-0.67-1a4.49,4.49,0,0,1,2.74-.87,3.26,3.26,0,0,1,2,.56A1.83,1.83,0,0,1,37.36,9.67Z" fill="#666"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g>
    <line x1="228" y1="42" x2="300.57" y2="42" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M306,42a27.2,27.2,0,0,0-7.69,4.28L299.86,42l-1.55-4.28A27.18,27.18,0,0,0,306,42Z" fill="#666"/>
  </g>
  <g>
    <line x1="360" y1="42" x2="432.57" y2="42" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M438,42a27.2,27.2,0,0,0-7.69,4.28L431.86,42l-1.55-4.28A27.18,27.18,0,0,0,438,42Z" fill="#666"/>
  </g>
  <g>
    <line x1="492" y1="42" x2="564.57" y2="42" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M570,42a27.2,27.2,0,0,0-7.69,4.28L563.86,42l-1.55-4.28A27.18,27.18,0,0,0,570,42Z" fill="#666"/>
  </g>
  <g>
    <line x1="624" y1="42" x2="696.57" y2="42" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M702,42a27.2,27.2,0,0,0-7.69,4.28L695.86,42l-1.55-4.28A27.18,27.18,0,0,0,702,42Z" fill="#666"/>
  </g>
  <g>
    <path d="M336,42s52-30,117-30c52.7,0,97.43,16,112,21.89" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M570,36a27.2,27.2,0,0,0-8.74,1l3.06-3.37,0.2-4.55A27.17,27.17,0,0,0,570,36Z" fill="#666"/>
  </g>
  <g>
    <path d="M384.48,18.38A298.3,298.3,0,0,0,321,11.25c-64.46,0-116.85,29.8-117.37,30.1l0.75,1.3c0.52-.3,52.59-29.9,116.63-29.9a295.48,295.48,0,0,1,60.43,6.5Z" fill="#666"/>
    <path d="M432.52,29.11l-0.17,3.72a306,306,0,0,0-33.49-11l-2.81.81A306,306,0,0,1,431.8,34.23L429.26,37A27.2,27.2,0,0,1,438,36,27.17,27.17,0,0,1,432.52,29.11Z" fill="#666"/>
  </g>
  <use id="op-1-3" data-name="op-1" width="50.5" height="27.5" transform="translate(180 30)" xlink:href="#op-1"/>
  <use id="op-1-6" data-name="op-1" width="50.5" height="27.5" transform="translate(440.24 30)" xlink:href="#op-1"/>
  <use id="op-2-3" data-name="op-2" width="50.5" height="27.5" transform="translate(307.85 30)" xlink:href="#op-2"/>
  <use id="op-3-3" data-name="op-3" width="50.5" height="27.5" transform="translate(576 30)" xlink:href="#op-3"/>
</svg>
</figure>

<p>The program is generated one operation at a time by a controller RNN. At each step, the controller RNN outputs a probability distribution for what the next operation should be. For example, we might be pretty sure we want to perform addition at the first time step, then have a hard time deciding whether we should multiply or divide at the second step, and so on…</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="222" viewBox="0 0 984 222">
  <defs>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
    <symbol id="op-1" data-name="op-1" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M35.86,16.27H34.49V10.74q0-1,0-1.57l-0.33.31-1.32,1.08L32.2,9.69l2.52-2h1.15v8.57Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-2" data-name="op-2" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M37.63,16.27H31.82v-1L34,13a18.79,18.79,0,0,0,1.3-1.42,3.39,3.39,0,0,0,.47-0.79A2.12,2.12,0,0,0,35.94,10a1.21,1.21,0,0,0-.35-0.91,1.34,1.34,0,0,0-1-.33,2.57,2.57,0,0,0-1,.18,4.46,4.46,0,0,0-1.06.66l-0.74-.91a4.8,4.8,0,0,1,1.39-.86,4.07,4.07,0,0,1,1.44-.25,2.82,2.82,0,0,1,1.92.62,2.11,2.11,0,0,1,.72,1.68,3,3,0,0,1-.21,1.1,4.48,4.48,0,0,1-.64,1.08A14.6,14.6,0,0,1,35,13.56L33.56,15v0.06h4.07v1.21Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-3" data-name="op-3" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12ZM13.5,12a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.55,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.5,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.74V9.79h1.11q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.61,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.69,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.2,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.69,10.8Z" fill="#666"/>
        <path d="M37.36,9.67A2,2,0,0,1,36.88,11a2.39,2.39,0,0,1-1.34.73v0a2.59,2.59,0,0,1,1.55.64,1.84,1.84,0,0,1,.52,1.36,2.26,2.26,0,0,1-.87,1.91,4,4,0,0,1-2.48.67,5.59,5.59,0,0,1-2.4-.46V14.7a5.49,5.49,0,0,0,1.15.42,5,5,0,0,0,1.17.15,2.47,2.47,0,0,0,1.49-.37,1.34,1.34,0,0,0,.49-1.14,1.09,1.09,0,0,0-.54-1,3.48,3.48,0,0,0-1.71-.32H33.16V11.3h0.76Q36,11.3,36,9.88A1,1,0,0,0,35.6,9a1.61,1.61,0,0,0-1.05-.3,3.19,3.19,0,0,0-.94.14,4.44,4.44,0,0,0-1.07.54l-0.67-1a4.49,4.49,0,0,1,2.74-.87,3.26,3.26,0,0,1,2,.56A1.83,1.83,0,0,1,37.36,9.67Z" fill="#666"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="168" y="138" width="468" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="168" y="138" width="468" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="181" y="152" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="181" y="152" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M210,183l-1.93-4.94h-6.23L199.94,183h-1.83l6.14-15.61h1.52L211.89,183H210Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(179.25 149.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="313" y="152" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="313" y="152" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M342,183l-1.93-4.94h-6.23L331.94,183h-1.83l6.14-15.61h1.52L343.89,183H342Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(311.25 149.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="445" y="152" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="445" y="152" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M474,183l-1.93-4.94h-6.23L463.94,183h-1.83l6.14-15.61h1.52L475.89,183H474Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(443.25 149.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="577" y="152" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="577" y="152" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M606,183l-1.93-4.94h-6.23L595.94,183h-1.83l6.14-15.61h1.52L607.89,183H606Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.25 149.25)" xlink:href="#rnn-a"/>
  </g>
  <g opacity="0.9">
    <use width="50.5" height="27.5" transform="translate(180 90)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(180 54)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.4">
    <use width="50.5" height="27.5" transform="translate(180 18)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(312 90)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.9">
    <use id="op-2-5" data-name="op-2" width="50.5" height="27.5" transform="translate(312 54)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(312 18)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.9">
    <use id="op-1-7" data-name="op-1" width="50.5" height="27.5" transform="translate(444 90)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(444 54)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(444 18)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(576 90)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(576 54)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.9">
    <use id="op-3-9" data-name="op-3" width="50.5" height="27.5" transform="translate(576 18)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(678 153.88)" font-size="13" font-family="Open Sans">At each step the <tspan x="0" y="20">controller RNN outputs a </tspan><tspan x="0" y="40">probability distribution</tspan></text>
  </g>
  <g>
    <line x1="204" y1="150" x2="204" y2="125.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M204,120a27.2,27.2,0,0,0,4.28,7.69L204,126.14l-4.28,1.55A27.17,27.17,0,0,0,204,120Z" fill="#666"/>
  </g>
  <g>
    <line x1="336" y1="150" x2="336" y2="125.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M336,120a27.2,27.2,0,0,0,4.28,7.69L336,126.14l-4.28,1.55A27.17,27.17,0,0,0,336,120Z" fill="#666"/>
  </g>
  <g>
    <line x1="468" y1="150" x2="468" y2="125.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M468,120a27.2,27.2,0,0,0,4.28,7.69L468,126.14l-4.28,1.55A27.17,27.17,0,0,0,468,120Z" fill="#666"/>
  </g>
  <g>
    <line x1="600" y1="150" x2="600" y2="125.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M600,120a27.2,27.2,0,0,0,4.28,7.69L600,126.14l-4.28,1.55A27.17,27.17,0,0,0,600,120Z" fill="#666"/>
  </g>
  <g>
    <line x1="228" y1="174.5" x2="300.57" y2="174.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M306,174.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,306,174.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="360" y1="174.5" x2="432.57" y2="174.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M438,174.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,438,174.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="492" y1="174.5" x2="564.57" y2="174.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M570,174.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,570,174.5Z" fill="#666"/>
  </g>
</svg>
</figure>

<p>The resulting distribution over operations can now be evaluated. Instead of running a single operation at each step, we do the usual attention trick of running all of them and then average the outputs together, weighted by the probability we ran that operation.</p>
<figure class="w-page">
<svg id="background" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="984" height="246" viewBox="0 0 984 246">
  <defs>
    <clipPath id="clip-path">
      <rect id="first-clip" x="228" y="6" width="84" height="144" fill="none"/>
    </clipPath>
    <clipPath id="clip-path-2">
      <polygon points="500 6 306 6 306 36 360 36 360 138 444 138 444 36 500 36 500 6" fill="none"/>
    </clipPath>
    <clipPath id="clip-path-3">
      <polygon points="612 6 438 6 438 36 492 36 492 138 576 138 576 36 612 36 612 6" fill="none"/>
    </clipPath>
    <clipPath id="clip-path-4">
      <rect x="624" y="6" width="60" height="120" fill="none"/>
    </clipPath>
    <symbol id="rnn-bg" data-name="rnn-bg" viewBox="0 0 49.5 49.5">
      <rect x="0.75" y="0.75" width="48" height="48" rx="6" ry="6" fill="#fff" fill-opacity="0.8" stroke="#666" stroke-width="1.5"/>
    </symbol>
    <symbol id="rnn-a" data-name="rnn-a" viewBox="0 0 49.5 49.5">
      <use id="rnn-bg-3" data-name="rnn-bg" width="49.5" height="49.5" xlink:href="#rnn-bg"/>
      <path d="M29.77,31.75l-1.93-4.94H21.6l-1.91,4.94H17.86L24,16.14h1.52l6.11,15.61H29.77Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z" fill="#666"/>
    </symbol>
    <symbol id="op-1" data-name="op-1" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M35.86,16.27H34.49V10.74q0-1,0-1.57l-0.33.31-1.32,1.08L32.2,9.69l2.52-2h1.15v8.57Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-2" data-name="op-2" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12Zm-6.54,0a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.5,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.45,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.68V9.79H22.8q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.56,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.64,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.15,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.64,10.8Z" fill="#666"/>
        <path d="M37.63,16.27H31.82v-1L34,13a18.79,18.79,0,0,0,1.3-1.42,3.39,3.39,0,0,0,.47-0.79A2.12,2.12,0,0,0,35.94,10a1.21,1.21,0,0,0-.35-0.91,1.34,1.34,0,0,0-1-.33,2.57,2.57,0,0,0-1,.18,4.46,4.46,0,0,0-1.06.66l-0.74-.91a4.8,4.8,0,0,1,1.39-.86,4.07,4.07,0,0,1,1.44-.25,2.82,2.82,0,0,1,1.92.62,2.11,2.11,0,0,1,.72,1.68,3,3,0,0,1-.21,1.1,4.48,4.48,0,0,1-.64,1.08A14.6,14.6,0,0,1,35,13.56L33.56,15v0.06h4.07v1.21Z" fill="#666"/>
      </g>
    </symbol>
    <symbol id="op-3" data-name="op-3" viewBox="0 0 50.5 27.5">
      <g>
        <g opacity="0.1">
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12"/>
          <rect x="1.75" y="2.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#000" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
        <g>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="#d8c2f2"/>
          <rect x="0.75" y="0.75" width="48" height="24" rx="12" ry="12" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        </g>
      </g>
      <g>
        <path d="M20,12a4.69,4.69,0,0,1-1,3.25,3.78,3.78,0,0,1-3,1.16,3.81,3.81,0,0,1-3-1.15A4.72,4.72,0,0,1,12,12a4.64,4.64,0,0,1,1-3.26,3.85,3.85,0,0,1,3-1.14,3.78,3.78,0,0,1,3,1.15A4.68,4.68,0,0,1,20,12ZM13.5,12a3.84,3.84,0,0,0,.64,2.4,2.25,2.25,0,0,0,1.89.82,2.25,2.25,0,0,0,1.88-.81A3.85,3.85,0,0,0,18.55,12a3.86,3.86,0,0,0-.63-2.39A2.23,2.23,0,0,0,16,8.77a2.27,2.27,0,0,0-1.9.81A3.8,3.8,0,0,0,13.5,12Z" fill="#666"/>
        <path d="M25,16.39a2.27,2.27,0,0,1-1.91-.88H23q0.08,0.82.08,1v2.65H21.74V9.79h1.11q0,0.18.19,0.87h0.07a2.16,2.16,0,0,1,1.93-1,2.25,2.25,0,0,1,1.89.88A4,4,0,0,1,27.61,13a4,4,0,0,1-.69,2.48A2.27,2.27,0,0,1,25,16.39ZM24.69,10.8a1.43,1.43,0,0,0-1.2.48,2.49,2.49,0,0,0-.38,1.54V13a3,3,0,0,0,.38,1.71,1.39,1.39,0,0,0,1.22.53,1.24,1.24,0,0,0,1.1-.59A3,3,0,0,0,26.2,13a2.92,2.92,0,0,0-.38-1.65A1.28,1.28,0,0,0,24.69,10.8Z" fill="#666"/>
        <path d="M37.36,9.67A2,2,0,0,1,36.88,11a2.39,2.39,0,0,1-1.34.73v0a2.59,2.59,0,0,1,1.55.64,1.84,1.84,0,0,1,.52,1.36,2.26,2.26,0,0,1-.87,1.91,4,4,0,0,1-2.48.67,5.59,5.59,0,0,1-2.4-.46V14.7a5.49,5.49,0,0,0,1.15.42,5,5,0,0,0,1.17.15,2.47,2.47,0,0,0,1.49-.37,1.34,1.34,0,0,0,.49-1.14,1.09,1.09,0,0,0-.54-1,3.48,3.48,0,0,0-1.71-.32H33.16V11.3h0.76Q36,11.3,36,9.88A1,1,0,0,0,35.6,9a1.61,1.61,0,0,0-1.05-.3,3.19,3.19,0,0,0-.94.14,4.44,4.44,0,0,0-1.07.54l-0.67-1a4.49,4.49,0,0,1,2.74-.87,3.26,3.26,0,0,1,2,.56A1.83,1.83,0,0,1,37.36,9.67Z" fill="#666"/>
      </g>
    </symbol>
  </defs>
  <title>rnn</title>
  <g id="_Group_" data-name="&lt;Group&gt;">
    <rect x="168" y="162" width="468" height="72" rx="10" ry="10" fill="#f0f0f5"/>
    <g opacity="0.1">
      <rect x="168" y="162" width="468" height="72" rx="10" ry="10" fill="none" stroke="#231f20"/>
    </g>
  </g>
  <path d="M367.26,24h-103" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  <g clip-path="url(#clip-path)">
    <g opacity="0.9">
      <path d="M222,120h9c4.95,0,9-4.5,9-10V34a10,10,0,0,1,10-10h31.75" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M222,84h9c4.95,0,9-4.5,9-10V34a10,10,0,0,1,10-10h31.75" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.4">
      <path d="M222,48h9c5,0,9-4.5,9-10V34a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M318,120h-9c-4.95,0-9-4.5-9-10V34a10,10,0,0,0-10-10H262.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M318,84h-9c-4.95,0-9-4.5-9-10V34a10,10,0,0,0-10-10H262.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M318,48h-9c-4.95,0-9-4.5-9-10V34a10,10,0,0,0-10-10H258.25" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g clip-path="url(#clip-path-2)">
    <g opacity="0.2">
      <path d="M354,120h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M354,84h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M354,48h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M451.05,122H430a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H376.65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M451.05,86H430a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H376.65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M451.05,49H430a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H376.65" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M450.25,119h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H390.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M450.25,83h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H390.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M450.25,46h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H390.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <path d="M500.17,24H459.75a38.44,38.44,0,0,1-18.28-5.6l-1.18-.8A38.44,38.44,0,0,0,422,12H396.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
  </g>
  <g clip-path="url(#clip-path-3)">
    <g opacity="0.9">
      <path d="M486,120h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M486,84h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M486,48h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h31.7" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M583.05,122H562a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H507.83" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M583.05,86H562a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H507.83" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M583.05,50H562a10,10,0,0,1-10-10V34a10,10,0,0,0-10-10H507.83" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M582.25,119h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H522.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M582.25,83h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H522.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.9">
      <path d="M582.25,47h-9.12c-5,0-9.12-4.5-9.12-10V22a10,10,0,0,0-10-10H522.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g clip-path="url(#clip-path-4)">
    <g opacity="0.9">
      <g>
        <path d="M618,48h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10h26.27" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
        <path d="M677.75,12a27.2,27.2,0,0,0-7.69,4.28L671.61,12l-1.55-4.28A27.18,27.18,0,0,0,677.75,12Z" fill="#666"/>
      </g>
    </g>
    <g opacity="0.2">
      <path d="M618,120h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10H666" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
    <g opacity="0.2">
      <path d="M618,84h9c5,0,9-4.5,9-10V22a10,10,0,0,1,10-10H666" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    </g>
  </g>
  <g id="_Group_2" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="181" y="176" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="181" y="176" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M210,207l-1.93-4.94h-6.23L199.94,207h-1.83l6.14-15.61h1.52L211.89,207H210Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(179.25 173.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="313" y="176" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="313" y="176" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M342,207l-1.93-4.94h-6.23L331.94,207h-1.83l6.14-15.61h1.52L343.89,207H342Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(311.25 173.25)" xlink:href="#rnn-a"/>
  </g>
  <g>
    <g opacity="0.1">
      <rect x="445" y="176" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="445" y="176" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M474,207l-1.93-4.94h-6.23L463.94,207h-1.83l6.14-15.61h1.52L475.89,207H474Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(443.25 173.25)" xlink:href="#rnn-a"/>
  </g>
  <g id="_Group_3" data-name="&lt;Group&gt;">
    <g opacity="0.1">
      <rect x="577" y="176" width="48" height="48" rx="6" ry="6" opacity="0.8"/>
      <rect x="577" y="176" width="48" height="48" rx="6" ry="6" fill="none" stroke="#000" stroke-width="1.5"/>
      <path d="M606,207l-1.93-4.94h-6.23L595.94,207h-1.83l6.14-15.61h1.52L607.89,207H606Zm-2.5-6.57-1.81-4.82q-0.35-.91-0.72-2.24a20.34,20.34,0,0,1-.67,2.24l-1.83,4.82h5Z"/>
    </g>
    <use width="49.5" height="49.5" transform="translate(575.25 173.25)" xlink:href="#rnn-a"/>
  </g>
  <g opacity="0.9">
    <use width="50.5" height="27.5" transform="translate(180 108)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(180 72)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.4">
    <use width="50.5" height="27.5" transform="translate(180 36)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(312 108)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.9">
    <use id="op-2-5" data-name="op-2" width="50.5" height="27.5" transform="translate(312 72)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(312 36)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.9">
    <use width="50.5" height="27.5" transform="translate(444 108)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(444 72)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(444 36)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(576 108)" xlink:href="#op-1"/>
  </g>
  <g opacity="0.2">
    <use width="50.5" height="27.5" transform="translate(576 72)" xlink:href="#op-2"/>
  </g>
  <g opacity="0.9">
    <use width="50.5" height="27.5" transform="translate(576 36)" xlink:href="#op-3"/>
  </g>
  <g opacity="0.6">
    <text transform="translate(678 -88.12)" font-size="13" font-family="Open Sans">At each step the <tspan x="0" y="20">controller RNN outputs a </tspan><tspan x="0" y="40">probability distribution</tspan></text>
  </g>
  <g opacity="0.6">
    <text transform="translate(678 177.88)" font-size="13" font-family="Open Sans">We run all of the <tspan x="0" y="20">operations and average </tspan><tspan x="0" y="40">the outputs together</tspan></text>
  </g>
  <g>
    <line x1="228" y1="198.5" x2="300.57" y2="198.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M306,198.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,306,198.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="204" y1="174" x2="204" y2="145.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M204,140a27.2,27.2,0,0,0,4.28,7.69L204,146.14l-4.28,1.55A27.17,27.17,0,0,0,204,140Z" fill="#666"/>
  </g>
  <g>
    <line x1="336" y1="174" x2="336" y2="145.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M336,140a27.2,27.2,0,0,0,4.28,7.69L336,146.14l-4.28,1.55A27.17,27.17,0,0,0,336,140Z" fill="#666"/>
  </g>
  <g>
    <line x1="468" y1="174" x2="468" y2="145.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M468,140a27.2,27.2,0,0,0,4.28,7.69L468,146.14l-4.28,1.55A27.17,27.17,0,0,0,468,140Z" fill="#666"/>
  </g>
  <g>
    <line x1="600" y1="174" x2="600" y2="145.43" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M600,140a27.2,27.2,0,0,0,4.28,7.69L600,146.14l-4.28,1.55A27.17,27.17,0,0,0,600,140Z" fill="#666"/>
  </g>
  <g>
    <line x1="360" y1="198.5" x2="432.57" y2="198.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M438,198.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,438,198.5Z" fill="#666"/>
  </g>
  <g>
    <line x1="492" y1="198.5" x2="564.57" y2="198.5" fill="none" stroke="#666" stroke-miterlimit="10" stroke-width="1.5"/>
    <path d="M570,198.5a27.2,27.2,0,0,0-7.69,4.28l1.55-4.28-1.55-4.28A27.18,27.18,0,0,0,570,198.5Z" fill="#666"/>
  </g>
</svg>
</figure>

<p>As long as we can define derivatives through the operations, the program’s output is differentiable with respect to the probabilities. We can then define a loss, and train the neural net to produce programs that give the correct answer. In this way, the Neural Programmer learns to produce programs without examples of good programs. The only supervision is the answer the program should produce.</p>
<p>That’s the core idea of Neural Programmer, but the version in the paper answers questions about tables, rather than arithmetic expressions. There’s a few additional neat tricks:</p>
<ul>
<li><p><strong>Multiple Types:</strong> Many of the operations in the Neural Programmer deal with types other than scalar numbers. Some operations output selections of table columns or selections of cells. <!-- footnote? (To allow us to backprop through the selecting things and average selections, we allow things to be selected to different extents, with 0 as unselected and 1 as fully selected.) --> Only outputs of the same type get merged together.</p>
</li>
<li><p><strong>Referencing Inputs:</strong> The neural programmer needs to answer questions like “How many cities have a population greater than 1,000,000?” given a table of cities with a population column. To facilitate this, some operations allow the network to reference constants in the question they’re answering, or the names of columns. This referencing happens by attention, in the style of pointer networks (<a href="https://arxiv.org/pdf/1506.03134.pdf">Vinyals, <em>et al.</em>, 2015</a>). <!-- For example, in order to use the *Greater* operation, the controller must select a value that table entries are greater than; instead of using a previous scalar value it's computed, it has the controller select a value in the question using attention. --></p>
</li>
</ul>
<p>The Neural Programmer isn’t the only approach to having neural networks generate programs. Another lovely approach is the Neural Programmer-Interpreter (<a href="https://arxiv.org/pdf/1511.06279.pdf">Reed &amp; de Freitas, 2015</a>) which can accomplish a number of very interesting tasks, but requires supervision in the form of correct programs.</p>
<p>We think that this general space, of bridging the gap between more traditional programming and neural networks is extremely important. While the Neural Programmer is clearly not the final solution, we think there are a lot of important lessons to be learned from it.</p>
<h3 id="code">Code</h3>
<p>There don’t seem to be any open source implementations of the Neural Programmer at present, but there is an implementation of the Neural Programmer-Interpreter by <a href="https://github.com/mokemokechicken/keras_npi">Ken Morishita</a> (Keras).</p>
<hr>
<h2 id="the-big-picture">The Big Picture</h2>
<p>A human with a piece of paper is, in some sense, much smarter than a human without. A human with mathematical notation can solve problems they otherwise couldn’t. Access to computers makes us capable of incredible feats that would otherwise be far beyond us.</p>
<p>In general, it seems like a lot of interesting forms of intelligence are an interaction between the creative heuristic intuition of humans and some more crisp and careful media, like language or equations. Sometimes, the medium is something that physically exists, and stores information for us, prevents us from making mistakes, or does computational heavy lifting. In other cases, the medium is a model in our head that we manipulate. Either way, it seems deeply fundamental to intelligence.</p>
<p>Recent results in machine learning have started to have this flavor, combining the intuition of neural networks with something else. One approach is what one might call “heuristic search.” For example, AlphaGo (<a href="http://willamette.edu/~levenick/cs448/goNature.pdf">Silver, <em>et al.</em>, 2016</a>) has a model of how Go works and explores how the game could play out guided by neural network intuition. Similarly, DeepMath (<a href="https://arxiv.org/pdf/1606.04442.pdf">Alemi, <em>et al.</em>, 2016</a>) uses neural networks as intuition for manipulating mathematical expressions. The “augmented RNNs” we’ve talked about in this article are another approach, where we connect RNNs to engineered media, in order to extend their general capabilities.</p>
<p>Interacting with media naturally involves making a sequence of taking an action, observing, and taking more actions. This creates a major challenge: how do we learn which actions to take? That sounds like a reinforcement learning problem and we could certainly take that approach. But the reinforcement learning literature is really attacking the hardest version of this problem, and its solutions are hard to use. The wonderful thing about attention is that it gives us an easier way out of this problem by partially taking all actions to varying extents. This works because we can design media – like the NTM memory – to allow fractional actions and to be differentiable. Reinforcement learning has us take a single path, and try to learn from that. Attention takes every direction at a fork, and then merges the paths back together.</p>
<p>A major weaknesses of attention is that we have to take every “action” every step. This causes the computational cost to grow linearly as you do things like increase the amount of memory in a Neural Turing Machine. One thing you could imagine doing is having your attention be sparse, so that you only have to touch some memories. However, it’s still challenging because you may want to do things like have your attention depend on the content of the memory, and doing that naively forces you to look at each memory. We’ve seen some initial attempts to attack this problem, such as <a href="https://arxiv.org/pdf/1602.03218.pdf">Andrychowicz &amp; Kurach, 2016</a>, but it seems like there’s a lot more to be done. If we could really make such sub-linear time attention work, that would be very powerful!</p>
<p>Augmented recurrent neural networks, and the underlying technique of attention, are incredibly exciting. We look forward to seeing what happens next!</p>
<!-- Appendix -->
<section class="appendix w-body">
  <h3>Acknowledgments</h3>
  <p>Thank you to Maithra Raghu, Dario Amodei, Cassandra Xia, Luke Vilnis, Anna Goldie, Jesse Engel, Dan Mané, Natasha Jaques, Emma Pierson and Ian Goodfellow for their feedback and encouragement. We’re also very grateful to our team, <a href="http://g.co/brain">Google Brain</a>, for being extremely supportive of our project.
  <h3 id="citation">Errors, Reuse, and Citation</h3>
  <p>If you see mistakes or want to suggest changes, please submit a pull request on <a href="https://github.com/distillpub/post--augmented-rnns">github</a>.
  <p>Diagrams and text are licensed under Creative Commons Attribution <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY 2.0</a>, unless noted otherwise, with the source available on available on <a href="https://github.com/distillpub/post--augmented-rnns">github</a>. The figures that have been reused from other sources don’t fall under this license and can be recognized by a note in their caption: “Figure from …”.
  <p>For attribution in academic contexts, please cite this work as
  <pre class="citation">Chris Olah &amp; Shan Carter, “Attention and Augmented Recurrent Neural Networks”, Distill, 2016.</pre>
  <p>BibTeX citation
<pre class="citation">@misc{olah2016attention,
  author = {Olah, Chris and Carter, Shan},
  title = {Attention and Augmented Recurrent Neural Networks},
  year = {2016},
  howpublished = {http:&#x2F;&#x2F;distill.pub&#x2F;2016&#x2F;augmented-rnns&#x2F;}
}</pre>

  <h3>References</h3>
  <ul class="references">
    <li>Alemi, A. A., Chollet, F., Irving, G., Szegedy, C., &amp; Urban, J. (2016). DeepMath-Deep Sequence Models for Premise Selection. arXiv preprint arXiv:1606.04442.</li>
    <li>Andrychowicz, M., &amp; Kurach, K. (2016). Learning Efficient Algorithms with Hierarchical Attentive Memory. arXiv preprint arXiv:1602.03218.</li>
    <li>Bahdanau, D., Cho, K., &amp; Bengio, Y. (2014). Neural machine translation by jointly learning to align and translate. arXiv preprint arXiv:1409.0473.</li>
    <li>Chan, W., Jaitly, N., Le, Q. V., &amp; Vinyals, O. (2015). Listen, attend and spell. arXiv preprint arXiv:1508.01211.</li>
    <li>Graves, A., Wayne, G., &amp; Danihelka, I. (2014). Neural turing machines. arXiv preprint arXiv:1410.5401.</li>
    <li>Graves, A. (2016). Adaptive Computation Time for Recurrent Neural Networks. arXiv preprint arXiv:1603.08983.</li>
    <li>Grefenstette, E., Hermann, K. M., Suleyman, M., &amp; Blunsom, P. (2015). Learning to transduce with unbounded memory. In Advances in Neural Information Processing Systems (pp. 1828-1836).</li>
    <li>Joulin, A., &amp; Mikolov, T. (2015). Inferring algorithmic patterns with stack-augmented recurrent nets. In Advances in Neural Information Processing Systems (pp. 190-198).</li>
    <li>Kaiser, Ł., &amp; Sutskever, I. (2015). Neural gpus learn algorithms. arXiv preprint arXiv:1511.08228.</li>
    <li>Kumar, A., Irsoy, O., Su, J., Bradbury, J., English, R., Pierce, B., Ondruska, P., Gulrajani, I. &amp; Socher, R., (2015). Ask me anything: Dynamic memory networks for natural language processing. arXiv preprint arXiv:1506.07285.</li>
    <li>Kurach, K., Andrychowicz, M., &amp; Sutskever, I. (2015). Neural random-access machines. arXiv preprint arXiv:1511.06392.</li>
    <li>Neelakantan, A., Le, Q. V., &amp; Sutskever, I. (2015). Neural programmer: Inducing latent programs with gradient descent. arXiv preprint arXiv:1511.04834.</li>
    <li>Olah, C. (2015). Understanding LSTM Networks.</li>
    <li>Reed, S., &amp; de Freitas, N. (2015). Neural programmer-interpreters. arXiv preprint arXiv:1511.06279.</li>
    <li>Silver, D., Huang, A., Maddison, C.J., Guez, A., Sifre, L., Van Den Driessche, G., Schrittwieser, J., Antonoglou, I., Panneershelvam, V., Lanctot, M. &amp; Dieleman, S. (2016). Mastering the game of Go with deep neural networks and tree search. Nature, 529(7587), 484-489.</li>
    <li>Vinyals, O., Kaiser, Ł., Koo, T., Petrov, S., Sutskever, I., &amp; Hinton, G. (2015). Grammar as a foreign language. In Advances in Neural Information Processing Systems (pp. 2773-2781).</li>
    <li>Vinyals, O., &amp; Le, Q. (2015). A neural conversational model. arXiv preprint arXiv:1506.05869.</li>
    <li>Vinyals, O., Fortunato, M., &amp; Jaitly, N. (2015). Pointer networks. In Advances in Neural Information Processing Systems (pp. 2692-2700).</li>
    <li>Weston, J., Chopra, S., &amp; Bordes, A. (2014). Memory networks. arXiv preprint arXiv:1410.3916.</li>
    <li>Xu, K., Ba, J., Kiros, R., Cho, K., Courville, A., Salakhutdinov, R., Zemel, R.S. &amp; Bengio, Y., 2015. (2015). Show, attend and tell: Neural image caption generation with visual attention. arXiv preprint arXiv:1502.03044, 2(3), 5.</li>
    <li>Zaremba, W., &amp; Sutskever, I. (2015). Reinforcement learning neural Turing machines. arXiv preprint arXiv:1505.00521, 362.</li>
  </ul>
</section>
  </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83741880-1', 'auto');
  ga('send', 'pageview');

</script></body>
